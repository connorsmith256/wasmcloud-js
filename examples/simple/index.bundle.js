var wasmcloudjs;(()=>{var e,t,r,n,s,i={854:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateWASIImports=t.generateWapcImports=void 0;const n=r(2651);t.generateWapcImports=function(e){return{__console_log(t,r){n.debug((()=>["__console_log %o bytes @ %o",r,t]));const s=new Uint8Array(e.getCallerMemory().buffer).slice(t,t+r);console.log(e.textDecoder.decode(s))},__host_call(t,r,s,i,o,a,c,u){n.debug((()=>["__host_call"]));const h=e.getCallerMemory(),l=new Uint8Array(h.buffer),d=e.textDecoder.decode(l.slice(t,t+r)),f=e.textDecoder.decode(l.slice(s,s+i)),p=e.textDecoder.decode(l.slice(o,o+a)),y=l.slice(c,c+u);n.debug((()=>["host_call(%o,%o,%o,[%o bytes])",d,f,p,y.length])),e.state.hostError=void 0,e.state.hostResponse=void 0;try{const t=e.state.hostCallback(d,f,p,y);return e.state.hostResponse=t,1}catch(t){return e.state.hostError=t.toString(),0}},__host_response(t){n.debug((()=>["__host_response ptr: %o",t])),e.state.hostResponse&&new Uint8Array(e.getCallerMemory().buffer).set(e.state.hostResponse,t)},__host_response_len(){var t;const r=(null===(t=e.state.hostResponse)||void 0===t?void 0:t.length)||0;return n.debug((()=>["__host_response_len %o",r])),r},__host_error_len(){var t;const r=(null===(t=e.state.hostError)||void 0===t?void 0:t.length)||0;return n.debug((()=>["__host_error_len ptr: %o",r])),r},__host_error(t){n.debug((()=>["__host_error %o",t])),e.state.hostError&&(n.debug((()=>["__host_error writing to mem: %o",e.state.hostError])),new Uint8Array(e.getCallerMemory().buffer).set(e.textEncoder.encode(e.state.hostError),t))},__guest_response(t,r){n.debug((()=>["__guest_response %o bytes @ %o",r,t])),e.state.guestError=void 0;const s=new Uint8Array(e.getCallerMemory().buffer).slice(t,t+r);e.state.guestResponse=s},__guest_error(t,r){n.debug((()=>["__guest_error %o bytes @ %o",r,t]));const s=new Uint8Array(e.getCallerMemory().buffer).slice(t,t+r),i=e.textDecoder.decode(s);e.state.guestError=i},__guest_request(t,r){n.debug((()=>["__guest_request op: %o, ptr: %o",t,r]));const s=e.state.guestRequest;if(!s)throw new Error("__guest_request called without an invocation present. This is probably a bug in the library using @wapc/host.");{const i=e.getCallerMemory();n.debug((()=>["writing invocation (%o,[%o bytes])",s.operation,s.msg.length]));const o=new Uint8Array(i.buffer);o.set(s.operationEncoded,t),o.set(s.msg,r)}}}},t.generateWASIImports=function(e){return{__fd_write(t,r,n,s){if(1!=t)return 0;const i=e.getCallerMemory(),o=new DataView(i.buffer),a=new Uint8Array(i.buffer);let c=0;for(;n>0;){n--;const t=o.getUint32(r,!0);r+=4;const s=o.getUint32(r,!0);r+=4;const i=a.slice(t,t+s);e.state.writer(e.textDecoder.decode(i)),c+=s}return o.setUint32(s,c,!0),c}}}},2651:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=void 0;const s=n(r(1227)).default("wapc");t.debug=function(e){if(s.enabled){const t=e();s(...t)}}},5715:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamingFailure=t.InvalidWasm=t.HostCallNotImplementedError=void 0;class r extends Error{matcher(){return new RegExp(this.toString().replace(/^Error: /,""))}}t.HostCallNotImplementedError=class extends r{constructor(e,t,r){super(`Host call not implemented. Guest called host with binding = '${e}', namespace = '${t}', & operation = '${r}'`)}},t.InvalidWasm=class extends r{constructor(e){super(`Invalid wasm binary: ${e.message}`)}},t.StreamingFailure=class extends r{constructor(e){super(`Could not instantiate from Response object: ${e.message}`)}}},5502:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.errors=t.WapcHost=t.instantiateStreaming=t.instantiate=void 0;var o=r(1244);Object.defineProperty(t,"instantiate",{enumerable:!0,get:function(){return o.instantiate}}),Object.defineProperty(t,"instantiateStreaming",{enumerable:!0,get:function(){return o.instantiateStreaming}}),Object.defineProperty(t,"WapcHost",{enumerable:!0,get:function(){return o.WapcHost}}),t.errors=i(r(5715))},1244:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.instantiateStreaming=t.instantiate=t.WapcHost=void 0;const n=r(2651),s=r(5502),i=r(854),o=r(5715);class a{constructor(e,t){this.hostCallback=e||((e,t,r)=>{throw new o.HostCallNotImplementedError(e,t,r)}),this.writer=t||(()=>{})}}class c{constructor(e,t){this.state=new a(e,t),this.textEncoder=new TextEncoder,this.textDecoder=new TextDecoder("utf-8"),this.guestCall=()=>{}}async instantiate(e){const t=this.getImports(),r=await WebAssembly.instantiate(e,t).catch((e=>{throw new s.errors.InvalidWasm(e)}));return this.initialize(r.instance),this}async instantiateStreaming(e){const t=this.getImports();if(WebAssembly.instantiateStreaming){const r=await WebAssembly.instantiateStreaming(e,t).catch((e=>{throw new s.errors.StreamingFailure(e)}));return this.initialize(r.instance),this}{n.debug((()=>["WebAssembly.instantiateStreaming is not supported on this browser, wasm execution will be impacted."]));const t=new Uint8Array(await(await e).arrayBuffer());return this.instantiate(t)}}getImports(){const e=i.generateWASIImports(this);return{wapc:i.generateWapcImports(this),wasi:e,wasi_unstable:e}}initialize(e){this.instance=e;const t=this.instance.exports._start;null!=t&&t([]);const r=this.instance.exports.wapc_init;if(null!=r&&r([]),this.guestCall=this.instance.exports.__guest_call,null==this.guestCall)throw new Error("WebAssembly module does not export __guest_call")}async invoke(e,t){n.debug((()=>["invoke(%o, [%o bytes]",e,t.length]));const r=this.textEncoder.encode(e);if(this.state.guestRequest={operation:e,operationEncoded:r,msg:t},0===this.guestCall(r.length,t.length))throw new Error(this.state.guestError);if(this.state.guestResponse)return this.state.guestResponse;throw new Error("Guest call succeeded, but guest response not set. This is a bug in @wapc/host")}getCallerMemory(){return this.instance.exports.memory}}t.WapcHost=c,t.instantiate=async function(e,t,r){return new c(t,r).instantiate(e)},t.instantiateStreaming=async function(e,t,r){return new c(t,r).instantiateStreaming(await e)}},1227:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))})),t.splice(s,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(2447)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},2447:(e,t,r)=>{e.exports=function(e){function t(e){let r,s,i,o=null;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),i=s-(r||s);n.diff=i,n.prev=r,n.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,s)=>{if("%%"===r)return"%";o++;const i=t.formatters[s];if("function"==typeof i){const t=e[o];r=i.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==t.namespaces&&(s=t.namespaces,i=t.enabled(e)),i),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(s),...t.skips.map(s).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(7824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},7824:e=>{var t=1e3,r=60*t,n=60*r,s=24*n;function i(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}e.exports=function(e,o){o=o||{};var a,c,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var o=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*n;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===u&&isFinite(e))return o.long?(a=e,(c=Math.abs(a))>=s?i(a,c,s,"day"):c>=n?i(a,c,n,"hour"):c>=r?i(a,c,r,"minute"):c>=t?i(a,c,t,"second"):a+" ms"):function(e){var i=Math.abs(e);return i>=s?Math.round(e/s)+"d":i>=n?Math.round(e/n)+"h":i>=r?Math.round(e/r)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},5009:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.credsAuthenticator=t.jwtAuthenticator=t.nkeyAuthenticator=t.noAuthFn=t.buildAuthenticator=void 0;const n=r(5983),s=r(6228),i=r(7699);function o(e){return t=>{const r=(e="function"==typeof e?e():e)?n.nkeys.fromSeed(e):void 0,s=r?r.getPublicKey():"",o=i.TE.encode(t||""),a=void 0!==r&&t?r.sign(o):void 0;return{nkey:s,sig:a?n.nkeys.encode(a):""}}}function a(e,t){return r=>{const n="function"==typeof e?e():e,s=o(t),{nkey:i,sig:a}=s(r);return{jwt:n,nkey:i,sig:a}}}t.buildAuthenticator=function(e){return e.authenticator?e.authenticator:e.token?(t=e.token,()=>({auth_token:t})):e.user?(r=e.user,n=e.pass,()=>({user:r,pass:n})):()=>{};var t,r,n},t.noAuthFn=function(){return()=>{}},t.nkeyAuthenticator=o,t.jwtAuthenticator=a,t.credsAuthenticator=function(e){const t=/\s*(?:(?:[-]{3,}[^\n]*[-]{3,}\n)(.+)(?:\n\s*[-]{3,}[^\n]*[-]{3,}\n))/gi,r=i.TD.decode(e);let n=t.exec(r);if(!n)throw s.NatsError.errorForCode(s.ErrorCode.BadCreds);const o=n[1].trim();if(n=t.exec(r),!n)throw s.NatsError.errorForCode(s.ErrorCode.BadCreds);return a(o,i.TE.encode(n[1].trim()))}},7742:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,s){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,s,(t=e[r](t)).done,t.value)}))}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Bench=t.Metric=void 0;const i=r(9305),o=r(3403),a=r(4875),c=r(4219);class u{constructor(e,t){this.name=e,this.duration=t,this.date=Date.now(),this.payload=0,this.msgs=0,this.bytes=0}toString(){const e=this.duration/1e3,t=Math.round(this.msgs/e),r=this.asyncRequests?"asyncRequests":"";let n="";return this.max&&(n=`${this.min}/${this.max}`),`${this.name}${r?" [asyncRequests]":""} ${o=t,o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")} msgs/sec - [${e.toFixed(2)} secs] ~ ${s=this.bytes,i=e,function(e,t=!1){const r=t?1e3:1024,n=t?["k","M","G","T","P","E"]:["K","M","G","T","P","E"],s=t?"iB":"B";if(e<r)return`${e.toFixed(2)} ${s}/sec`;const i=parseInt(Math.log(e)/Math.log(r)+""),o=parseInt(i-1+"");return`${(e/Math.pow(r,i)).toFixed(2)} ${n[o]}${s}/sec`}(s/i)} ${n}`;var s,i,o}toCsv(){return`"${this.name}",${new Date(this.date).toISOString()},${this.lang},${this.version},${this.msgs},${this.payload},${this.bytes},${this.duration},${!!this.asyncRequests&&this.asyncRequests}\n`}static header(){return"Test,Date,Lang,Version,Count,MsgPayload,Bytes,Millis,Async\n"}}t.Metric=u,t.Bench=class{constructor(e,t={msgs:1e5,size:128,subject:"",asyncRequests:!1,pub:!1,sub:!1,req:!1,rep:!1}){if(this.nc=e,this.callbacks=t.callbacks||!1,this.msgs=t.msgs||0,this.size=t.size||0,this.subject=t.subject||o.nuid.next(),this.asyncRequests=t.asyncRequests||!1,this.pub=t.pub||!1,this.sub=t.sub||!1,this.req=t.req||!1,this.rep=t.rep||!1,this.perf=new a.Perf,this.payload=this.size?new Uint8Array(this.size):i.Empty,!(this.pub||this.sub||this.req||this.rep))throw new Error("no bench option selected")}run(){return n(this,void 0,void 0,(function*(){return this.nc.closed().then((e=>{if(e)throw new c.NatsError(`bench closed with an error: ${e.message}`,c.ErrorCode.Unknown,e)})),this.callbacks?yield this.runCallbacks():yield this.runAsync(),this.processMetrics()}))}processMetrics(){const e=this.nc,{lang:t,version:r}=e.protocol.transport;this.pub&&this.sub&&this.perf.measure("pubsub","pubStart","subStop");const n=this.perf.getEntries(),s=n.find((e=>"pubsub"===e.name)),i=n.find((e=>"req"===e.name)),o=n.find((e=>"pub"===e.name)),a=n.find((e=>"sub"===e.name)),c=this.nc.stats(),h=[];if(s){const{name:e,duration:n}=s,i=new u(e,n);i.msgs=2*this.msgs,i.bytes=c.inBytes+c.outBytes,i.lang=t,i.version=r,i.payload=this.payload.length,h.push(i)}if(o){const{name:e,duration:n}=o,s=new u(e,n);s.msgs=this.msgs,s.bytes=c.outBytes,s.lang=t,s.version=r,s.payload=this.payload.length,h.push(s)}if(a){const{name:e,duration:n}=a,s=new u(e,n);s.msgs=this.msgs,s.bytes=c.inBytes,s.lang=t,s.version=r,s.payload=this.payload.length,h.push(s)}if(i){const{name:e,duration:n}=i,s=new u(e,n);s.msgs=2*this.msgs,s.bytes=c.inBytes+c.outBytes,s.lang=t,s.version=r,s.payload=this.payload.length,h.push(s)}return h}runCallbacks(){return n(this,void 0,void 0,(function*(){const e=[];if(this.req){const t=a.deferred();e.push(t);const r=this.nc.subscribe(this.subject,{max:this.msgs,callback:(e,n)=>{n.respond(this.payload),r.getProcessed()===this.msgs&&t.resolve()}})}if(this.sub){const t=a.deferred();e.push(t);let r=0;this.nc.subscribe(this.subject,{max:this.msgs,callback:()=>{r++,1===r&&this.perf.mark("subStart"),r===this.msgs&&(this.perf.mark("subStop"),this.perf.measure("sub","subStart","subStop"),t.resolve())}})}if(this.pub){const t=(()=>n(this,void 0,void 0,(function*(){this.perf.mark("pubStart");for(let e=0;e<this.msgs;e++)this.nc.publish(this.subject,this.payload);yield this.nc.flush(),this.perf.mark("pubStop"),this.perf.measure("pub","pubStart","pubStop")})))();e.push(t)}if(this.req){const t=(()=>n(this,void 0,void 0,(function*(){if(this.asyncRequests){this.perf.mark("reqStart");const e=[];for(let t=0;t<this.msgs;t++)e.push(this.nc.request(this.subject,this.payload,{timeout:2e4}));yield Promise.all(e),this.perf.mark("reqStop"),this.perf.measure("req","reqStart","reqStop")}else{this.perf.mark("reqStart");for(let e=0;e<this.msgs;e++)yield this.nc.request(this.subject);this.perf.mark("reqStop"),this.perf.measure("req","reqStart","reqStop")}})))();e.push(t)}yield Promise.all(e)}))}runAsync(){return n(this,void 0,void 0,(function*(){const e=[];if(this.req){const t=this.nc.subscribe(this.subject,{max:this.msgs}),r=(()=>n(this,void 0,void 0,(function*(){var e,r;try{for(var n,i=s(t);!(n=yield i.next()).done;)n.value.respond(this.payload)}catch(t){e={error:t}}finally{try{n&&!n.done&&(r=i.return)&&(yield r.call(i))}finally{if(e)throw e.error}}})))();e.push(r)}if(this.sub){let t=!1;const r=this.nc.subscribe(this.subject,{max:this.msgs}),i=(()=>n(this,void 0,void 0,(function*(){var e,n;try{for(var i,o=s(r);!(i=yield o.next()).done;)i.value,t||(this.perf.mark("subStart"),t=!0)}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&(yield n.call(o))}finally{if(e)throw e.error}}this.perf.mark("subStop"),this.perf.measure("sub","subStart","subStop")})))();e.push(i)}if(this.pub){const t=(()=>n(this,void 0,void 0,(function*(){this.perf.mark("pubStart");for(let e=0;e<this.msgs;e++)this.nc.publish(this.subject,this.payload);yield this.nc.flush(),this.perf.mark("pubStop"),this.perf.measure("pub","pubStart","pubStop")})))();e.push(t)}if(this.req){const t=(()=>n(this,void 0,void 0,(function*(){if(this.asyncRequests){this.perf.mark("reqStart");const e=[];for(let t=0;t<this.msgs;t++)e.push(this.nc.request(this.subject,this.payload,{timeout:2e4}));yield Promise.all(e),this.perf.mark("reqStop"),this.perf.measure("req","reqStart","reqStop")}else{this.perf.mark("reqStart");for(let e=0;e<this.msgs;e++)yield this.nc.request(this.subject);this.perf.mark("reqStop"),this.perf.measure("req","reqStart","reqStop")}})))();e.push(t)}yield Promise.all(e)}))}}},5234:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONCodec=t.StringCodec=void 0;const n=r(4219),s=r(7699);t.StringCodec=function(){return{encode:e=>s.TE.encode(e),decode:e=>s.TD.decode(e)}},t.JSONCodec=function(){return{encode(e){try{return void 0===e&&(e=null),s.TE.encode(JSON.stringify(e))}catch(e){throw n.NatsError.errorForCode(n.ErrorCode.BadJson,e)}},decode(e){try{return JSON.parse(s.TD.decode(e))}catch(e){throw n.NatsError.errorForCode(n.ErrorCode.BadJson,e)}}}}},593:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataBuffer=void 0;const n=r(7699);t.DataBuffer=class{constructor(){this.buffers=[],this.byteLength=0}static concat(...e){let t=0;for(let r=0;r<e.length;r++)t+=e[r].length;const r=new Uint8Array(t);let n=0;for(let t=0;t<e.length;t++)r.set(e[t],n),n+=e[t].length;return r}static fromAscii(e){return e||(e=""),n.TE.encode(e)}static toAscii(e){return n.TD.decode(e)}reset(){this.buffers.length=0,this.byteLength=0}pack(){if(this.buffers.length>1){const e=new Uint8Array(this.byteLength);let t=0;for(let r=0;r<this.buffers.length;r++)e.set(this.buffers[r],t),t+=this.buffers[r].length;this.buffers.length=0,this.buffers.push(e)}}drain(e){if(this.buffers.length){this.pack();const t=this.buffers.pop();if(t){const r=this.byteLength;(void 0===e||e>r)&&(e=r);const n=t.subarray(0,e);return r>e&&this.buffers.push(t.subarray(e)),this.byteLength=r-e,n}}return new Uint8Array(0)}fill(e,...t){e&&(this.buffers.push(e),this.byteLength+=e.length);for(let e=0;e<t.length;e++)t[e]&&t[e].length&&(this.buffers.push(t[e]),this.byteLength+=t[e].length)}peek(){return this.buffers.length?(this.pack(),this.buffers[0]):new Uint8Array(0)}size(){return this.byteLength}length(){return this.buffers.length}}},8571:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeAll=t.readAll=t.DenoBuffer=t.append=t.concat=t.MAX_SIZE=t.assert=t.AssertionError=void 0;const n=r(7699);class s extends Error{constructor(e){super(e),this.name="AssertionError"}}function i(e,t="Assertion failed."){if(!e)throw new s(t)}function o(e,t,r=0){const n=t.byteLength-r;return e.byteLength>n&&(e=e.subarray(0,n)),t.set(e,r),e.byteLength}function a(e,t){if(void 0===e&&void 0===t)return new Uint8Array(0);if(void 0===e)return t;if(void 0===t)return e;const r=new Uint8Array(e.length+t.length);return r.set(e,0),r.set(t,e.length),r}t.AssertionError=s,t.assert=i,t.MAX_SIZE=Math.pow(2,32)-2,t.concat=a,t.append=function(e,t){return a(e,Uint8Array.of(t))};class c{constructor(e){this._off=0,this._buf=null!=e?new Uint8Array(e):new Uint8Array(0)}bytes(e={copy:!0}){return!1===e.copy?this._buf.subarray(this._off):this._buf.slice(this._off)}empty(){return this._buf.byteLength<=this._off}get length(){return this._buf.byteLength-this._off}get capacity(){return this._buf.buffer.byteLength}truncate(e){if(0!==e){if(e<0||e>this.length)throw Error("bytes.Buffer: truncation out of range");this._reslice(this._off+e)}else this.reset()}reset(){this._reslice(0),this._off=0}_tryGrowByReslice(e){const t=this._buf.byteLength;return e<=this.capacity-t?(this._reslice(t+e),t):-1}_reslice(e){i(e<=this._buf.buffer.byteLength),this._buf=new Uint8Array(this._buf.buffer,0,e)}readByte(){const e=new Uint8Array(1);return this.read(e)?e[0]:null}read(e){if(this.empty())return this.reset(),0===e.byteLength?0:null;const t=o(this._buf.subarray(this._off),e);return this._off+=t,t}writeByte(e){return this.write(Uint8Array.of(e))}writeString(e){return this.write(n.TE.encode(e))}write(e){const t=this._grow(e.byteLength);return o(e,this._buf,t)}_grow(e){const r=this.length;0===r&&0!==this._off&&this.reset();const n=this._tryGrowByReslice(e);if(n>=0)return n;const s=this.capacity;if(e<=Math.floor(s/2)-r)o(this._buf.subarray(this._off),this._buf);else{if(s+e>t.MAX_SIZE)throw new Error("The buffer cannot be grown beyond the maximum size.");{const r=new Uint8Array(Math.min(2*s+e,t.MAX_SIZE));o(this._buf.subarray(this._off),r),this._buf=r}}return this._off=0,this._reslice(Math.min(r+e,t.MAX_SIZE)),r}grow(e){if(e<0)throw Error("Buffer._grow: negative count");const t=this._grow(e);this._reslice(t)}readFrom(e){let t=0;const r=new Uint8Array(32768);for(;;){const n=this.capacity-this.length<32768,s=n?r:new Uint8Array(this._buf.buffer,this.length),i=e.read(s);if(null===i)return t;n?this.write(s.subarray(0,i)):this._reslice(this.length+i),t+=i}}}t.DenoBuffer=c,t.readAll=function(e){const t=new c;return t.readFrom(e),t.bytes()},t.writeAll=function(e,t){let r=0;for(;r<t.length;)r+=e.write(t.subarray(r))}},7699:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fastDecoder=t.fastEncoder=t.TD=t.TE=void 0;const n=r(9305);t.TE=new TextEncoder,t.TD=new TextDecoder,t.fastEncoder=function(...e){let t=0;for(let r=0;r<e.length;r++)t+=e[r]?e[r].length:0;if(0===t)return n.Empty;const r=new Uint8Array(t);let s=0;for(let t=0;t<e.length;t++){const n=e[t];if(n)for(let e=0;e<n.length;e++)r[s]=n.charCodeAt(e),s++}return r},t.fastDecoder=function(e){return e&&0!==e.length?String.fromCharCode(...e):""}},4219:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.NatsError=t.isNatsError=t.Messages=t.ErrorCode=void 0,function(e){e.ApiError="BAD API",e.BadAuthentication="BAD_AUTHENTICATION",e.BadCreds="BAD_CREDS",e.BadHeader="BAD_HEADER",e.BadJson="BAD_JSON",e.BadPayload="BAD_PAYLOAD",e.BadSubject="BAD_SUBJECT",e.Cancelled="CANCELLED",e.ConnectionClosed="CONNECTION_CLOSED",e.ConnectionDraining="CONNECTION_DRAINING",e.ConnectionRefused="CONNECTION_REFUSED",e.ConnectionTimeout="CONNECTION_TIMEOUT",e.Disconnect="DISCONNECT",e.InvalidOption="INVALID_OPTION",e.InvalidPayload="INVALID_PAYLOAD",e.MaxPayloadExceeded="MAX_PAYLOAD_EXCEEDED",e.NoResponders="503",e.NotFunction="NOT_FUNC",e.RequestError="REQUEST_ERROR",e.ServerOptionNotAvailable="SERVER_OPT_NA",e.SubClosed="SUB_CLOSED",e.SubDraining="SUB_DRAINING",e.Timeout="TIMEOUT",e.Tls="TLS",e.Unknown="UNKNOWN_ERROR",e.WssRequired="WSS_REQUIRED",e.JetStreamInvalidAck="JESTREAM_INVALID_ACK",e.JetStream404NoMessages="404",e.JetStream408RequestTimeout="408",e.JetStream409MaxAckPendingExceeded="409",e.JetStreamNotEnabled="503",e.AuthorizationViolation="AUTHORIZATION_VIOLATION",e.AuthenticationExpired="AUTHENTICATION_EXPIRED",e.ProtocolError="NATS_PROTOCOL_ERR",e.PermissionsViolation="PERMISSIONS_VIOLATION"}(r=t.ErrorCode||(t.ErrorCode={}));class n{constructor(){this.messages=new Map,this.messages.set(r.InvalidPayload,"Invalid payload type - payloads can be 'binary', 'string', or 'json'"),this.messages.set(r.BadJson,"Bad JSON"),this.messages.set(r.WssRequired,"TLS is required, therefore a secure websocket connection is also required")}static getMessage(e){return s.getMessage(e)}getMessage(e){return this.messages.get(e)||e}}t.Messages=n;const s=new n;t.isNatsError=function(e){return"string"==typeof e.code};class i extends Error{constructor(e,t,r){super(e),this.name="NatsError",this.message=e,this.code=t,this.chainedError=r}static errorForCode(e,t){const r=n.getMessage(e);return new i(r,e,t)}isAuthError(){return this.code===r.AuthenticationExpired||this.code===r.AuthorizationViolation}isPermissionError(){return this.code===r.PermissionsViolation}isProtocolError(){return this.code===r.ProtocolError}}t.NatsError=i},8648:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsgHdrsImpl=t.Match=t.headers=t.canonicalMIMEHeaderKey=void 0;const n=r(4219),s=r(7699);function i(e){let t=!0;const r=new Array(e.length);for(let s=0;s<e.length;s++){let i=e.charCodeAt(s);if(58===i||i<33||i>126)throw new n.NatsError(`'${e[s]}' is not a valid character for a header key`,n.ErrorCode.BadHeader);t&&97<=i&&i<=122?i-=32:!t&&65<=i&&i<=90&&(i+=32),r[s]=i,t=45==i}return String.fromCharCode(...r)}t.canonicalMIMEHeaderKey=i,t.headers=function(){return new c};const o="NATS/1.0";var a;!function(e){e[e.Exact=0]="Exact",e[e.CanonicalMIME=1]="CanonicalMIME",e[e.IgnoreCase=2]="IgnoreCase"}(a=t.Match||(t.Match={}));class c{constructor(){this.code=0,this.headers=new Map,this.description=""}[Symbol.iterator](){return this.headers.entries()}size(){return this.headers.size}equals(e){if(e&&this.headers.size===e.headers.size&&this.code===e.code){for(const[t,r]of this.headers){const n=e.values(t);if(r.length!==n.length)return!1;const s=[...r].sort(),i=[...n].sort();for(let e=0;e<s.length;e++)if(s[e]!==i[e])return!1}return!0}return!1}static decode(e){const t=new c,r=s.TD.decode(e).split("\r\n"),n=r[0];if(n!==o){let e=n.replace(o,"");t.code=parseInt(e,10);const r=t.code.toString();e=e.replace(r,""),t.description=e.trim()}return r.length>=1&&r.slice(1).map((e=>{if(e){const r=e.indexOf(":");if(r>-1){const n=e.slice(0,r),s=e.slice(r+1).trim();t.append(n,s)}}})),t}toString(){if(0===this.headers.size)return"";let e=o;for(const[t,r]of this.headers)for(let n=0;n<r.length;n++)e=`${e}\r\n${t}: ${r[n]}`;return`${e}\r\n\r\n`}encode(){return s.TE.encode(this.toString())}static validHeaderValue(e){if(/[\r\n]/.test(e))throw new n.NatsError("invalid header value - \\r and \\n are not allowed.",n.ErrorCode.BadHeader);return e.trim()}keys(){const e=[];for(const t of this.headers.keys())e.push(t);return e}findKeys(e,t=a.Exact){const r=this.keys();switch(t){case a.Exact:return r.filter((t=>t===e));case a.CanonicalMIME:return e=i(e),r.filter((t=>t===e));default:{const t=e.toLowerCase();return r.filter((e=>t===e.toLowerCase()))}}}get(e,t=a.Exact){const r=this.findKeys(e,t);if(r.length){const e=this.headers.get(r[0]);if(e)return Array.isArray(e)?e[0]:e}return""}has(e,t=a.Exact){return this.findKeys(e,t).length>0}set(e,t,r=a.Exact){this.delete(e,r),this.append(e,t,r)}append(e,t,r=a.Exact){const n=i(e);r===a.CanonicalMIME&&(e=n);const s=this.findKeys(e,r);e=s.length>0?s[0]:e;const o=c.validHeaderValue(t);let u=this.headers.get(e);u||(u=[],this.headers.set(e,u)),u.push(o)}values(e,t=a.Exact){const r=[];return this.findKeys(e,t).forEach((e=>{const t=this.headers.get(e);t&&r.push(...t)})),r}delete(e,t=a.Exact){this.findKeys(e,t).forEach((e=>{this.headers.delete(e)}))}get hasError(){return this.code>=300}get status(){return`${this.code} ${this.description}`.trim()}}t.MsgHdrsImpl=c},786:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Heartbeat=void 0;const n=r(4875),s=r(9305);t.Heartbeat=class{constructor(e,t,r){this.ph=e,this.interval=t,this.maxOut=r,this.pendings=[]}start(){this.cancel(),this._schedule()}cancel(e){this.timer&&(clearTimeout(this.timer),this.timer=void 0),this._reset(),e&&this.ph.disconnect()}_schedule(){this.timer=setTimeout((()=>{if(this.ph.dispatchStatus({type:s.DebugEvents.PingTimer,data:`${this.pendings.length+1}`}),this.pendings.length===this.maxOut)return void this.cancel(!0);const e=n.deferred();this.ph.flush(e).then((()=>{this._reset()})).catch((()=>{this.cancel()})),this.pendings.push(e),this._schedule()}),this.interval)}_reset(){this.pendings=this.pendings.filter((e=>(e.resolve(),!1)))}}},7689:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.State=t.Parser=t.Kind=t.StringCodec=t.JSONCodec=t.nkeyAuthenticator=t.jwtAuthenticator=t.credsAuthenticator=t.Request=t.checkUnsupportedOption=t.checkOptions=t.DataBuffer=t.MuxSubscription=t.Heartbeat=t.MsgHdrsImpl=t.Match=t.headers=t.canonicalMIMEHeaderKey=t.timeout=t.render=t.extractProtocolMessage=t.extend=t.delay=t.deferred=t.ProtocolHandler=t.INFO=t.createInbox=t.Connect=t.setTransportFactory=t.Subscriptions=t.SubscriptionImpl=t.MsgImpl=t.JsHeaders=t.Events=t.Empty=t.DebugEvents=t.toJsMsg=t.consumerOpts=t.StorageType=t.RetentionPolicy=t.ReplayPolicy=t.DiscardPolicy=t.DeliverPolicy=t.AdvisoryKind=t.AckPolicy=t.NatsError=t.ErrorCode=t.nuid=t.Nuid=t.NatsConnectionImpl=void 0,t.nanos=t.millis=t.isHeartbeatMsg=t.isFlowControlMsg=t.TypedSubscription=t.parseIP=t.isIP=t.TE=t.TD=t.Metric=t.Bench=t.writeAll=t.readAll=t.MAX_SIZE=t.DenoBuffer=void 0;var i=r(8690);Object.defineProperty(t,"NatsConnectionImpl",{enumerable:!0,get:function(){return i.NatsConnectionImpl}});var o=r(3403);Object.defineProperty(t,"Nuid",{enumerable:!0,get:function(){return o.Nuid}}),Object.defineProperty(t,"nuid",{enumerable:!0,get:function(){return o.nuid}});var a=r(4219);Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return a.ErrorCode}}),Object.defineProperty(t,"NatsError",{enumerable:!0,get:function(){return a.NatsError}});var c=r(9305);Object.defineProperty(t,"AckPolicy",{enumerable:!0,get:function(){return c.AckPolicy}}),Object.defineProperty(t,"AdvisoryKind",{enumerable:!0,get:function(){return c.AdvisoryKind}}),Object.defineProperty(t,"DeliverPolicy",{enumerable:!0,get:function(){return c.DeliverPolicy}}),Object.defineProperty(t,"DiscardPolicy",{enumerable:!0,get:function(){return c.DiscardPolicy}}),Object.defineProperty(t,"ReplayPolicy",{enumerable:!0,get:function(){return c.ReplayPolicy}}),Object.defineProperty(t,"RetentionPolicy",{enumerable:!0,get:function(){return c.RetentionPolicy}}),Object.defineProperty(t,"StorageType",{enumerable:!0,get:function(){return c.StorageType}});var u=r(8984);Object.defineProperty(t,"consumerOpts",{enumerable:!0,get:function(){return u.consumerOpts}});var h=r(5353);Object.defineProperty(t,"toJsMsg",{enumerable:!0,get:function(){return h.toJsMsg}});var l=r(9305);Object.defineProperty(t,"DebugEvents",{enumerable:!0,get:function(){return l.DebugEvents}}),Object.defineProperty(t,"Empty",{enumerable:!0,get:function(){return l.Empty}}),Object.defineProperty(t,"Events",{enumerable:!0,get:function(){return l.Events}}),Object.defineProperty(t,"JsHeaders",{enumerable:!0,get:function(){return l.JsHeaders}});var d=r(5089);Object.defineProperty(t,"MsgImpl",{enumerable:!0,get:function(){return d.MsgImpl}});var f=r(6807);Object.defineProperty(t,"SubscriptionImpl",{enumerable:!0,get:function(){return f.SubscriptionImpl}});var p=r(7312);Object.defineProperty(t,"Subscriptions",{enumerable:!0,get:function(){return p.Subscriptions}});var y=r(4938);Object.defineProperty(t,"setTransportFactory",{enumerable:!0,get:function(){return y.setTransportFactory}});var b=r(413);Object.defineProperty(t,"Connect",{enumerable:!0,get:function(){return b.Connect}}),Object.defineProperty(t,"createInbox",{enumerable:!0,get:function(){return b.createInbox}}),Object.defineProperty(t,"INFO",{enumerable:!0,get:function(){return b.INFO}}),Object.defineProperty(t,"ProtocolHandler",{enumerable:!0,get:function(){return b.ProtocolHandler}});var g=r(4875);Object.defineProperty(t,"deferred",{enumerable:!0,get:function(){return g.deferred}}),Object.defineProperty(t,"delay",{enumerable:!0,get:function(){return g.delay}}),Object.defineProperty(t,"extend",{enumerable:!0,get:function(){return g.extend}}),Object.defineProperty(t,"extractProtocolMessage",{enumerable:!0,get:function(){return g.extractProtocolMessage}}),Object.defineProperty(t,"render",{enumerable:!0,get:function(){return g.render}}),Object.defineProperty(t,"timeout",{enumerable:!0,get:function(){return g.timeout}});var m=r(8648);Object.defineProperty(t,"canonicalMIMEHeaderKey",{enumerable:!0,get:function(){return m.canonicalMIMEHeaderKey}}),Object.defineProperty(t,"headers",{enumerable:!0,get:function(){return m.headers}}),Object.defineProperty(t,"Match",{enumerable:!0,get:function(){return m.Match}}),Object.defineProperty(t,"MsgHdrsImpl",{enumerable:!0,get:function(){return m.MsgHdrsImpl}});var v=r(786);Object.defineProperty(t,"Heartbeat",{enumerable:!0,get:function(){return v.Heartbeat}});var w=r(9224);Object.defineProperty(t,"MuxSubscription",{enumerable:!0,get:function(){return w.MuxSubscription}});var _=r(593);Object.defineProperty(t,"DataBuffer",{enumerable:!0,get:function(){return _.DataBuffer}});var E=r(5706);Object.defineProperty(t,"checkOptions",{enumerable:!0,get:function(){return E.checkOptions}}),Object.defineProperty(t,"checkUnsupportedOption",{enumerable:!0,get:function(){return E.checkUnsupportedOption}});var P=r(3572);Object.defineProperty(t,"Request",{enumerable:!0,get:function(){return P.Request}});var S=r(5009);Object.defineProperty(t,"credsAuthenticator",{enumerable:!0,get:function(){return S.credsAuthenticator}}),Object.defineProperty(t,"jwtAuthenticator",{enumerable:!0,get:function(){return S.jwtAuthenticator}}),Object.defineProperty(t,"nkeyAuthenticator",{enumerable:!0,get:function(){return S.nkeyAuthenticator}});var C=r(5234);Object.defineProperty(t,"JSONCodec",{enumerable:!0,get:function(){return C.JSONCodec}}),Object.defineProperty(t,"StringCodec",{enumerable:!0,get:function(){return C.StringCodec}}),s(r(5983),t);var A=r(1962);Object.defineProperty(t,"Kind",{enumerable:!0,get:function(){return A.Kind}}),Object.defineProperty(t,"Parser",{enumerable:!0,get:function(){return A.Parser}}),Object.defineProperty(t,"State",{enumerable:!0,get:function(){return A.State}});var O=r(8571);Object.defineProperty(t,"DenoBuffer",{enumerable:!0,get:function(){return O.DenoBuffer}}),Object.defineProperty(t,"MAX_SIZE",{enumerable:!0,get:function(){return O.MAX_SIZE}}),Object.defineProperty(t,"readAll",{enumerable:!0,get:function(){return O.readAll}}),Object.defineProperty(t,"writeAll",{enumerable:!0,get:function(){return O.writeAll}});var x=r(7742);Object.defineProperty(t,"Bench",{enumerable:!0,get:function(){return x.Bench}}),Object.defineProperty(t,"Metric",{enumerable:!0,get:function(){return x.Metric}});var I=r(7699);Object.defineProperty(t,"TD",{enumerable:!0,get:function(){return I.TD}}),Object.defineProperty(t,"TE",{enumerable:!0,get:function(){return I.TE}});var M=r(7639);Object.defineProperty(t,"isIP",{enumerable:!0,get:function(){return M.isIP}}),Object.defineProperty(t,"parseIP",{enumerable:!0,get:function(){return M.parseIP}});var N=r(1303);Object.defineProperty(t,"TypedSubscription",{enumerable:!0,get:function(){return N.TypedSubscription}});var k=r(8100);Object.defineProperty(t,"isFlowControlMsg",{enumerable:!0,get:function(){return k.isFlowControlMsg}}),Object.defineProperty(t,"isHeartbeatMsg",{enumerable:!0,get:function(){return k.isHeartbeatMsg}}),Object.defineProperty(t,"millis",{enumerable:!0,get:function(){return k.millis}}),Object.defineProperty(t,"nanos",{enumerable:!0,get:function(){return k.nanos}})},7639:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseIP=t.isIP=t.ipV4=void 0;const r=16,n=16777215;function s(e,t,n,s){const i=new Uint8Array(r);return[0,0,0,0,0,0,0,0,0,0,255,255].forEach(((e,t)=>{i[t]=e})),i[12]=e,i[13]=t,i[14]=n,i[15]=s,i}function i(e){for(let t=0;t<e.length;t++)switch(e[t]){case".":return o(e);case":":return a(e)}}function o(e){const t=new Uint8Array(4);for(let r=0;r<4;r++){if(0===e.length)return;if(r>0){if("."!==e[0])return;e=e.substring(1)}const{n,c:s,ok:i}=c(e);if(!i||n>255)return;e=e.substring(s),t[r]=n}return s(t[0],t[1],t[2],t[3])}function a(e){const t=new Uint8Array(r);let n=-1;if(e.length>=2&&":"===e[0]&&":"===e[1]&&(n=0,0===(e=e.substring(2)).length))return t;let s=0;for(;s<r;){const{n:i,c:a,ok:c}=u(e);if(!c||i>65535)return;if(a<e.length&&"."===e[a]){if(n<0&&12!=s)return;if(s+4>r)return;const i=o(e);if(void 0===i)return;t[s]=i[12],t[s+1]=i[13],t[s+2]=i[14],t[s+3]=i[15],e="",s+=4;break}if(t[s]=i>>8,t[s+1]=i,s+=2,0===(e=e.substring(a)).length)break;if(":"!==e[0]||1==e.length)return;if(":"===(e=e.substring(1))[0]){if(n>=0)return;if(n=s,0===(e=e.substring(1)).length)break}}if(0===e.length){if(s<r){if(n<0)return;const e=r-s;for(let r=s-1;r>=n;r--)t[r+e]=t[r];for(let r=n+e-1;r>=n;r--)t[r]=0}else if(n>=0)return;return t}}function c(e){let t=0,r=0;for(t=0;t<e.length&&48<=e.charCodeAt(t)&&e.charCodeAt(t)<=57;t++)if(r=10*r+(e.charCodeAt(t)-48),r>=n)return{n,c:t,ok:!1};return 0===t?{n:0,c:0,ok:!1}:{n:r,c:t,ok:!0}}function u(e){let t=0,r=0;for(r=0;r<e.length;r++){if(48<=e.charCodeAt(r)&&e.charCodeAt(r)<=57)t*=16,t+=e.charCodeAt(r)-48;else if(97<=e.charCodeAt(r)&&e.charCodeAt(r)<=102)t*=16,t+=e.charCodeAt(r)-97+10;else{if(!(65<=e.charCodeAt(r)&&e.charCodeAt(r)<=70))break;t*=16,t+=e.charCodeAt(r)-65+10}if(t>=n)return{n:0,c:r,ok:!1}}return 0===r?{n:0,c:r,ok:!1}:{n:t,c:r,ok:!0}}t.ipV4=s,t.isIP=function(e){return void 0!==i(e)},t.parseIP=i},8146:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseApiClient=t.defaultJsOptions=void 0;const s=r(9305),i=r(5234),o=r(4875),a=r(8100);function c(e){return(e=e||{}).domain&&(e.apiPrefix=`$JS.${e.domain}.API`,delete e.domain),o.extend({apiPrefix:"$JS.API",timeout:5e3},e)}t.defaultJsOptions=c,t.BaseApiClient=class{constructor(e,t){this.nc=e,this.opts=c(t),this._parseOpts(),this.prefix=this.opts.apiPrefix,this.timeout=this.opts.timeout,this.jc=i.JSONCodec()}_parseOpts(){let e=this.opts.apiPrefix;if(!e||0===e.length)throw new Error("invalid empty prefix");"."===e[e.length-1]&&(e=e.substr(0,e.length-1)),this.opts.apiPrefix=e}_request(e,t=null,r){return n(this,void 0,void 0,(function*(){(r=r||{}).timeout=this.timeout;let n=s.Empty;t&&(n=this.jc.encode(t));const i=yield this.nc.request(e,n,r);return this.parseJsResponse(i)}))}findStream(e){return n(this,void 0,void 0,(function*(){const t={subject:e},r=yield this._request(`${this.prefix}.STREAM.NAMES`,t);if(!r.streams||1!==r.streams.length)throw new Error("no stream matches subject");return r.streams[0]}))}parseJsResponse(e){const t=this.jc.decode(e.data),r=t;if(r.error){const e=a.checkJsErrorCode(r.error.code,r.error.description);if(null!==e)throw e}return t}}},9229:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.JetStreamClientImpl=void 0;const s=r(9305),i=r(8146),o=r(8100),a=r(8978),c=r(5353),u=r(1303),h=r(4219),l=r(3849),d=r(4875),f=r(413),p=r(8648),y=r(8984);var b;!function(e){e.MsgIdHdr="Nats-Msg-Id",e.ExpectedStreamHdr="Nats-Expected-Stream",e.ExpectedLastSeqHdr="Nats-Expected-Last-Sequence",e.ExpectedLastMsgIdHdr="Nats-Expected-Last-Msg-Id",e.ExpectedLastSubjectSequenceHdr="Nats-Expected-Last-Subject-Sequence"}(b||(b={}));class g extends i.BaseApiClient{constructor(e,t){super(e,t),this.api=new a.ConsumerAPIImpl(e,t)}publish(e,t=s.Empty,r){return n(this,void 0,void 0,(function*(){(r=r||{}).expect=r.expect||{};const n=(null==r?void 0:r.headers)||p.headers();r&&(r.msgID&&n.set(b.MsgIdHdr,r.msgID),r.expect.lastMsgID&&n.set(b.ExpectedLastMsgIdHdr,r.expect.lastMsgID),r.expect.streamName&&n.set(b.ExpectedStreamHdr,r.expect.streamName),r.expect.lastSequence&&n.set(b.ExpectedLastSeqHdr,`${r.expect.lastSequence}`),r.expect.lastSubjectSequence&&n.set(b.ExpectedLastSubjectSequenceHdr,`${r.expect.lastSubjectSequence}`));const s=r.timeout||this.timeout,i={};s&&(i.timeout=s),r&&(i.headers=n);const o=yield this.nc.request(e,t,i),a=this.parseJsResponse(o);if(""===a.stream)throw h.NatsError.errorForCode(h.ErrorCode.JetStreamInvalidAck);return a.duplicate=!!a.duplicate&&a.duplicate,a}))}pull(e,t){return n(this,void 0,void 0,(function*(){o.validateStreamName(e),o.validateDurableName(t);const r=yield this.nc.request(`${this.prefix}.CONSUMER.MSG.NEXT.${e}.${t}`,this.jc.encode({no_wait:!0,batch:1,expires:o.nanos(this.timeout)}),{noMux:!0,timeout:this.timeout}),n=o.checkJsError(r);if(n)throw n;return c.toJsMsg(r)}))}fetch(e,t,r={}){o.validateStreamName(e),o.validateDurableName(t);let s=null;const i={};i.batch=r.batch||1,i.no_wait=r.no_wait||!1;const a=r.expires||0;if(a&&(i.expires=o.nanos(a)),0===a&&!1===i.no_wait)throw new Error("expires or no_wait is required");const u=new l.QueuedIteratorImpl,p=i.batch;let y=0;u.dispatchedFn=e=>{if(e){if(y++,s&&0===e.info.pending)return;(1===u.getPending()&&0===e.info.pending||p===y)&&u.stop()}};const b=f.createInbox(this.nc.options.inboxPrefix),g=this.nc.subscribe(b,{max:r.batch,callback:(e,t)=>{null===e&&(e=o.checkJsError(t)),null!==e?(s&&(s.cancel(),s=null),h.isNatsError(e)&&e.code===h.ErrorCode.JetStream404NoMessages?u.stop():u.stop(e)):(u.received++,u.push(c.toJsMsg(t)))}});return a&&(s=d.timeout(a),s.catch((()=>{g.isClosed()||(g.drain(),s=null)}))),(()=>n(this,void 0,void 0,(function*(){yield g.closed,null!==s&&(s.cancel(),s=null),u.stop()})))().catch(),this.nc.publish(`${this.prefix}.CONSUMER.MSG.NEXT.${e}.${t}`,this.jc.encode(i),{reply:b}),u}pullSubscribe(e,t=y.consumerOpts()){return n(this,void 0,void 0,(function*(){const r=yield this._processOptions(e,t);if(r.attached||(r.config.filter_subject=e),r.config.deliver_subject)throw new Error("consumer info specifies deliver_subject - pull consumers cannot have deliver_subject set");const n=r.config.ack_policy;if(n===s.AckPolicy.None||n===s.AckPolicy.All)throw new Error("ack policy for pull consumers must be explicit");const i=this._buildTypedSubscriptionOpts(r),o=new v(this,r.deliver,i);try{yield this._maybeCreateConsumer(r)}catch(e){throw o.unsubscribe(),e}return o.info=r,o}))}subscribe(e,t=y.consumerOpts()){return n(this,void 0,void 0,(function*(){const r=yield this._processOptions(e,t);if(!r.config.deliver_subject)throw new Error("consumer info specifies a pull consumer - deliver_subject is required");const n=this._buildTypedSubscriptionOpts(r),s=new m(this,r.deliver,n);try{yield this._maybeCreateConsumer(r)}catch(e){throw s.unsubscribe(),e}return s.info=r,s}))}_processOptions(e,t=y.consumerOpts()){return n(this,void 0,void 0,(function*(){const r=y.isConsumerOptsBuilder(t)?t.getOpts():t;if(r.api=this,r.config=r.config||{},r.stream=r.stream?r.stream:yield this.findStream(e),r.attached=!1,r.config.durable_name)try{const t=yield this.api.info(r.stream,r.config.durable_name);if(t){if(t.config.filter_subject&&t.config.filter_subject!==e)throw new Error("subject does not match consumer");r.config=t.config,r.attached=!0}}catch(e){if("404"!==e.code)throw e}return r.attached||(r.config.filter_subject=e),r.deliver=r.config.deliver_subject||f.createInbox(this.nc.options.inboxPrefix),r}))}_buildTypedSubscriptionOpts(e){const t={};return t.adapter=void 0===e.callbackFn?_:w,e.callbackFn&&(t.callback=e.callbackFn),e.mack||(t.dispatchedFn=E),t.max=e.max||0,t.queue=e.queue,t}_maybeCreateConsumer(e){return n(this,void 0,void 0,(function*(){if(e.attached)return;e.config=Object.assign({deliver_policy:s.DeliverPolicy.All,ack_policy:s.AckPolicy.Explicit,ack_wait:o.nanos(3e4),replay_policy:s.ReplayPolicy.Instant},e.config);const t=yield this.api.add(e.stream,e.config);e.name=t.name,e.config=t.config}))}}t.JetStreamClientImpl=g;class m extends u.TypedSubscription{constructor(e,t,r){super(e.nc,t,r)}set info(e){this.sub.info=e}get info(){return this.sub.info}destroy(){return n(this,void 0,void 0,(function*(){this.isClosed()||(yield this.drain());const e=this.sub.info,t=e.config.durable_name||e.name,r=`${e.api.prefix}.CONSUMER.DELETE.${e.stream}.${t}`;yield e.api._request(r)}))}consumerInfo(){return n(this,void 0,void 0,(function*(){const e=this.sub.info,t=e.config.durable_name||e.name,r=`${e.api.prefix}.CONSUMER.INFO.${e.stream}.${t}`;return yield e.api._request(r)}))}}class v extends m{constructor(e,t,r){super(e,t,r)}pull(e={batch:1}){const{stream:t,config:r}=this.sub.info,n=r.durable_name,s={};if(s.batch=e.batch||1,s.no_wait=e.no_wait||!1,e.expires&&e.expires>0&&(s.expires=e.expires),this.info){const e=this.info.api,r=`${e.prefix}.CONSUMER.MSG.NEXT.${t}.${n}`,i=this.sub.subject;e.nc.publish(r,e.jc.encode(s),{reply:i})}}}function w(e,t){if(e)return[e,null];if(e=o.checkJsError(t))return[e,null];if(o.isFlowControlMsg(t))return t.respond(),[null,null];const r=c.toJsMsg(t);try{return r.info,[null,r]}catch(e){return[e,null]}}function _(e,t){if(e)return[e,null];const r=o.checkJsError(t);if(null!==r)switch(r.code){case h.ErrorCode.JetStream404NoMessages:case h.ErrorCode.JetStream408RequestTimeout:case h.ErrorCode.JetStream409MaxAckPendingExceeded:return[null,null];default:return[r,null]}if(o.isFlowControlMsg(t))return t.respond(),[null,null];const n=c.toJsMsg(t);try{return n.info,[null,n]}catch(e){return[e,null]}}function E(e){e&&e.ack()}},8978:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ConsumerAPIImpl=void 0;const s=r(8146),i=r(6301),o=r(8100);class a extends s.BaseApiClient{constructor(e,t){super(e,t)}add(e,t){return n(this,void 0,void 0,(function*(){o.validateStreamName(e);const r={};r.config=t,r.stream_name=e,r.config.durable_name&&o.validateDurableName(r.config.durable_name);const n=t.durable_name?`${this.prefix}.CONSUMER.DURABLE.CREATE.${e}.${t.durable_name}`:`${this.prefix}.CONSUMER.CREATE.${e}`;return yield this._request(n,r)}))}info(e,t){return n(this,void 0,void 0,(function*(){return o.validateStreamName(e),o.validateDurableName(t),yield this._request(`${this.prefix}.CONSUMER.INFO.${e}.${t}`)}))}delete(e,t){return n(this,void 0,void 0,(function*(){return o.validateStreamName(e),o.validateDurableName(t),(yield this._request(`${this.prefix}.CONSUMER.DELETE.${e}.${t}`)).success}))}list(e){o.validateStreamName(e);const t=`${this.prefix}.CONSUMER.LIST.${e}`;return new i.ListerImpl(t,(e=>e.consumers),this)}}t.ConsumerAPIImpl=a},8984:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isConsumerOptsBuilder=t.ConsumerOptsBuilderImpl=t.consumerOpts=void 0;const n=r(9305),s=r(8100);t.consumerOpts=function(e){return new i(e)};class i{constructor(e){this.stream="",this.mack=!1,this.config=s.defaultConsumer("",e||{}),this.config.ack_policy=n.AckPolicy.All}getOpts(){const e={};return e.config=this.config,e.mack=this.mack,e.stream=this.stream,e.callbackFn=this.callbackFn,e.max=this.max,e.queue=this.qname,e}deliverTo(e){this.config.deliver_subject=e}manualAck(){this.mack=!0}durable(e){s.validateDurableName(e),this.config.durable_name=e}deliverAll(){this.config.deliver_policy=n.DeliverPolicy.All}deliverLast(){this.config.deliver_policy=n.DeliverPolicy.Last}deliverNew(){this.config.deliver_policy=n.DeliverPolicy.New}startSequence(e){if(e<=0)throw new Error("sequence must be greater than 0");this.config.deliver_policy=n.DeliverPolicy.StartSequence,this.config.opt_start_seq=e}startTime(e){this.config.deliver_policy=n.DeliverPolicy.StartTime,this.config.opt_start_time=e.toISOString()}ackNone(){this.config.ack_policy=n.AckPolicy.None}ackAll(){this.config.ack_policy=n.AckPolicy.All}ackExplicit(){this.config.ack_policy=n.AckPolicy.Explicit}maxDeliver(e){this.config.max_deliver=e}maxAckPending(e){this.config.max_ack_pending=e}maxWaiting(e){this.config.max_waiting=e}maxMessages(e){this.max=e}callback(e){this.callbackFn=e}queue(e){this.qname=e}idleHeartbeat(e){this.config.idle_heartbeat=s.nanos(e)}flowControl(){this.config.flow_control=!0}}t.ConsumerOptsBuilderImpl=i,t.isConsumerOptsBuilder=function(e){return"function"==typeof e.getOpts}},6301:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},n=this&&this.__await||function(e){return this instanceof n?(this.v=e,this):new n(e)},s=this&&this.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,i=r.apply(e,t||[]),o=[];return s={},a("next"),a("throw"),a("return"),s[Symbol.asyncIterator]=function(){return this},s;function a(e){i[e]&&(s[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=i[e](t)).value instanceof n?Promise.resolve(r.value.v).then(u,h):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function u(e){c("next",e)}function h(e){c("throw",e)}function l(e,t){e(t),o.shift(),o.length&&c(o[0][0],o[0][1])}};Object.defineProperty(t,"__esModule",{value:!0}),t.ListerImpl=void 0;class i{constructor(e,t,r){if(!e)throw new Error("subject is required");this.subject=e,this.jsm=r,this.offset=0,this.pageInfo={},this.filter=t}next(){return r(this,void 0,void 0,(function*(){if(this.err)return[];if(this.pageInfo&&this.offset>=this.pageInfo.total)return[];const e={offset:this.offset};try{const t=yield this.jsm._request(this.subject,e,{timeout:this.jsm.timeout});this.pageInfo=t;const r=this.filter(t);return this.offset+=r.length,r}catch(e){throw this.err=e,e}}))}[Symbol.asyncIterator](){return s(this,arguments,(function*(){let e=yield n(this.next());for(;e.length>0;){for(const t of e)yield yield n(t);e=yield n(this.next())}}))}}t.ListerImpl=i},5068:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.JetStreamManagerImpl=void 0;const s=r(8146),i=r(6870),o=r(8978),a=r(3849);class c extends s.BaseApiClient{constructor(e,t){super(e,t),this.streams=new i.StreamAPIImpl(e,t),this.consumers=new o.ConsumerAPIImpl(e,t)}getAccountInfo(){return n(this,void 0,void 0,(function*(){return yield this._request(`${this.prefix}.INFO`)}))}advisories(){const e=new a.QueuedIteratorImpl;return this.nc.subscribe("$JS.EVENT.ADVISORY.>",{callback:(t,r)=>{if(t)throw t;try{const t=this.parseJsResponse(r),n=t.type.split("."),s=n[n.length-1];e.push({kind:s,data:t})}catch(t){e.stop(t)}}}),e}}t.JetStreamManagerImpl=c},5353:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.parseInfo=t.toJsMsg=t.ACK=void 0;const s=r(593),i=r(5234),o=r(3572);t.ACK=Uint8Array.of(43,65,67,75);const a=Uint8Array.of(45,78,65,75),c=Uint8Array.of(43,87,80,73),u=Uint8Array.of(43,78,88,84),h=Uint8Array.of(43,84,69,82,77),l=Uint8Array.of(32);function d(e){const t=e.split(".");if(9!==t.length&&"$JS"!==t[0]&&"ACK"!==t[1])throw new Error("not js message");const r={};return r.stream=t[2],r.consumer=t[3],r.redeliveryCount=parseInt(t[4],10),r.streamSequence=parseInt(t[5],10),r.deliverySequence=parseInt(t[6],10),r.timestampNanos=parseInt(t[7],10),r.pending=parseInt(t[8],10),r}t.toJsMsg=function(e){return new f(e)},t.parseInfo=d;class f{constructor(e){this.msg=e,this.didAck=!1}get subject(){return this.msg.subject}get sid(){return this.msg.sid}get data(){return this.msg.data}get headers(){return this.msg.headers}get info(){return this.di||(this.di=d(this.reply)),this.di}get redelivered(){return this.info.redeliveryCount>1}get reply(){return this.msg.reply||""}get seq(){return this.info.streamSequence}doAck(e){this.didAck||(this.didAck=!this.isWIP(e),this.msg.respond(e))}isWIP(e){return 4===e.length&&e[0]===c[0]&&e[1]===c[1]&&e[2]===c[2]&&e[3]===c[3]}ackAck(){return n(this,void 0,void 0,(function*(){if(!this.didAck&&(this.didAck=!0,this.msg.reply)){const e=this.msg.publisher,r=new o.Request(e.muxSubscriptions);e.request(r);try{e.publish(this.msg.reply,t.ACK,{reply:`${e.muxSubscriptions.baseInbox}${r.token}`})}catch(e){r.cancel(e)}try{return yield Promise.race([r.timer,r.deferred]),!0}catch(e){r.cancel(e)}}return!1}))}ack(){this.doAck(t.ACK)}nak(){this.doAck(a)}working(){this.doAck(c)}next(e,t){let r=u;if(t){const e=i.JSONCodec().encode(t);r=s.DataBuffer.concat(u,l,e)}const n=e?{reply:e}:void 0;this.msg.respond(r,n)}term(){this.doAck(h)}}},6870:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StoredMsgImpl=t.StreamAPIImpl=void 0;const s=r(9305),i=r(8146),o=r(6301),a=r(8100),c=r(8648);class u extends i.BaseApiClient{constructor(e,t){super(e,t)}add(e={}){return n(this,void 0,void 0,(function*(){return a.validateStreamName(e.name),yield this._request(`${this.prefix}.STREAM.CREATE.${e.name}`,e)}))}delete(e){return n(this,void 0,void 0,(function*(){return a.validateStreamName(e),(yield this._request(`${this.prefix}.STREAM.DELETE.${e}`)).success}))}update(e={}){return n(this,void 0,void 0,(function*(){return a.validateStreamName(e.name),yield this._request(`${this.prefix}.STREAM.UPDATE.${e.name}`,e)}))}info(e,t){return n(this,void 0,void 0,(function*(){return a.validateStreamName(e),yield this._request(`${this.prefix}.STREAM.INFO.${e}`,t)}))}list(){const e=`${this.prefix}.STREAM.LIST`;return new o.ListerImpl(e,(e=>e.streams),this)}purge(e,t){return n(this,void 0,void 0,(function*(){if(t){const{keep:e,seq:r}=t;if("number"==typeof e&&"number"==typeof r)throw new Error("can specify one of keep or seq")}return a.validateStreamName(e),yield this._request(`${this.prefix}.STREAM.PURGE.${e}`,t)}))}deleteMessage(e,t,r=!0){return n(this,void 0,void 0,(function*(){a.validateStreamName(e);const n={seq:t};return r||(n.no_erase=!0),(yield this._request(`${this.prefix}.STREAM.MSG.DELETE.${e}`,n)).success}))}getMessage(e,t){return n(this,void 0,void 0,(function*(){"number"==typeof t&&(console.log("[33m [WARN] jsm.getMessage(number) is deprecated and will be removed on release - use `{seq: number}` as an argument [0m"),t={seq:t}),a.validateStreamName(e);const r=yield this._request(`${this.prefix}.STREAM.MSG.GET.${e}`,t);return new h(r)}))}find(e){return this.findStream(e)}}t.StreamAPIImpl=u;class h{constructor(e){if(this.subject=e.message.subject,this.seq=e.message.seq,this.time=new Date(e.message.time),this.data=e.message.data?this._parse(e.message.data):s.Empty,e.message.hdrs){const t=this._parse(e.message.hdrs);this.header=c.MsgHdrsImpl.decode(t)}else this.header=c.headers()}_parse(e){const t=atob(e),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);return n}}t.StoredMsgImpl=h},8100:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkJsErrorCode=t.checkJsError=t.isHeartbeatMsg=t.isFlowControlMsg=t.millis=t.nanos=t.defaultConsumer=t.validateName=t.validateStreamName=t.validateDurableName=void 0;const n=r(9305),s=r(4219);function i(e,t=""){if(""===t)throw Error(`${e} name required`);[".","*",">"].forEach((r=>{if(-1!==t.indexOf(r))throw Error(`invalid ${e} name - ${e} name cannot contain '${r}'`)}))}function o(e){return 1e6*e}function a(e){const t=e.headers;return!!t&&t.code>=100&&t.code<200}function c(e,t=""){if(e<300)return null;switch(t=t.toLowerCase(),e){case 503:return s.NatsError.errorForCode(s.ErrorCode.JetStreamNotEnabled,new Error(t));default:return""===t&&(t=s.ErrorCode.Unknown),new s.NatsError(t,`${e}`)}}t.validateDurableName=function(e){return i("durable",e)},t.validateStreamName=function(e){return i("stream",e)},t.validateName=i,t.defaultConsumer=function(e,t={}){return Object.assign({name:e,deliver_policy:n.DeliverPolicy.All,ack_policy:n.AckPolicy.Explicit,ack_wait:o(3e4),replay_policy:n.ReplayPolicy.Instant},t)},t.nanos=o,t.millis=function(e){return e/1e6},t.isFlowControlMsg=a,t.isHeartbeatMsg=function(e){var t;return a(e)&&"Idle Heartbeat"===(null===(t=e.headers)||void 0===t?void 0:t.description)},t.checkJsError=function(e){const t=e.headers;return t?c(t.code,t.status):null},t.checkJsErrorCode=c},6228:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toJsMsg=t.StringCodec=t.StorageType=t.RetentionPolicy=t.ReplayPolicy=t.nuid=t.Nuid=t.nkeyAuthenticator=t.NatsError=t.nanos=t.millis=t.Match=t.jwtAuthenticator=t.JSONCodec=t.JsHeaders=t.isHeartbeatMsg=t.isFlowControlMsg=t.headers=t.Events=t.ErrorCode=t.Empty=t.DiscardPolicy=t.DeliverPolicy=t.DebugEvents=t.credsAuthenticator=t.createInbox=t.consumerOpts=t.canonicalMIMEHeaderKey=t.Bench=t.AdvisoryKind=t.AckPolicy=void 0;var n=r(7689);Object.defineProperty(t,"AckPolicy",{enumerable:!0,get:function(){return n.AckPolicy}}),Object.defineProperty(t,"AdvisoryKind",{enumerable:!0,get:function(){return n.AdvisoryKind}}),Object.defineProperty(t,"Bench",{enumerable:!0,get:function(){return n.Bench}}),Object.defineProperty(t,"canonicalMIMEHeaderKey",{enumerable:!0,get:function(){return n.canonicalMIMEHeaderKey}}),Object.defineProperty(t,"consumerOpts",{enumerable:!0,get:function(){return n.consumerOpts}}),Object.defineProperty(t,"createInbox",{enumerable:!0,get:function(){return n.createInbox}}),Object.defineProperty(t,"credsAuthenticator",{enumerable:!0,get:function(){return n.credsAuthenticator}}),Object.defineProperty(t,"DebugEvents",{enumerable:!0,get:function(){return n.DebugEvents}}),Object.defineProperty(t,"DeliverPolicy",{enumerable:!0,get:function(){return n.DeliverPolicy}}),Object.defineProperty(t,"DiscardPolicy",{enumerable:!0,get:function(){return n.DiscardPolicy}}),Object.defineProperty(t,"Empty",{enumerable:!0,get:function(){return n.Empty}}),Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return n.ErrorCode}}),Object.defineProperty(t,"Events",{enumerable:!0,get:function(){return n.Events}}),Object.defineProperty(t,"headers",{enumerable:!0,get:function(){return n.headers}}),Object.defineProperty(t,"isFlowControlMsg",{enumerable:!0,get:function(){return n.isFlowControlMsg}}),Object.defineProperty(t,"isHeartbeatMsg",{enumerable:!0,get:function(){return n.isHeartbeatMsg}}),Object.defineProperty(t,"JsHeaders",{enumerable:!0,get:function(){return n.JsHeaders}}),Object.defineProperty(t,"JSONCodec",{enumerable:!0,get:function(){return n.JSONCodec}}),Object.defineProperty(t,"jwtAuthenticator",{enumerable:!0,get:function(){return n.jwtAuthenticator}}),Object.defineProperty(t,"Match",{enumerable:!0,get:function(){return n.Match}}),Object.defineProperty(t,"millis",{enumerable:!0,get:function(){return n.millis}}),Object.defineProperty(t,"nanos",{enumerable:!0,get:function(){return n.nanos}}),Object.defineProperty(t,"NatsError",{enumerable:!0,get:function(){return n.NatsError}}),Object.defineProperty(t,"nkeyAuthenticator",{enumerable:!0,get:function(){return n.nkeyAuthenticator}}),Object.defineProperty(t,"Nuid",{enumerable:!0,get:function(){return n.Nuid}}),Object.defineProperty(t,"nuid",{enumerable:!0,get:function(){return n.nuid}}),Object.defineProperty(t,"ReplayPolicy",{enumerable:!0,get:function(){return n.ReplayPolicy}}),Object.defineProperty(t,"RetentionPolicy",{enumerable:!0,get:function(){return n.RetentionPolicy}}),Object.defineProperty(t,"StorageType",{enumerable:!0,get:function(){return n.StorageType}}),Object.defineProperty(t,"StringCodec",{enumerable:!0,get:function(){return n.StringCodec}}),Object.defineProperty(t,"toJsMsg",{enumerable:!0,get:function(){return n.toJsMsg}})},5089:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsgImpl=t.isRequestError=void 0;const n=r(9305),s=r(8648),i=r(7699),o=r(4219);t.isRequestError=function(e){if(e&&e.headers){const t=e.headers;if(t.hasError){if(503===t.code)return o.NatsError.errorForCode(o.ErrorCode.NoResponders);{let e=t.description;return""===e&&(e=o.ErrorCode.RequestError),e=e.toLowerCase(),new o.NatsError(e,t.status)}}}return null},t.MsgImpl=class{constructor(e,t,r){this._msg=e,this._rdata=t,this.publisher=r}get subject(){return this._subject||(this._subject=i.TD.decode(this._msg.subject)),this._subject}get reply(){return this._reply||(this._reply=i.TD.decode(this._msg.reply)),this._reply}get sid(){return this._msg.sid}get headers(){if(this._msg.hdr>-1&&!this._headers){const e=this._rdata.subarray(0,this._msg.hdr);this._headers=s.MsgHdrsImpl.decode(e)}return this._headers}get data(){return this._rdata?this._msg.hdr>-1?this._rdata.subarray(this._msg.hdr):this._rdata:new Uint8Array(0)}respond(e=n.Empty,t){return!!this.reply&&(this.publisher.publish(this.reply,e,t),!0)}}},9224:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MuxSubscription=void 0;const n=r(4219),s=r(413),i=r(5089);t.MuxSubscription=class{constructor(){this.reqs=new Map}size(){return this.reqs.size}init(e){return this.baseInbox=`${s.createInbox(e)}.`,this.baseInbox}add(e){isNaN(e.received)||(e.received=0),this.reqs.set(e.token,e)}get(e){return this.reqs.get(e)}cancel(e){this.reqs.delete(e.token)}getToken(e){const t=e.subject||"";return 0===t.indexOf(this.baseInbox)?t.substring(this.baseInbox.length):null}dispatcher(){return(e,t)=>{const r=this.getToken(t);if(r){const n=this.get(r);n&&(null===e&&t.headers&&(e=i.isRequestError(t)),n.resolver(e,t))}}}close(){const e=n.NatsError.errorForCode(n.ErrorCode.Timeout);this.reqs.forEach((t=>{t.resolver(e,{})}))}}},8690:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,s){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,s,(t=e[r](t)).done,t.value)}))}}};Object.defineProperty(t,"__esModule",{value:!0}),t.NatsConnectionImpl=void 0;const i=r(4875),o=r(413),a=r(6807),c=r(4219),u=r(9305),h=r(5706),l=r(3849),d=r(3572),f=r(5089),p=r(5068),y=r(9229);class b{constructor(e){this.draining=!1,this.options=h.parseOptions(e),this.listeners=[]}static connect(e={}){return new Promise(((t,r)=>{const i=new b(e);o.ProtocolHandler.connect(i.options,i).then((e=>{i.protocol=e,function(){var t,r;n(this,void 0,void 0,(function*(){try{for(var n,o=s(e.status());!(n=yield o.next()).done;){const e=n.value;i.listeners.forEach((t=>{t.push(e)}))}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=o.return)&&(yield r.call(o))}finally{if(t)throw t.error}}}))}(),t(i)})).catch((e=>{r(e)}))}))}closed(){return this.protocol.closed}close(){return n(this,void 0,void 0,(function*(){yield this.protocol.close()}))}publish(e,t=u.Empty,r){if(0===(e=e||"").length)throw c.NatsError.errorForCode(c.ErrorCode.BadSubject);if(t&&!i.isUint8Array(t))throw c.NatsError.errorForCode(c.ErrorCode.BadPayload);this.protocol.publish(e,t,r)}subscribe(e,t={}){if(this.isClosed())throw c.NatsError.errorForCode(c.ErrorCode.ConnectionClosed);if(this.isDraining())throw c.NatsError.errorForCode(c.ErrorCode.ConnectionDraining);if(0===(e=e||"").length)throw c.NatsError.errorForCode(c.ErrorCode.BadSubject);const r=new a.SubscriptionImpl(this.protocol,e,t);return this.protocol.subscribe(r),r}request(e,t=u.Empty,r={timeout:1e3,noMux:!1}){if(this.isClosed())return Promise.reject(c.NatsError.errorForCode(c.ErrorCode.ConnectionClosed));if(this.isDraining())return Promise.reject(c.NatsError.errorForCode(c.ErrorCode.ConnectionDraining));if(0===(e=e||"").length)return Promise.reject(c.NatsError.errorForCode(c.ErrorCode.BadSubject));if(r.timeout=r.timeout||1e3,r.timeout<1)return Promise.reject(new c.NatsError("timeout",c.ErrorCode.InvalidOption));if(!r.noMux&&r.reply)return Promise.reject(new c.NatsError("reply can only be used with noMux",c.ErrorCode.InvalidOption));if(r.noMux){const n=r.reply?r.reply:o.createInbox(this.options.inboxPrefix),s=i.deferred();return this.subscribe(n,{max:1,timeout:r.timeout,callback:(e,t)=>{e||(e=f.isRequestError(t))?s.reject(e):s.resolve(t)}}),this.publish(e,t,{reply:n}),s}{const n=new d.Request(this.protocol.muxSubscriptions,r);this.protocol.request(n);try{this.publish(e,t,{reply:`${this.protocol.muxSubscriptions.baseInbox}${n.token}`,headers:r.headers})}catch(e){n.cancel(e)}const s=Promise.race([n.timer,n.deferred]);return s.catch((()=>{n.cancel()})),s}}flush(){return this.protocol.flush()}drain(){return this.isClosed()?Promise.reject(c.NatsError.errorForCode(c.ErrorCode.ConnectionClosed)):this.isDraining()?Promise.reject(c.NatsError.errorForCode(c.ErrorCode.ConnectionDraining)):(this.draining=!0,this.protocol.drain())}isClosed(){return this.protocol.isClosed()}isDraining(){return this.draining}getServer(){const e=this.protocol.getServer();return e?e.listen:""}status(){const e=new l.QueuedIteratorImpl;return this.listeners.push(e),e}get info(){return this.protocol.isClosed()?void 0:this.protocol.info}stats(){return{inBytes:this.protocol.inBytes,outBytes:this.protocol.outBytes,inMsgs:this.protocol.inMsgs,outMsgs:this.protocol.outMsgs}}jetstreamManager(e={}){return n(this,void 0,void 0,(function*(){g(this);const t=new p.JetStreamManagerImpl(this,e);try{yield t.getAccountInfo()}catch(e){const t=e;if(t.code===c.ErrorCode.NoResponders)throw c.NatsError.errorForCode(c.ErrorCode.JetStreamNotEnabled);throw t}return t}))}jetstream(e={}){return g(this),new y.JetStreamClientImpl(this,e)}}t.NatsConnectionImpl=b;const g=(()=>{let e=!1;return t=>{var r;if(!e){e=!0;const{lang:n}=null===(r=null==t?void 0:t.protocol)||void 0===r?void 0:r.transport;n?console.log(`[33m >> jetstream functionality in ${n} is preview functionality [0m`):console.log("[33m >> jetstream functionality is preview functionality [0m")}}})()},5983:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nkeys=void 0,t.nkeys=r(2902)},3403:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nuid=t.Nuid=void 0;const r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0xcfd41b9100000,s=function(){let e=null;return"undefined"!=typeof globalThis&&"crypto"in globalThis&&globalThis.crypto.getRandomValues&&(e=globalThis.crypto),e||(e={getRandomValues:function(e){for(let t=0;t<e.length;t++)e[t]=Math.floor(255*Math.random())}}),e}();class i{constructor(){this.buf=new Uint8Array(22),this.init()}init(){this.setPre(),this.initSeqAndInc(),this.fillSeq()}initSeqAndInc(){this.seq=Math.floor(Math.random()*n),this.inc=Math.floor(300*Math.random()+33)}setPre(){const e=new Uint8Array(12);s.getRandomValues(e);for(let t=0;t<12;t++){const n=e[t]%36;this.buf[t]=r.charCodeAt(n)}}fillSeq(){let e=this.seq;for(let t=21;t>=12;t--)this.buf[t]=r.charCodeAt(e%36),e=Math.floor(e/36)}next(){return this.seq+=this.inc,this.seq>n&&(this.setPre(),this.initSeqAndInc()),this.fillSeq(),String.fromCharCode.apply(String,this.buf)}reset(){this.init()}}t.Nuid=i,t.nuid=new i},5706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkUnsupportedOption=t.checkOptions=t.parseOptions=t.defaultOptions=void 0;const n=r(4875),s=r(4219),i=r(9305),o=r(5009),a=r(4938),c=r(6228);function u(){return{maxPingOut:i.DEFAULT_MAX_PING_OUT,maxReconnectAttempts:i.DEFAULT_MAX_RECONNECT_ATTEMPTS,noRandomize:!1,pedantic:!1,pingInterval:i.DEFAULT_PING_INTERVAL,reconnect:!0,reconnectJitter:i.DEFAULT_JITTER,reconnectJitterTLS:i.DEFAULT_JITTER_TLS,reconnectTimeWait:i.DEFAULT_RECONNECT_TIME_WAIT,tls:void 0,verbose:!1,waitOnFirstConnect:!1}}t.defaultOptions=u,t.parseOptions=function(e){const t=`${i.DEFAULT_HOST}:${a.defaultPort()}`;(e=e||{servers:[t]}).port&&(e.servers=[`${i.DEFAULT_HOST}:${e.port}`]),"string"==typeof e.servers&&(e.servers=[e.servers]),e.servers&&0===e.servers.length&&(e.servers=[t]);const r=n.extend(u(),e);if(e.user&&e.token)throw s.NatsError.errorForCode(s.ErrorCode.BadAuthentication);if(e.authenticator&&(e.token||e.user||e.pass))throw s.NatsError.errorForCode(s.ErrorCode.BadAuthentication);if(r.authenticator=o.buildAuthenticator(r),["reconnectDelayHandler","authenticator"].forEach((e=>{if(r[e]&&"function"!=typeof r[e])throw new s.NatsError(`${e} option should be a function`,s.ErrorCode.NotFunction)})),r.reconnectDelayHandler||(r.reconnectDelayHandler=()=>{let e=r.tls?r.reconnectJitterTLS:r.reconnectJitter;return e&&(e++,e=Math.floor(Math.random()*e)),r.reconnectTimeWait+e}),r.inboxPrefix)try{c.createInbox(r.inboxPrefix)}catch(e){throw new s.NatsError(e.message,s.ErrorCode.ApiError)}return r},t.checkOptions=function(e,t){const{proto:r,tls_required:n}=e;if((void 0===r||r<1)&&t.noEcho)throw new s.NatsError("noEcho",s.ErrorCode.ServerOptionNotAvailable);if(t.tls&&!n)throw new s.NatsError("tls",s.ErrorCode.ServerOptionNotAvailable)},t.checkUnsupportedOption=function(e,t){if(t)throw new s.NatsError(e,s.ErrorCode.InvalidOption)}},1962:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.State=t.Parser=t.describe=t.Kind=void 0;const n=r(8571),s=r(7699);var i,o,a;!function(e){e[e.OK=0]="OK",e[e.ERR=1]="ERR",e[e.MSG=2]="MSG",e[e.INFO=3]="INFO",e[e.PING=4]="PING",e[e.PONG=5]="PONG"}(i=t.Kind||(t.Kind={})),t.describe=function(e){let t,r="";switch(e.kind){case i.MSG:t="MSG";break;case i.OK:t="OK";break;case i.ERR:t="ERR",r=s.TD.decode(e.data);break;case i.PING:t="PING";break;case i.PONG:t="PONG";break;case i.INFO:t="INFO",r=s.TD.decode(e.data)}return`${t}: ${r}`},t.Parser=class{constructor(e){this.dispatcher=e,this.state=o.OP_START,this.as=0,this.drop=0,this.hdr=0}parse(t){let r;for(e.exports&&(t.subarray=t.slice),r=0;r<t.length;r++){const e=t[r];switch(this.state){case o.OP_START:switch(e){case a.M:case a.m:this.state=o.OP_M,this.hdr=-1,this.ma={sid:-1,hdr:-1,size:-1};break;case a.H:case a.h:this.state=o.OP_H,this.hdr=0,this.ma={sid:-1,hdr:-1,size:-1};break;case a.P:case a.p:this.state=o.OP_P;break;case a.PLUS:this.state=o.OP_PLUS;break;case a.MINUS:this.state=o.OP_MINUS;break;case a.I:case a.i:this.state=o.OP_I;break;default:throw this.fail(t.subarray(r))}break;case o.OP_H:switch(e){case a.M:case a.m:this.state=o.OP_M;break;default:throw this.fail(t.subarray(r))}break;case o.OP_M:switch(e){case a.S:case a.s:this.state=o.OP_MS;break;default:throw this.fail(t.subarray(r))}break;case o.OP_MS:switch(e){case a.G:case a.g:this.state=o.OP_MSG;break;default:throw this.fail(t.subarray(r))}break;case o.OP_MSG:switch(e){case a.SPACE:case a.TAB:this.state=o.OP_MSG_SPC;break;default:throw this.fail(t.subarray(r))}break;case o.OP_MSG_SPC:switch(e){case a.SPACE:case a.TAB:continue;default:this.state=o.MSG_ARG,this.as=r}break;case o.MSG_ARG:switch(e){case a.CR:this.drop=1;break;case a.NL:{const e=this.argBuf?this.argBuf.bytes():t.subarray(this.as,r-this.drop);this.processMsgArgs(e),this.drop=0,this.as=r+1,this.state=o.MSG_PAYLOAD,r=this.as+this.ma.size-1;break}default:this.argBuf&&this.argBuf.writeByte(e)}break;case o.MSG_PAYLOAD:if(this.msgBuf)if(this.msgBuf.length>=this.ma.size){const e=this.msgBuf.bytes({copy:!1});this.dispatcher.push({kind:i.MSG,msg:this.ma,data:e}),this.argBuf=void 0,this.msgBuf=void 0,this.state=o.MSG_END}else{let n=this.ma.size-this.msgBuf.length;const s=t.length-r;s<n&&(n=s),n>0?(this.msgBuf.write(t.subarray(r,r+n)),r=r+n-1):this.msgBuf.writeByte(e)}else r-this.as>=this.ma.size&&(this.dispatcher.push({kind:i.MSG,msg:this.ma,data:t.subarray(this.as,r)}),this.argBuf=void 0,this.msgBuf=void 0,this.state=o.MSG_END);break;case o.MSG_END:switch(e){case a.NL:this.drop=0,this.as=r+1,this.state=o.OP_START;break;default:continue}break;case o.OP_PLUS:switch(e){case a.O:case a.o:this.state=o.OP_PLUS_O;break;default:throw this.fail(t.subarray(r))}break;case o.OP_PLUS_O:switch(e){case a.K:case a.k:this.state=o.OP_PLUS_OK;break;default:throw this.fail(t.subarray(r))}break;case o.OP_PLUS_OK:switch(e){case a.NL:this.dispatcher.push({kind:i.OK}),this.drop=0,this.state=o.OP_START}break;case o.OP_MINUS:switch(e){case a.E:case a.e:this.state=o.OP_MINUS_E;break;default:throw this.fail(t.subarray(r))}break;case o.OP_MINUS_E:switch(e){case a.R:case a.r:this.state=o.OP_MINUS_ER;break;default:throw this.fail(t.subarray(r))}break;case o.OP_MINUS_ER:switch(e){case a.R:case a.r:this.state=o.OP_MINUS_ERR;break;default:throw this.fail(t.subarray(r))}break;case o.OP_MINUS_ERR:switch(e){case a.SPACE:case a.TAB:this.state=o.OP_MINUS_ERR_SPC;break;default:throw this.fail(t.subarray(r))}break;case o.OP_MINUS_ERR_SPC:switch(e){case a.SPACE:case a.TAB:continue;default:this.state=o.MINUS_ERR_ARG,this.as=r}break;case o.MINUS_ERR_ARG:switch(e){case a.CR:this.drop=1;break;case a.NL:{let e;this.argBuf?(e=this.argBuf.bytes(),this.argBuf=void 0):e=t.subarray(this.as,r-this.drop),this.dispatcher.push({kind:i.ERR,data:e}),this.drop=0,this.as=r+1,this.state=o.OP_START;break}default:this.argBuf&&this.argBuf.write(Uint8Array.of(e))}break;case o.OP_P:switch(e){case a.I:case a.i:this.state=o.OP_PI;break;case a.O:case a.o:this.state=o.OP_PO;break;default:throw this.fail(t.subarray(r))}break;case o.OP_PO:switch(e){case a.N:case a.n:this.state=o.OP_PON;break;default:throw this.fail(t.subarray(r))}break;case o.OP_PON:switch(e){case a.G:case a.g:this.state=o.OP_PONG;break;default:throw this.fail(t.subarray(r))}break;case o.OP_PONG:switch(e){case a.NL:this.dispatcher.push({kind:i.PONG}),this.drop=0,this.state=o.OP_START}break;case o.OP_PI:switch(e){case a.N:case a.n:this.state=o.OP_PIN;break;default:throw this.fail(t.subarray(r))}break;case o.OP_PIN:switch(e){case a.G:case a.g:this.state=o.OP_PING;break;default:throw this.fail(t.subarray(r))}break;case o.OP_PING:switch(e){case a.NL:this.dispatcher.push({kind:i.PING}),this.drop=0,this.state=o.OP_START}break;case o.OP_I:switch(e){case a.N:case a.n:this.state=o.OP_IN;break;default:throw this.fail(t.subarray(r))}break;case o.OP_IN:switch(e){case a.F:case a.f:this.state=o.OP_INF;break;default:throw this.fail(t.subarray(r))}break;case o.OP_INF:switch(e){case a.O:case a.o:this.state=o.OP_INFO;break;default:throw this.fail(t.subarray(r))}break;case o.OP_INFO:switch(e){case a.SPACE:case a.TAB:this.state=o.OP_INFO_SPC;break;default:throw this.fail(t.subarray(r))}break;case o.OP_INFO_SPC:switch(e){case a.SPACE:case a.TAB:continue;default:this.state=o.INFO_ARG,this.as=r}break;case o.INFO_ARG:switch(e){case a.CR:this.drop=1;break;case a.NL:{let e;this.argBuf?(e=this.argBuf.bytes(),this.argBuf=void 0):e=t.subarray(this.as,r-this.drop),this.dispatcher.push({kind:i.INFO,data:e}),this.drop=0,this.as=r+1,this.state=o.OP_START;break}default:this.argBuf&&this.argBuf.writeByte(e)}break;default:throw this.fail(t.subarray(r))}}this.state!==o.MSG_ARG&&this.state!==o.MINUS_ERR_ARG&&this.state!==o.INFO_ARG||this.argBuf||(this.argBuf=new n.DenoBuffer(t.subarray(this.as,r-this.drop))),this.state!==o.MSG_PAYLOAD||this.msgBuf||(this.argBuf||this.cloneMsgArg(),this.msgBuf=new n.DenoBuffer(t.subarray(this.as)))}cloneMsgArg(){const e=this.ma.subject.length,t=this.ma.reply?this.ma.reply.length:0,r=new Uint8Array(e+t);r.set(this.ma.subject),this.ma.reply&&r.set(this.ma.reply,e),this.argBuf=new n.DenoBuffer(r),this.ma.subject=r.subarray(0,e),this.ma.reply&&(this.ma.reply=r.subarray(e))}processMsgArgs(e){if(this.hdr>=0)return this.processHeaderMsgArgs(e);const t=[];let r=-1;for(let n=0;n<e.length;n++)switch(e[n]){case a.SPACE:case a.TAB:case a.CR:case a.NL:r>=0&&(t.push(e.subarray(r,n)),r=-1);break;default:r<0&&(r=n)}switch(r>=0&&t.push(e.subarray(r)),t.length){case 3:this.ma.subject=t[0],this.ma.sid=this.protoParseInt(t[1]),this.ma.reply=void 0,this.ma.size=this.protoParseInt(t[2]);break;case 4:this.ma.subject=t[0],this.ma.sid=this.protoParseInt(t[1]),this.ma.reply=t[2],this.ma.size=this.protoParseInt(t[3]);break;default:throw this.fail(e,"processMsgArgs Parse Error")}if(this.ma.sid<0)throw this.fail(e,"processMsgArgs Bad or Missing Sid Error");if(this.ma.size<0)throw this.fail(e,"processMsgArgs Bad or Missing Size Error")}fail(e,t=""){return t=t?`${t} [${this.state}]`:`parse error [${this.state}]`,new Error(`${t}: ${s.TD.decode(e)}`)}processHeaderMsgArgs(e){const t=[];let r=-1;for(let n=0;n<e.length;n++)switch(e[n]){case a.SPACE:case a.TAB:case a.CR:case a.NL:r>=0&&(t.push(e.subarray(r,n)),r=-1);break;default:r<0&&(r=n)}switch(r>=0&&t.push(e.subarray(r)),t.length){case 4:this.ma.subject=t[0],this.ma.sid=this.protoParseInt(t[1]),this.ma.reply=void 0,this.ma.hdr=this.protoParseInt(t[2]),this.ma.size=this.protoParseInt(t[3]);break;case 5:this.ma.subject=t[0],this.ma.sid=this.protoParseInt(t[1]),this.ma.reply=t[2],this.ma.hdr=this.protoParseInt(t[3]),this.ma.size=this.protoParseInt(t[4]);break;default:throw this.fail(e,"processHeaderMsgArgs Parse Error")}if(this.ma.sid<0)throw this.fail(e,"processHeaderMsgArgs Bad or Missing Sid Error");if(this.ma.hdr<0||this.ma.hdr>this.ma.size)throw this.fail(e,"processHeaderMsgArgs Bad or Missing Header Size Error");if(this.ma.size<0)throw this.fail(e,"processHeaderMsgArgs Bad or Missing Size Error")}protoParseInt(e){if(0===e.length)return-1;let t=0;for(let r=0;r<e.length;r++){if(e[r]<48||e[r]>57)return-1;t=10*t+(e[r]-48)}return t}},function(e){e[e.OP_START=0]="OP_START",e[e.OP_PLUS=1]="OP_PLUS",e[e.OP_PLUS_O=2]="OP_PLUS_O",e[e.OP_PLUS_OK=3]="OP_PLUS_OK",e[e.OP_MINUS=4]="OP_MINUS",e[e.OP_MINUS_E=5]="OP_MINUS_E",e[e.OP_MINUS_ER=6]="OP_MINUS_ER",e[e.OP_MINUS_ERR=7]="OP_MINUS_ERR",e[e.OP_MINUS_ERR_SPC=8]="OP_MINUS_ERR_SPC",e[e.MINUS_ERR_ARG=9]="MINUS_ERR_ARG",e[e.OP_M=10]="OP_M",e[e.OP_MS=11]="OP_MS",e[e.OP_MSG=12]="OP_MSG",e[e.OP_MSG_SPC=13]="OP_MSG_SPC",e[e.MSG_ARG=14]="MSG_ARG",e[e.MSG_PAYLOAD=15]="MSG_PAYLOAD",e[e.MSG_END=16]="MSG_END",e[e.OP_H=17]="OP_H",e[e.OP_P=18]="OP_P",e[e.OP_PI=19]="OP_PI",e[e.OP_PIN=20]="OP_PIN",e[e.OP_PING=21]="OP_PING",e[e.OP_PO=22]="OP_PO",e[e.OP_PON=23]="OP_PON",e[e.OP_PONG=24]="OP_PONG",e[e.OP_I=25]="OP_I",e[e.OP_IN=26]="OP_IN",e[e.OP_INF=27]="OP_INF",e[e.OP_INFO=28]="OP_INFO",e[e.OP_INFO_SPC=29]="OP_INFO_SPC",e[e.INFO_ARG=30]="INFO_ARG"}(o=t.State||(t.State={})),function(e){e[e.CR="\r".charCodeAt(0)]="CR",e[e.E="E".charCodeAt(0)]="E",e[e.e="e".charCodeAt(0)]="e",e[e.F="F".charCodeAt(0)]="F",e[e.f="f".charCodeAt(0)]="f",e[e.G="G".charCodeAt(0)]="G",e[e.g="g".charCodeAt(0)]="g",e[e.H="H".charCodeAt(0)]="H",e[e.h="h".charCodeAt(0)]="h",e[e.I="I".charCodeAt(0)]="I",e[e.i="i".charCodeAt(0)]="i",e[e.K="K".charCodeAt(0)]="K",e[e.k="k".charCodeAt(0)]="k",e[e.M="M".charCodeAt(0)]="M",e[e.m="m".charCodeAt(0)]="m",e[e.MINUS="-".charCodeAt(0)]="MINUS",e[e.N="N".charCodeAt(0)]="N",e[e.n="n".charCodeAt(0)]="n",e[e.NL="\n".charCodeAt(0)]="NL",e[e.O="O".charCodeAt(0)]="O",e[e.o="o".charCodeAt(0)]="o",e[e.P="P".charCodeAt(0)]="P",e[e.p="p".charCodeAt(0)]="p",e[e.PLUS="+".charCodeAt(0)]="PLUS",e[e.R="R".charCodeAt(0)]="R",e[e.r="r".charCodeAt(0)]="r",e[e.S="S".charCodeAt(0)]="S",e[e.s="s".charCodeAt(0)]="s",e[e.SPACE=" ".charCodeAt(0)]="SPACE",e[e.TAB="\t".charCodeAt(0)]="TAB"}(a||(a={}))},413:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,s){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,s,(t=e[r](t)).done,t.value)}))}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolHandler=t.Connect=t.createInbox=t.INFO=void 0;const i=r(9305),o=r(4938),a=r(4219),c=r(4875),u=r(3403),h=r(593),l=r(8158),d=r(3849),f=r(6807),p=r(7312),y=r(9224),b=r(786),g=r(1962),m=r(5089),v=r(7699);t.INFO=/^INFO\s+([^\r\n]+)\r\n/i,t.createInbox=function(e=""){if("string"!=typeof(e=e||"_INBOX"))throw new Error("prefix must be a string");return`${e}.${u.nuid.next()}`};const w=v.fastEncoder("PONG\r\n"),_=v.fastEncoder("PING\r\n");class E{constructor(e,t,r){this.protocol=1,this.version=e.version,this.lang=e.lang,this.echo=!t.noEcho&&void 0,this.verbose=t.verbose,this.pedantic=t.pedantic,this.tls_required=!!t.tls||void 0,this.name=t.name;const n=(t&&t.authenticator?t.authenticator(r):{})||{};c.extend(this,n)}}t.Connect=E;class P{constructor(e,t){this._closed=!1,this.connected=!1,this.connectedOnce=!1,this.infoReceived=!1,this.noMorePublishing=!1,this.abortReconnect=!1,this.listeners=[],this.pendingLimit=32768,this.outMsgs=0,this.inMsgs=0,this.outBytes=0,this.inBytes=0,this.options=e,this.publisher=t,this.subscriptions=new p.Subscriptions,this.muxSubscriptions=new y.MuxSubscription,this.outbound=new h.DataBuffer,this.pongs=[],this.pendingLimit=e.pendingLimit||this.pendingLimit,this.servers=new l.Servers(!e.noRandomize,e.servers),this.closed=c.deferred(),this.parser=new g.Parser(this),this.heartbeats=new b.Heartbeat(this,this.options.pingInterval||i.DEFAULT_PING_INTERVAL,this.options.maxPingOut||i.DEFAULT_MAX_PING_OUT)}resetOutbound(){this.outbound.reset();const e=this.pongs;this.pongs=[],e.forEach((e=>{e.reject(a.NatsError.errorForCode(a.ErrorCode.Disconnect))})),this.parser=new g.Parser(this),this.infoReceived=!1}dispatchStatus(e){this.listeners.forEach((t=>{t.push(e)}))}status(){const e=new d.QueuedIteratorImpl;return this.listeners.push(e),e}prepare(){this.info=void 0,this.resetOutbound();const e=c.deferred();return this.pongs.unshift(e),this.connectError=t=>{e.reject(t)},this.transport=o.newTransport(),this.transport.closed().then((e=>n(this,void 0,void 0,(function*(){this.connected=!1,this.isClosed()||(yield this.disconnected(this.transport.closeError))})))),e}disconnect(){this.dispatchStatus({type:i.DebugEvents.StaleConnection,data:""}),this.transport.disconnect()}disconnected(e){return n(this,void 0,void 0,(function*(){this.dispatchStatus({type:i.Events.Disconnect,data:this.servers.getCurrentServer().toString()}),this.options.reconnect?yield this.dialLoop().then((()=>{this.dispatchStatus({type:i.Events.Reconnect,data:this.servers.getCurrentServer().toString()})})).catch((e=>{this._close(e)})):yield this._close()}))}dial(e){return n(this,void 0,void 0,(function*(){const t=this.prepare();let r;try{r=c.timeout(this.options.timeout||2e4);const t=this.transport.connect(e,this.options);yield Promise.race([t,r]),(()=>n(this,void 0,void 0,(function*(){var e,t;try{try{for(var r,n=s(this.transport);!(r=yield n.next()).done;){const e=r.value;this.parser.parse(e)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&(yield t.call(n))}finally{if(e)throw e.error}}}catch(e){console.log("reader closed",e)}})))().then()}catch(e){t.reject(e)}try{yield Promise.race([r,t]),r&&r.cancel(),this.connected=!0,this.connectError=void 0,this.sendSubscriptions(),this.connectedOnce=!0,this.server.didConnect=!0,this.server.reconnects=0,this.flushPending(),this.heartbeats.start()}catch(e){throw r&&r.cancel(),yield this.transport.close(e),e}}))}dialLoop(){return n(this,void 0,void 0,(function*(){let e;for(;;){const t=this.options.reconnectDelayHandler?this.options.reconnectDelayHandler():i.DEFAULT_RECONNECT_TIME_WAIT;let r=t;const n=this.selectServer();if(!n||this.abortReconnect)throw e||a.NatsError.errorForCode(a.ErrorCode.ConnectionRefused);const s=Date.now();if(0===n.lastConnect||n.lastConnect+t<=s){n.lastConnect=Date.now();try{this.dispatchStatus({type:i.DebugEvents.Reconnecting,data:n.toString()}),yield this.dial(n);break}catch(t){if(e=t,!this.connectedOnce){if(this.options.waitOnFirstConnect)continue;this.servers.removeCurrentServer()}n.reconnects++;const r=this.options.maxReconnectAttempts||0;-1!==r&&n.reconnects>=r&&this.servers.removeCurrentServer()}}else r=Math.min(r,n.lastConnect+t-s),yield c.delay(r)}}))}static connect(e,t){return n(this,void 0,void 0,(function*(){const r=new P(e,t);return yield r.dialLoop(),r}))}static toError(e){const t=e?e.toLowerCase():"";return-1!==t.indexOf("permissions violation")?new a.NatsError(e,a.ErrorCode.PermissionsViolation):-1!==t.indexOf("authorization violation")?new a.NatsError(e,a.ErrorCode.AuthorizationViolation):-1!==t.indexOf("user authentication expired")?new a.NatsError(e,a.ErrorCode.AuthenticationExpired):new a.NatsError(e,a.ErrorCode.ProtocolError)}processMsg(e,t){if(this.inMsgs++,this.inBytes+=t.length,!this.subscriptions.sidCounter)return;const r=this.subscriptions.get(e.sid);r&&(r.received+=1,r.callback&&r.callback(null,new m.MsgImpl(e,t,this)),void 0!==r.max&&r.received>=r.max&&r.unsubscribe())}processError(e){return n(this,void 0,void 0,(function*(){const t=v.fastDecoder(e),r=P.toError(t);this.subscriptions.handleError(r)||this.dispatchStatus({type:i.Events.Error,data:r.code}),yield this.handleError(r)}))}handleError(e){return n(this,void 0,void 0,(function*(){e.isAuthError()&&this.handleAuthError(e),(e.isPermissionError()||e.isProtocolError())&&(yield this._close(e)),this.lastError=e}))}handleAuthError(e){this.lastError&&e.code===this.lastError.code&&(this.abortReconnect=!0),this.connectError?this.connectError(e):this.disconnect()}processPing(){this.transport.send(w)}processPong(){const e=this.pongs.shift();e&&e.resolve()}processInfo(e){const t=JSON.parse(v.fastDecoder(e));this.info=t;const r=this.options&&this.options.ignoreClusterUpdates?void 0:this.servers.update(t);if(!this.infoReceived){this.infoReceived=!0,this.transport.isEncrypted()&&this.servers.updateTLSName();const{version:e,lang:r}=this.transport;try{const n=new E({version:e,lang:r},this.options,t.nonce);t.headers&&(n.headers=!0,n.no_responders=!0);const s=JSON.stringify(n);this.transport.send(v.fastEncoder(`CONNECT ${s}${c.CR_LF}`)),this.transport.send(_)}catch(e){this._close(a.NatsError.errorForCode(a.ErrorCode.BadAuthentication,e))}}r&&this.dispatchStatus({type:i.Events.Update,data:r}),void 0!==t.ldm&&t.ldm&&this.dispatchStatus({type:i.Events.LDM,data:this.servers.getCurrentServer().toString()})}push(e){switch(e.kind){case g.Kind.MSG:{const{msg:t,data:r}=e;this.processMsg(t,r);break}case g.Kind.OK:break;case g.Kind.ERR:this.processError(e.data);break;case g.Kind.PING:this.processPing();break;case g.Kind.PONG:this.processPong();break;case g.Kind.INFO:this.processInfo(e.data)}}sendCommand(e,...t){const r=this.outbound.length();let n;n="string"==typeof e?v.fastEncoder(e):e,this.outbound.fill(n,...t),0===r?setTimeout((()=>{this.flushPending()})):this.outbound.size()>=this.pendingLimit&&this.flushPending()}publish(e,t,r){if(this.isClosed())throw a.NatsError.errorForCode(a.ErrorCode.ConnectionClosed);if(this.noMorePublishing)throw a.NatsError.errorForCode(a.ErrorCode.ConnectionDraining);let n=t.length;(r=r||{}).reply=r.reply||"";let s,o=i.Empty,u=0;if(r.headers){if(this.info&&!this.info.headers)throw new a.NatsError("headers",a.ErrorCode.ServerOptionNotAvailable);o=r.headers.encode(),u=o.length,n=t.length+u}if(this.info&&n>this.info.max_payload)throw a.NatsError.errorForCode(a.ErrorCode.MaxPayloadExceeded);this.outBytes+=n,this.outMsgs++,r.headers?(s=r.reply?`HPUB ${e} ${r.reply} ${u} ${n}${c.CR_LF}`:`HPUB ${e} ${u} ${n}\r\n`,this.sendCommand(s,o,t,c.CRLF)):(s=r.reply?`PUB ${e} ${r.reply} ${n}\r\n`:`PUB ${e} ${n}\r\n`,this.sendCommand(s,t,c.CRLF))}request(e){return this.initMux(),this.muxSubscriptions.add(e),e}subscribe(e){return this.subscriptions.add(e),e.queue?this.sendCommand(`SUB ${e.subject} ${e.queue} ${e.sid}\r\n`):this.sendCommand(`SUB ${e.subject} ${e.sid}\r\n`),e.max&&this.unsubscribe(e,e.max),e}unsubscribe(e,t){this.unsub(e,t),(void 0===e.max||e.received>=e.max)&&this.subscriptions.cancel(e)}unsub(e,t){e&&!this.isClosed()&&(t?this.sendCommand(`UNSUB ${e.sid} ${t}${c.CR_LF}`):this.sendCommand(`UNSUB ${e.sid}${c.CR_LF}`),e.max=t)}flush(e){return e||(e=c.deferred()),this.pongs.push(e),this.sendCommand(_),e}sendSubscriptions(){const e=[];this.subscriptions.all().forEach((t=>{const r=t;r.queue?e.push(`SUB ${r.subject} ${r.queue} ${r.sid}${c.CR_LF}`):e.push(`SUB ${r.subject} ${r.sid}${c.CR_LF}`)})),e.length&&this.transport.send(v.fastEncoder(e.join("")))}_close(e){return n(this,void 0,void 0,(function*(){this._closed||(this.heartbeats.cancel(),this.connectError&&(this.connectError(e),this.connectError=void 0),this.muxSubscriptions.close(),this.subscriptions.close(),this.listeners.forEach((e=>{e.stop()})),this._closed=!0,yield this.transport.close(e),yield this.closed.resolve(e))}))}close(){return this._close()}isClosed(){return this._closed}drain(){const e=this.subscriptions.all(),t=[];return e.forEach((e=>{t.push(e.drain())})),Promise.all(t).then((()=>n(this,void 0,void 0,(function*(){return this.noMorePublishing=!0,yield this.flush(),this.close()})))).catch((()=>{}))}flushPending(){if(this.infoReceived&&this.connected&&this.outbound.size()){const e=this.outbound.drain();this.transport.send(e)}}initMux(){if(!this.subscriptions.getMux()){const e=this.muxSubscriptions.init(this.options.inboxPrefix),t=new f.SubscriptionImpl(this,`${e}*`);t.callback=this.muxSubscriptions.dispatcher(),this.subscriptions.setMux(t),this.subscribe(t)}}selectServer(){const e=this.servers.selectServer();if(void 0!==e)return this.server=e,this.server}getServer(){return this.server}}t.ProtocolHandler=P},3849:function(e,t,r){"use strict";var n=this&&this.__await||function(e){return this instanceof n?(this.v=e,this):new n(e)},s=this&&this.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,i=r.apply(e,t||[]),o=[];return s={},a("next"),a("throw"),a("return"),s[Symbol.asyncIterator]=function(){return this},s;function a(e){i[e]&&(s[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=i[e](t)).value instanceof n?Promise.resolve(r.value.v).then(u,h):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function u(e){c("next",e)}function h(e){c("throw",e)}function l(e,t){e(t),o.shift(),o.length&&c(o[0][0],o[0][1])}};Object.defineProperty(t,"__esModule",{value:!0}),t.QueuedIteratorImpl=void 0;const i=r(4875),o=r(4219);class a{constructor(){this.inflight=0,this.processed=0,this.received=0,this.noIterator=!1,this.done=!1,this.signal=i.deferred(),this.yields=[],this.iterClosed=i.deferred()}[Symbol.asyncIterator](){return this.iterate()}push(e){this.done||(this.yields.push(e),this.signal.resolve())}iterate(){return s(this,arguments,(function*(){if(this.noIterator)throw new o.NatsError("unsupported iterator",o.ErrorCode.ApiError);for(;;){if(0===this.yields.length&&(yield n(this.signal)),this.err)throw this.err;const e=this.yields;this.inflight=e.length,this.yields=[];for(let t=0;t<e.length;t++)this.processed++,yield yield n(e[t]),this.dispatchedFn&&e[t]&&this.dispatchedFn(e[t]),this.inflight--;if(this.done)break;0===this.yields.length&&(e.length=0,this.yields=e,this.signal=i.deferred())}}))}stop(e){this.err=e,this.done=!0,this.signal.resolve(),this.iterClosed.resolve()}getProcessed(){return this.noIterator?this.received:this.processed}getPending(){return this.yields.length+this.inflight}getReceived(){return this.received}}t.QueuedIteratorImpl=a},3572:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Request=void 0;const n=r(4875),s=r(4219),i=r(3403);t.Request=class{constructor(e,t={timeout:1e3}){this.mux=e,this.received=0,this.deferred=n.deferred(),this.token=i.nuid.next(),n.extend(this,t),this.timer=n.timeout(t.timeout)}resolver(e,t){this.timer&&this.timer.cancel(),e?this.deferred.reject(e):this.deferred.resolve(t),this.cancel()}cancel(e){this.timer&&this.timer.cancel(),this.mux.cancel(this),this.deferred.reject(e||s.NatsError.errorForCode(s.ErrorCode.Cancelled))}}},8158:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Servers=t.ServerImpl=void 0;const n=r(9305),s=r(4938),i=r(4875),o=r(7639);class a{constructor(e,t=!1){this.src=e,this.tlsName="",e.match(/^(.*:\/\/)(.*)/m)&&(e=e.replace(/^(.*:\/\/)(.*)/gm,"$2"));const r=new URL(`http://${e}`);r.port||(r.port=`${n.DEFAULT_PORT}`),this.listen=r.host,this.hostname=r.hostname,this.port=parseInt(r.port,10),this.didConnect=!1,this.reconnects=0,this.lastConnect=0,this.gossiped=t}toString(){return this.listen}}t.ServerImpl=a,t.Servers=class{constructor(e,t=[]){this.firstSelect=!0,this.servers=[],this.tlsName="";const r=s.getUrlParseFn();t&&(t.forEach((e=>{e=r?r(e):e,this.servers.push(new a(e))})),e&&(this.servers=i.shuffle(this.servers))),0===this.servers.length&&this.addServer(`${n.DEFAULT_HOST}:${s.defaultPort()}`,!1),this.currentServer=this.servers[0]}updateTLSName(){const e=this.getCurrentServer();o.isIP(e.hostname)||(this.tlsName=e.hostname,this.servers.forEach((e=>{e.gossiped&&(e.tlsName=this.tlsName)})))}getCurrentServer(){return this.currentServer}addServer(e,t=!1){const r=s.getUrlParseFn();e=r?r(e):e;const n=new a(e,t);o.isIP(n.hostname)&&(n.tlsName=this.tlsName),this.servers.push(n)}selectServer(){if(this.firstSelect)return this.firstSelect=!1,this.currentServer;const e=this.servers.shift();return e&&(this.servers.push(e),this.currentServer=e),e}removeCurrentServer(){this.removeServer(this.currentServer)}removeServer(e){if(e){const t=this.servers.indexOf(e);this.servers.splice(t,1)}}length(){return this.servers.length}next(){return this.servers.length?this.servers[0]:void 0}getServers(){return this.servers}update(e){const t=[];let r=[];const n=s.getUrlParseFn(),i=new Map;e.connect_urls&&e.connect_urls.length>0&&e.connect_urls.forEach((e=>{e=n?n(e):e;const t=new a(e,!0);i.set(e,t)}));const o=[];return this.servers.forEach(((e,t)=>{const r=e.listen;e.gossiped&&this.currentServer.listen!==r&&void 0===i.get(r)&&o.push(t),i.delete(r)})),o.reverse(),o.forEach((e=>{const t=this.servers.splice(e,1);r=r.concat(t[0].listen)})),i.forEach(((e,r)=>{this.servers.push(e),t.push(r)})),{added:t,deleted:r}}}},6807:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptionImpl=void 0;const n=r(3849),s=r(4875),i=r(4219);class o extends n.QueuedIteratorImpl{constructor(e,t,r={}){super(),s.extend(this,r),this.protocol=e,this.subject=t,this.draining=!1,this.noIterator="function"==typeof r.callback,this.closed=s.deferred(),r.timeout&&(this.timer=s.timeout(r.timeout),this.timer.then((()=>{this.timer=void 0})).catch((e=>{this.stop(e),this.noIterator&&this.callback(e,{})})))}setDispatchedFn(e){if(this.noIterator){const t=this.callback;this.callback=(r,n)=>{t(r,n),e(n)}}else this.dispatchedFn=e}callback(e,t){this.cancelTimeout(),e?this.stop(e):this.push(t)}close(){if(!this.isClosed()){if(this.cancelTimeout(),this.stop(),this.cleanupFn)try{this.cleanupFn(this,this.info)}catch(e){}this.closed.resolve()}}unsubscribe(e){this.protocol.unsubscribe(this,e)}cancelTimeout(){this.timer&&(this.timer.cancel(),this.timer=void 0)}drain(){if(this.protocol.isClosed())throw i.NatsError.errorForCode(i.ErrorCode.ConnectionClosed);if(this.isClosed())throw i.NatsError.errorForCode(i.ErrorCode.SubClosed);return this.drained||(this.protocol.unsub(this),this.drained=this.protocol.flush(s.deferred()),this.drained.then((()=>{this.protocol.subscriptions.cancel(this)}))),this.drained}isDraining(){return this.draining}isClosed(){return this.done}getSubject(){return this.subject}getMax(){return this.max}getID(){return this.sid}}t.SubscriptionImpl=o},7312:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Subscriptions=void 0,t.Subscriptions=class{constructor(){this.sidCounter=0,this.subs=new Map}size(){return this.subs.size}add(e){return this.sidCounter++,e.sid=this.sidCounter,this.subs.set(e.sid,e),e}setMux(e){return this.mux=e,e}getMux(){return this.mux}get(e){return this.subs.get(e)}all(){const e=[];for(const t of this.subs.values())e.push(t);return e}cancel(e){e&&(e.close(),this.subs.delete(e.sid))}handleError(e){let t=!1;if(e){const r=/^'Permissions Violation for Subscription to "(\S+)"'/i.exec(e.message);if(r){const n=r[1];this.subs.forEach((r=>{n==r.subject&&(r.callback(e,{}),r.close(),t=r!==this.mux)}))}}return t}close(){this.subs.forEach((e=>{e.close()}))}}},4938:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newTransport=t.getUrlParseFn=t.defaultPort=t.setTransportFactory=void 0;const n=r(9305);let s;t.setTransportFactory=function(e){s=e},t.defaultPort=function(){return void 0!==s&&void 0!==s.defaultPort?s.defaultPort:n.DEFAULT_PORT},t.getUrlParseFn=function(){return void 0!==s&&s.urlParseFn?s.urlParseFn:void 0},t.newTransport=function(){if(!s||"function"!=typeof s.factory)throw new Error("transport fn is not set");return s.factory()}},1303:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TypedSubscription=t.checkFn=void 0;const s=r(4875),i=r(3849),o=r(4219);function a(e,t,r=!1){if(!0===r&&!e)throw o.NatsError.errorForCode(o.ErrorCode.ApiError,new Error(`${t} is not a function`));if(e&&"function"!=typeof e)throw o.NatsError.errorForCode(o.ErrorCode.ApiError,new Error(`${t} is not a function`))}t.checkFn=a;class c extends i.QueuedIteratorImpl{constructor(e,t,r){super(),a(r.adapter,"adapter",!0),this.adapter=r.adapter,r.callback&&a(r.callback,"callback"),this.noIterator="function"==typeof r.callback,r.dispatchedFn&&(a(r.dispatchedFn,"dispatchedFn"),this.dispatchedFn=r.dispatchedFn),r.cleanupFn&&a(r.cleanupFn,"cleanupFn");let i=(e,t)=>{this.callback(e,t)};if(r.callback){const e=r.callback;i=(t,r)=>{const[n,s]=this.adapter(t,r);e(n,s),this.dispatchedFn&&s&&this.dispatchedFn(s)}}const{max:o,queue:c,timeout:u}=r,h={queue:c,timeout:u,callback:i};o&&o>0&&(h.max=o),this.sub=e.subscribe(t,h),r.cleanupFn&&(this.sub.cleanupFn=r.cleanupFn),this.subIterDone=s.deferred(),Promise.all([this.sub.closed,this.iterClosed]).then((()=>{this.subIterDone.resolve()})).catch((()=>{this.subIterDone.resolve()})),(e=>n(this,void 0,void 0,(function*(){yield e.closed,this.stop()})))(this.sub).then().catch()}unsubscribe(e){this.sub.unsubscribe(e)}drain(){return this.sub.drain()}isDraining(){return this.sub.isDraining()}isClosed(){return this.sub.isClosed()}callback(e,t){this.sub.cancelTimeout();const[r,n]=this.adapter(e,t);r&&this.stop(r),n&&this.push(n)}getSubject(){return this.sub.getSubject()}getReceived(){return this.sub.getReceived()}getProcessed(){return this.sub.getProcessed()}getPending(){return this.sub.getPending()}getID(){return this.sub.getID()}getMax(){return this.sub.getMax()}get closed(){return this.sub.closed}}t.TypedSubscription=c},9305:(e,t)=>{"use strict";var r,n,s,i,o,a,c,u,h,l;Object.defineProperty(t,"__esModule",{value:!0}),t.JsHeaders=t.ReplayPolicy=t.AckPolicy=t.DeliverPolicy=t.StorageType=t.DiscardPolicy=t.RetentionPolicy=t.AdvisoryKind=t.DEFAULT_MAX_PING_OUT=t.DEFAULT_PING_INTERVAL=t.DEFAULT_JITTER_TLS=t.DEFAULT_JITTER=t.DEFAULT_MAX_RECONNECT_ATTEMPTS=t.DEFAULT_RECONNECT_TIME_WAIT=t.DEFAULT_HOST=t.DEFAULT_PORT=t.DebugEvents=t.Events=t.Empty=void 0,t.Empty=new Uint8Array(0),(l=t.Events||(t.Events={})).Disconnect="disconnect",l.Reconnect="reconnect",l.Update="update",l.LDM="ldm",l.Error="error",(h=t.DebugEvents||(t.DebugEvents={})).Reconnecting="reconnecting",h.PingTimer="pingTimer",h.StaleConnection="staleConnection",t.DEFAULT_PORT=4222,t.DEFAULT_HOST="127.0.0.1",t.DEFAULT_RECONNECT_TIME_WAIT=2e3,t.DEFAULT_MAX_RECONNECT_ATTEMPTS=10,t.DEFAULT_JITTER=100,t.DEFAULT_JITTER_TLS=1e3,t.DEFAULT_PING_INTERVAL=12e4,t.DEFAULT_MAX_PING_OUT=2,(u=t.AdvisoryKind||(t.AdvisoryKind={})).API="api_audit",u.StreamAction="stream_action",u.ConsumerAction="consumer_action",u.SnapshotCreate="snapshot_create",u.SnapshotComplete="snapshot_complete",u.RestoreCreate="restore_create",u.RestoreComplete="restore_complete",u.MaxDeliver="max_deliver",u.Terminated="terminated",u.Ack="consumer_ack",u.StreamLeaderElected="stream_leader_elected",u.StreamQuorumLost="stream_quorum_lost",u.ConsumerLeaderElected="consumer_leader_elected",u.ConsumerQuorumLost="consumer_quorum_lost",(c=t.RetentionPolicy||(t.RetentionPolicy={})).Limits="limits",c.Interest="interest",c.Workqueue="workqueue",(a=t.DiscardPolicy||(t.DiscardPolicy={})).Old="old",a.New="new",(o=t.StorageType||(t.StorageType={})).File="file",o.Memory="memory",(i=t.DeliverPolicy||(t.DeliverPolicy={})).All="all",i.Last="last",i.New="new",i.StartSequence="by_start_sequence",i.StartTime="by_start_time",(s=t.AckPolicy||(t.AckPolicy={})).None="none",s.All="all",s.Explicit="explicit",s.NotSet="",(n=t.ReplayPolicy||(t.ReplayPolicy={})).Instant="instant",n.Original="original",(r=t.JsHeaders||(t.JsHeaders={})).StreamSourceHdr="Nats-Stream-Source",r.LastConsumerSeqHdr="Nats-Last-Consumer",r.LastStreamSeqHdr="Nats-Last-Stream"},4875:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Perf=t.shuffle=t.deferred=t.delay=t.timeout=t.render=t.extend=t.extractProtocolMessage=t.protoLen=t.isUint8Array=t.LF=t.CR=t.CRLF=t.CR_LF_LEN=t.CR_LF=void 0;const n=r(593),s=r(4219),i=r(7699);function o(e){for(let r=0;r<e.length;r++){const n=r+1;if(e.byteLength>n&&e[r]===t.CR&&e[n]===t.LF)return n+1}return-1}t.CR_LF="\r\n",t.CR_LF_LEN=t.CR_LF.length,t.CRLF=n.DataBuffer.fromAscii(t.CR_LF),t.CR=new Uint8Array(t.CRLF)[0],t.LF=new Uint8Array(t.CRLF)[1],t.isUint8Array=function(e){return e instanceof Uint8Array},t.protoLen=o,t.extractProtocolMessage=function(e){const t=o(e);if(t){const r=new Uint8Array(e).slice(0,t);return i.TD.decode(r)}return""},t.extend=function(e,...t){for(let r=0;r<t.length;r++){const n=t[r];Object.keys(n).forEach((function(t){e[t]=n[t]}))}return e},t.render=function(e){return i.TD.decode(e).replace(/\n/g,"␊").replace(/\r/g,"␍")},t.timeout=function(e){let t,r;const n=new Promise(((n,i)=>{t={cancel:()=>{r&&clearTimeout(r)}},r=setTimeout((()=>{i(s.NatsError.errorForCode(s.ErrorCode.Timeout))}),e)}));return Object.assign(n,t)},t.delay=function(e=0){return new Promise((t=>{setTimeout((()=>{t()}),e)}))},t.deferred=function(){let e={};const t=new Promise(((t,r)=>{e={resolve:t,reject:r}}));return Object.assign(t,e)},t.shuffle=function(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e},t.Perf=class{constructor(){this.timers=new Map,this.measures=new Map}mark(e){this.timers.set(e,Date.now())}measure(e,t,r){const n=this.timers.get(t);if(void 0===n)throw new Error(`${t} is not defined`);const s=this.timers.get(r);if(void 0===s)throw new Error(`${r} is not defined`);this.measures.set(e,s-n)}getEntries(){const e=[];return this.measures.forEach(((t,r)=>{e.push({name:r,duration:t})})),e}}},5837:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.connect=t.wsUrlParseFn=void 0;const n=r(7689),s=r(460);function i(e){/^(.*:\/\/)(.*)/.test(e)||(e=`https://${e}`);let t=new URL(e);const r=t.protocol.toLowerCase();let n,s;"https:"!==r&&"http"!==r&&(e=e.replace(/^(.*:\/\/)(.*)/gm,"$2"),t=new URL(`http://${e}`));const i=t.hostname,o=t.pathname,a=t.search||"";switch(r){case"http:":case"ws:":case"nats:":s=t.port||"80",n="ws:";break;default:s=t.port||"443",n="wss:"}return`${n}//${i}:${s}${o}${a}`}t.wsUrlParseFn=i,t.connect=function(e={}){return n.setTransportFactory({defaultPort:443,urlParseFn:i,factory:()=>new s.WsTransport}),n.NatsConnectionImpl.connect(e)}},9298:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.connect=void 0,s(r(7689),t);var i=r(5837);Object.defineProperty(t,"connect",{enumerable:!0,get:function(){return i.connect}})},460:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__await||function(e){return this instanceof s?(this.v=e,this):new s(e)},i=this&&this.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=i[e](t)).value instanceof s?Promise.resolve(r.value.v).then(u,h):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function u(e){c("next",e)}function h(e){c("throw",e)}function l(e,t){e(t),o.shift(),o.length&&c(o[0][0],o[0][1])}};Object.defineProperty(t,"__esModule",{value:!0}),t.WsTransport=void 0;const o=r(7689);class a{constructor(){this.version="1.2.0",this.lang="nats.ws",this.connected=!1,this.done=!1,this.socketClosed=!1,this.encrypted=!1,this.peeked=!1,this.yields=[],this.signal=o.deferred(),this.closedNotification=o.deferred()}connect(e,t){const r=o.deferred();if(t.tls)return r.reject(new o.NatsError("tls",o.ErrorCode.InvalidOption)),r;this.options=t;const n=e.src;return this.encrypted=0===n.indexOf("wss://"),this.socket=new WebSocket(n),this.socket.binaryType="arraybuffer",this.socket.onopen=()=>{},this.socket.onmessage=e=>{if(this.yields.push(new Uint8Array(e.data)),this.peeked)return void this.signal.resolve();const n=o.DataBuffer.concat(...this.yields),s=o.extractProtocolMessage(n);if(s){const e=o.INFO.exec(s);if(!e)return t.debug&&console.error("!!!",o.render(n)),void r.reject(new Error("unexpected response from server"));try{const t=JSON.parse(e[1]);o.checkOptions(t,this.options),this.peeked=!0,this.connected=!0,this.signal.resolve(),r.resolve()}catch(e){return void r.reject(e)}}},this.socket.onclose=e=>{let t;this.socketClosed=!0,this.done||(e.wasClean||(t=new Error(e.reason)),this._closed(t))},this.socket.onerror=e=>{const t=e,n=new o.NatsError(t.message,o.ErrorCode.Unknown,new Error(t.error));r.reject(n)},r}disconnect(){this._closed(void 0,!0)}_closed(e,t=!0){return n(this,void 0,void 0,(function*(){if(this.connected&&!this.done){if(this.closeError=e,!e)for(;!this.socketClosed&&this.socket.bufferedAmount>0;)console.log(this.socket.bufferedAmount),yield o.delay(100);this.done=!0;try{this.socket.close(e?1002:1e3,e?e.message:void 0)}catch(e){}t&&this.closedNotification.resolve(e)}}))}get isClosed(){return this.done}[Symbol.asyncIterator](){return this.iterate()}iterate(){return i(this,arguments,(function*(){for(;;){0===this.yields.length&&(yield s(this.signal));const e=this.yields;this.yields=[];for(let t=0;t<e.length;t++)this.options.debug&&console.info(`> ${o.render(e[t])}`),yield yield s(e[t]);if(this.done)break;0===this.yields.length&&(e.length=0,this.yields=e,this.signal=o.deferred())}}))}isEncrypted(){return this.connected&&this.encrypted}send(e){if(this.done)return Promise.resolve();try{return this.socket.send(e.buffer),this.options.debug&&console.info(`< ${o.render(e)}`),Promise.resolve()}catch(t){return this.options.debug&&console.error(`!!! ${o.render(e)}: ${t}`),Promise.reject(t)}}close(e){return this._closed(e,!1)}closed(){return this.closedNotification}}t.WsTransport=a},9581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.base32=void 0;const r="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";t.base32=class{static encode(e){let t=0,n=0,s=new Uint8Array(e),i=new Uint8Array(2*e.byteLength),o=0;for(let e=0;e<s.byteLength;e++)for(n=n<<8|s[e],t+=8;t>=5;){let e=n>>>t-5&31;i[o++]=r.charAt(e).charCodeAt(0),t-=5}if(t>0){let e=n<<5-t&31;i[o++]=r.charAt(e).charCodeAt(0)}return i.slice(0,o)}static decode(e){let t=0,n=0,s=0,i=new Uint8Array(e),o=new Uint8Array(5*i.byteLength/8|0);for(let e=0;e<i.byteLength;e++){let a=String.fromCharCode(i[e]),c=r.indexOf(a);if(-1===c)throw new Error("Illegal Base32 character: "+i[e]);n=n<<5|c,t+=5,t>=8&&(o[s++]=n>>>t-8&255,t-=8)}return o.slice(0,s)}}},2446:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Codec=void 0;const n=r(2915),s=r(5449),i=r(9581);class o{static encode(e,t){if(!(t&&t instanceof Uint8Array))throw new s.NKeysError(s.NKeysErrorCode.SerializationError);if(!s.Prefixes.isValidPrefix(e))throw new s.NKeysError(s.NKeysErrorCode.InvalidPrefixByte);return o._encode(!1,e,t)}static encodeSeed(e,t){if(!t)throw new s.NKeysError(s.NKeysErrorCode.ApiError);if(!s.Prefixes.isValidPublicPrefix(e))throw new s.NKeysError(s.NKeysErrorCode.InvalidPrefixByte);if(32!==t.byteLength)throw new s.NKeysError(s.NKeysErrorCode.InvalidSeedLen);return o._encode(!0,e,t)}static decode(e,t){if(!s.Prefixes.isValidPrefix(e))throw new s.NKeysError(s.NKeysErrorCode.InvalidPrefixByte);const r=o._decode(t);if(r[0]!==e)throw new s.NKeysError(s.NKeysErrorCode.InvalidPrefixByte);return r.slice(1)}static decodeSeed(e){const t=o._decode(e),r=o._decodePrefix(t);if(r[0]!=s.Prefix.Seed)throw new s.NKeysError(s.NKeysErrorCode.InvalidSeed);if(!s.Prefixes.isValidPublicPrefix(r[1]))throw new s.NKeysError(s.NKeysErrorCode.InvalidPrefixByte);return{buf:t.slice(2),prefix:r[1]}}static _encode(e,t,r){const a=e?2:1,c=r.byteLength,u=a+c,h=new Uint8Array(a+c+2);if(e){const e=o._encodePrefix(s.Prefix.Seed,t);h.set(e)}else h[0]=t;h.set(r,a);const l=n.crc16.checksum(h.slice(0,u));return new DataView(h.buffer).setUint16(u,l,!0),i.base32.encode(h)}static _decode(e){if(e.byteLength<4)throw new s.NKeysError(s.NKeysErrorCode.InvalidEncoding);let t;try{t=i.base32.decode(e)}catch(e){throw new s.NKeysError(s.NKeysErrorCode.InvalidEncoding,e)}const r=t.byteLength-2,o=new DataView(t.buffer).getUint16(r,!0),a=t.slice(0,r);if(!n.crc16.validate(a,o))throw new s.NKeysError(s.NKeysErrorCode.InvalidChecksum);return a}static _encodePrefix(e,t){return new Uint8Array([e|t>>5,(31&t)<<3])}static _decodePrefix(e){const t=248&e[0],r=(7&e[0])<<5|(248&e[1])>>3;return new Uint8Array([t,r])}}t.Codec=o},2915:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crc16=void 0;const r=new Uint16Array([0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920]);class n{static checksum(e){let t=0;for(let n=0;n<e.byteLength;n++){let s=e[n];t=t<<8&65535^r[255&(t>>8^s)]}return t}static validate(e,t){return n.checksum(e)==t}}t.crc16=n},3811:(e,t)=>{"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),t.getEd25519Helper=t.setEd25519Helper=void 0,t.setEd25519Helper=function(e){r=e},t.getEd25519Helper=function(){return r}},2902:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0});const i=r(780),o={randomBytes:i.randomBytes,verify:i.sign.detached.verify,fromSeed:i.sign.keyPair.fromSeed,sign:i.sign.detached};if("undefined"==typeof TextEncoder){const e=r(9539);r.g.TextEncoder=e.TextEncoder,r.g.TextDecoder=e.TextDecoder}"undefined"==typeof atob&&(r.g.atob=e=>Buffer.from(e,"base64").toString("binary"),r.g.btoa=e=>Buffer.from(e,"binary").toString("base64"));const{setEd25519Helper:a}=r(3811);a(o),s(r(8432),t)},7212:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KP=void 0;const n=r(2446),s=r(5449),i=r(3811);t.KP=class{constructor(e){this.seed=e}getRawSeed(){if(!this.seed)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);return n.Codec.decodeSeed(this.seed).buf}getSeed(){if(!this.seed)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);return this.seed}getPublicKey(){if(!this.seed)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);const e=n.Codec.decodeSeed(this.seed),t=i.getEd25519Helper().fromSeed(this.getRawSeed()),r=n.Codec.encode(e.prefix,t.publicKey);return(new TextDecoder).decode(r)}getPrivateKey(){if(!this.seed)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);const e=i.getEd25519Helper().fromSeed(this.getRawSeed());return n.Codec.encode(s.Prefix.Private,e.secretKey)}sign(e){if(!this.seed)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);const t=i.getEd25519Helper().fromSeed(this.getRawSeed());return i.getEd25519Helper().sign(e,t.secretKey)}verify(e,t){if(!this.seed)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);const r=i.getEd25519Helper().fromSeed(this.getRawSeed());return i.getEd25519Helper().verify(e,t,r.publicKey)}clear(){this.seed&&(this.seed.fill(0),this.seed=void 0)}}},8432:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encode=t.decode=t.Prefix=t.NKeysErrorCode=t.NKeysError=t.fromSeed=t.fromPublic=t.createUser=t.createPair=t.createOperator=t.createAccount=void 0;var n=r(5449);Object.defineProperty(t,"createAccount",{enumerable:!0,get:function(){return n.createAccount}}),Object.defineProperty(t,"createOperator",{enumerable:!0,get:function(){return n.createOperator}}),Object.defineProperty(t,"createPair",{enumerable:!0,get:function(){return n.createPair}}),Object.defineProperty(t,"createUser",{enumerable:!0,get:function(){return n.createUser}}),Object.defineProperty(t,"fromPublic",{enumerable:!0,get:function(){return n.fromPublic}}),Object.defineProperty(t,"fromSeed",{enumerable:!0,get:function(){return n.fromSeed}}),Object.defineProperty(t,"NKeysError",{enumerable:!0,get:function(){return n.NKeysError}}),Object.defineProperty(t,"NKeysErrorCode",{enumerable:!0,get:function(){return n.NKeysErrorCode}}),Object.defineProperty(t,"Prefix",{enumerable:!0,get:function(){return n.Prefix}});var s=r(7445);Object.defineProperty(t,"decode",{enumerable:!0,get:function(){return s.decode}}),Object.defineProperty(t,"encode",{enumerable:!0,get:function(){return s.encode}})},5449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NKeysError=t.NKeysErrorCode=t.Prefixes=t.Prefix=t.fromSeed=t.fromPublic=t.createServer=t.createCluster=t.createUser=t.createAccount=t.createOperator=t.createPair=void 0;const n=r(7212),s=r(121),i=r(2446),o=r(3811);function a(e){const t=o.getEd25519Helper().randomBytes(32);let r=i.Codec.encodeSeed(e,new Uint8Array(t));return new n.KP(r)}var c,u;t.createPair=a,t.createOperator=function(){return a(c.Operator)},t.createAccount=function(){return a(c.Account)},t.createUser=function(){return a(c.User)},t.createCluster=function(){return a(c.Cluster)},t.createServer=function(){return a(c.Server)},t.fromPublic=function(e){const t=(new TextEncoder).encode(e),r=i.Codec._decode(t),n=h.parsePrefix(r[0]);if(h.isValidPublicPrefix(n))return new s.PublicKey(t);throw new l(u.InvalidPublicKey)},t.fromSeed=function(e){return i.Codec.decodeSeed(e),new n.KP(e)},function(e){e[e.Seed=144]="Seed",e[e.Private=120]="Private",e[e.Operator=112]="Operator",e[e.Server=104]="Server",e[e.Cluster=16]="Cluster",e[e.Account=0]="Account",e[e.User=160]="User"}(c=t.Prefix||(t.Prefix={}));class h{static isValidPublicPrefix(e){return e==c.Server||e==c.Operator||e==c.Cluster||e==c.Account||e==c.User}static startsWithValidPrefix(e){let t=e[0];return"S"==t||"P"==t||"O"==t||"N"==t||"C"==t||"A"==t||"U"==t}static isValidPrefix(e){return-1!=this.parsePrefix(e)}static parsePrefix(e){switch(e){case c.Seed:return c.Seed;case c.Private:return c.Private;case c.Operator:return c.Operator;case c.Server:return c.Server;case c.Cluster:return c.Cluster;case c.Account:return c.Account;case c.User:return c.User;default:return-1}}}t.Prefixes=h,function(e){e.InvalidPrefixByte="nkeys: invalid prefix byte",e.InvalidKey="nkeys: invalid key",e.InvalidPublicKey="nkeys: invalid public key",e.InvalidSeedLen="nkeys: invalid seed length",e.InvalidSeed="nkeys: invalid seed",e.InvalidEncoding="nkeys: invalid encoded key",e.InvalidSignature="nkeys: signature verification failed",e.CannotSign="nkeys: cannot sign, no private key available",e.PublicKeyOnly="nkeys: no seed or private key available",e.InvalidChecksum="nkeys: invalid checksum",e.SerializationError="nkeys: serialization error",e.ApiError="nkeys: api error",e.ClearedPair="nkeys: pair is cleared"}(u=t.NKeysErrorCode||(t.NKeysErrorCode={}));class l extends Error{constructor(e,t){super(e),this.name="NKeysError",this.code=e,this.chainedError=t}}t.NKeysError=l},121:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PublicKey=void 0;const n=r(2446),s=r(5449),i=r(3811);t.PublicKey=class{constructor(e){this.publicKey=e}getPublicKey(){if(!this.publicKey)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);return(new TextDecoder).decode(this.publicKey)}getPrivateKey(){if(!this.publicKey)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);throw new s.NKeysError(s.NKeysErrorCode.PublicKeyOnly)}getSeed(){if(!this.publicKey)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);throw new s.NKeysError(s.NKeysErrorCode.PublicKeyOnly)}sign(e){if(!this.publicKey)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);throw new s.NKeysError(s.NKeysErrorCode.CannotSign)}verify(e,t){if(!this.publicKey)throw new s.NKeysError(s.NKeysErrorCode.ClearedPair);let r=n.Codec._decode(this.publicKey);return i.getEd25519Helper().verify(e,t,r.slice(1))}clear(){this.publicKey&&(this.publicKey.fill(0),this.publicKey=void 0)}}},7445:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dump=t.decode=t.encode=void 0,t.encode=function(e){return btoa(String.fromCharCode(...e))},t.decode=function(e){const t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r},t.dump=function(e,t){t&&console.log(t);let r=[];for(let t=0;t<e.byteLength;t++){t%8==0&&r.push("\n");let n=e[t].toString(16);1===n.length&&(n="0"+n),r.push(n)}console.log(r.join("  "))}},6926:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newActor=t.Actor=void 0;const n=r(8561),s=r(5502),i=r(9242),o=r(9882);class a{constructor(e="default",t,r){this.key="",this.hostName=e,this.hostKey=t,this.claims={jti:"",iat:0,iss:"",sub:"",wascap:{name:"",hash:"",tags:[],caps:[],ver:"",prov:!1}},this.wasm=r}async startActor(e){const t=await this.wasm.extract_jwt(e);if(!await this.wasm.validate_jwt(t))throw new Error("invalid token");this.claims=o.parseJwt(t),this.key=this.claims.sub,this.module=await s.instantiate(e)}async stopActor(e){const t={host_id:this.hostKey,actor_ref:this.key};e.publish(`wasmbus.ctl.${this.hostName}.cmd.${this.hostKey}.sa`,o.jsonEncode(t))}async publishActorStarted(e){const t={call_alias:"",caps:this.claims.wascap.caps[0],iss:this.claims.iss,name:this.claims.wascap.name,rev:"1",sub:this.claims.sub,tags:"",version:this.claims.wascap.ver};e.publish(`lc.${this.hostName}.claims.${this.key}`,o.jsonEncode(t));const r={api_version:0,instance_id:o.uuidv4(),public_key:this.key};e.publish(`wasmbus.evt.${this.hostName}`,o.jsonEncode(i.createEventMessage(this.hostKey,i.EventType.ActorStarted,r)));const n={instance_id:o.uuidv4(),public_key:this.key};e.publish(`wasmbus.evt.${this.hostName}`,o.jsonEncode(i.createEventMessage(this.hostKey,i.EventType.HealthCheckPass,n)))}async subscribeInvocations(e,t){const r=e.subscribe(`wasmbus.rpc.${this.hostName}.${this.key}`);for await(const e of r){const r=n.decode(e.data),s=r,i=await this.module.invoke(s.operation,s.msg);e.respond(n.encode({invocation_id:r.id,instance_id:o.uuidv4(),msg:i})),t&&t(i)}throw new Error("actor.inovcation subscription closed")}}t.Actor=a,t.newActor=async function(e,t,r,n,s,i){const o=new a(e,t,s);return await o.startActor(r),await o.publishActorStarted(n),Promise.all([o.subscribeInvocations(n,i)]).catch((e=>{throw e})),o}},9242:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEventMessage=t.EventType=void 0;const n=r(9882);var s;(s=t.EventType||(t.EventType={})).HeartBeat="com.wasmcloud.lattice.host_heartbeat",s.ActorStarted="com.wasmcloud.lattice.actor_started",s.ActorStopped="com.wasmcloud.lattice.actor_stopped",s.HealthCheckPass="com.wasmcloud.lattice.health_check_passed",t.createEventMessage=function(e,t,r){return{data:r,datacontenttype:"application/json",id:n.uuidv4(),source:e,specversion:"1.0",time:(new Date).toISOString(),type:t}}},3276:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchActor=t.fetchActorDigest=void 0,t.fetchActorDigest=async function(e,t){const r=e.split("/"),n=r[0],[s,i]=r[1].split(":"),o=await fetch(`${t?"https://":"http://"}${n}/v2/${s}/manifests/${i}`,{headers:{Accept:"application/vnd.oci.image.manifest.v1+json"}}).catch((e=>{throw e})),a=await o.json().catch((e=>{throw e}));if(0===a.layers.length)throw new Error("no layers");return{name:s,digest:a.layers[0].digest,registry:n}},t.fetchActor=async function(e){const t=await fetch(e).catch((e=>{throw e})),r=await t.arrayBuffer().catch((e=>{throw e}));return new Uint8Array(r)}},1110:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.startHost=t.Host=void 0;const o=r(8561),a=r(1472),c=r(6926),u=r(9242),h=r(3276),l=r(9882);class d{constructor(e="default",t,r){const n=new r.HostKey;this.name=e,this.key=n.pk,this.seed=n.seed,this.withRegistryTLS=t,this.actors={},this.wasm=r}async connectNATS(e){const t=Array.isArray(e)?{servers:e}:e;this.natsConn=await a.connect(t)}async disconnectNATS(){this.natsConn.drain()}async startHeartbeat(e){this.heartbeatIntervalId;const t={actors:[],providers:[]};for(const e in this.actors)t.actors.push({actor:e,instances:1});this.heartbeatIntervalId=await setInterval((()=>{this.natsConn.publish(`wasmbus.evt.${this.name}`,l.jsonEncode(u.createEventMessage(this.key,u.EventType.HeartBeat,t)))}),e||3e4)}async stopHeartbeat(){clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=null}async subscribeToEvents(e){this.eventsSubscription=this.natsConn.subscribe(`wasmbus.evt.${this.name}`);for await(const t of this.eventsSubscription){const r=l.jsonDecode(t.data);e&&e(r)}throw new Error("evt subscription was closed")}async unsubscribeEvents(){var e;null===(e=this.eventsSubscription)||void 0===e||e.unsubscribe(),this.eventsSubscription=null}async launchActor(e){const t={actor_ref:e,host_id:this.key};this.natsConn.publish(`wasmbus.ctl.${this.name}.cmd.${this.key}.la`,l.jsonEncode(t))}async stopActor(e){const t={host_id:this.key,actor_ref:e};this.natsConn.publish(`wasmbus.ctl.${this.name}.cmd.${this.key}.sa`,l.jsonEncode(t))}async listenLaunchActor(e){const t=this.natsConn.subscribe(`wasmbus.ctl.${this.name}.cmd.${this.key}.la`);for await(const r of t){const t=l.jsonDecode(r.data).actor_ref,n=!t.endsWith(".wasm");try{let r;if(n){const e=await h.fetchActorDigest(t);r=`${this.withRegistryTLS?"https://":"http://"}${e.registry}/v2/${e.name}/blobs/${e.digest}`}else r=t;const s=await h.fetchActor(r),i=await c.newActor(this.name,this.key,s,this.natsConn,this.wasm,e?e[t]:void 0);this.actors[t]?this.actors[t].count++:this.actors[t]={count:1,actor:i}}catch(e){console.log("error",e)}}throw new Error("la.subscription was closed")}async listenStopActor(){const e=this.natsConn.subscribe(`wasmbus.ctl.${this.name}.cmd.${this.key}.sa`);for await(const t of e){const e=l.jsonDecode(t.data),r={instance_id:l.uuidv4(),public_key:this.actors[e.actor_ref].actor.key};this.natsConn.publish(`wasmbus.evt.${this.name}`,l.jsonEncode(u.createEventMessage(this.key,u.EventType.ActorStopped,r))),delete this.actors[e.actor_ref]}throw new Error("sa.subscription was closed")}async createLinkDefinition(e,t,r,n,s){const i={actor_id:e,provider_id:t,link_name:r,contract_id:n,values:s};this.natsConn.publish(`wasmbus.rpc.${this.name}.${t}.${r}.linkdefs.put`,o.encode(i))}}t.Host=d,t.startHost=async function(e,t=!0,n,s,o){const a=await Promise.resolve().then((()=>i(r(2441)))),c=await a.default,u=new d(e,t,c);return await u.connectNATS(n),Promise.all([u.startHeartbeat(o),u.listenLaunchActor(s),u.listenStopActor()]).catch((e=>{throw e})),u}},9882:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jsonDecode=t.jsonEncode=t.parseJwt=t.uuidv4=void 0;const n=r(1472).JSONCodec();t.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},t.parseJwt=function(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(r)},t.jsonEncode=function(e){return n.encode(e)},t.jsonDecode=function(e){return n.decode(e)}},780:(e,t,r)=>{!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},n=function(){throw new Error("no PRNG")},s=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var o=t(),a=t([1]),c=t([56129,1]),u=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),d=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),f=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function y(e,t,r,n,s){var i,o=0;for(i=0;i<s;i++)o|=e[t+i]^r[n+i];return(1&o-1>>>8)-1}function b(e,t,r,n){return y(e,t,r,n,16)}function g(e,t,r,n){return y(e,t,r,n,32)}function m(e,t,r,n){!function(e,t,r,n){for(var s,i=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,h=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,l=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,b=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,g=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,v=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,w=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=i,E=o,P=a,S=c,C=u,A=h,O=l,x=d,I=f,M=p,N=y,k=b,U=g,j=m,T=v,R=w,F=0;F<20;F+=2)_^=(s=(U^=(s=(I^=(s=(C^=(s=_+U|0)<<7|s>>>25)+_|0)<<9|s>>>23)+C|0)<<13|s>>>19)+I|0)<<18|s>>>14,A^=(s=(E^=(s=(j^=(s=(M^=(s=A+E|0)<<7|s>>>25)+A|0)<<9|s>>>23)+M|0)<<13|s>>>19)+j|0)<<18|s>>>14,N^=(s=(O^=(s=(P^=(s=(T^=(s=N+O|0)<<7|s>>>25)+N|0)<<9|s>>>23)+T|0)<<13|s>>>19)+P|0)<<18|s>>>14,R^=(s=(k^=(s=(x^=(s=(S^=(s=R+k|0)<<7|s>>>25)+R|0)<<9|s>>>23)+S|0)<<13|s>>>19)+x|0)<<18|s>>>14,_^=(s=(S^=(s=(P^=(s=(E^=(s=_+S|0)<<7|s>>>25)+_|0)<<9|s>>>23)+E|0)<<13|s>>>19)+P|0)<<18|s>>>14,A^=(s=(C^=(s=(x^=(s=(O^=(s=A+C|0)<<7|s>>>25)+A|0)<<9|s>>>23)+O|0)<<13|s>>>19)+x|0)<<18|s>>>14,N^=(s=(M^=(s=(I^=(s=(k^=(s=N+M|0)<<7|s>>>25)+N|0)<<9|s>>>23)+k|0)<<13|s>>>19)+I|0)<<18|s>>>14,R^=(s=(T^=(s=(j^=(s=(U^=(s=R+T|0)<<7|s>>>25)+R|0)<<9|s>>>23)+U|0)<<13|s>>>19)+j|0)<<18|s>>>14;_=_+i|0,E=E+o|0,P=P+a|0,S=S+c|0,C=C+u|0,A=A+h|0,O=O+l|0,x=x+d|0,I=I+f|0,M=M+p|0,N=N+y|0,k=k+b|0,U=U+g|0,j=j+m|0,T=T+v|0,R=R+w|0,e[0]=_>>>0&255,e[1]=_>>>8&255,e[2]=_>>>16&255,e[3]=_>>>24&255,e[4]=E>>>0&255,e[5]=E>>>8&255,e[6]=E>>>16&255,e[7]=E>>>24&255,e[8]=P>>>0&255,e[9]=P>>>8&255,e[10]=P>>>16&255,e[11]=P>>>24&255,e[12]=S>>>0&255,e[13]=S>>>8&255,e[14]=S>>>16&255,e[15]=S>>>24&255,e[16]=C>>>0&255,e[17]=C>>>8&255,e[18]=C>>>16&255,e[19]=C>>>24&255,e[20]=A>>>0&255,e[21]=A>>>8&255,e[22]=A>>>16&255,e[23]=A>>>24&255,e[24]=O>>>0&255,e[25]=O>>>8&255,e[26]=O>>>16&255,e[27]=O>>>24&255,e[28]=x>>>0&255,e[29]=x>>>8&255,e[30]=x>>>16&255,e[31]=x>>>24&255,e[32]=I>>>0&255,e[33]=I>>>8&255,e[34]=I>>>16&255,e[35]=I>>>24&255,e[36]=M>>>0&255,e[37]=M>>>8&255,e[38]=M>>>16&255,e[39]=M>>>24&255,e[40]=N>>>0&255,e[41]=N>>>8&255,e[42]=N>>>16&255,e[43]=N>>>24&255,e[44]=k>>>0&255,e[45]=k>>>8&255,e[46]=k>>>16&255,e[47]=k>>>24&255,e[48]=U>>>0&255,e[49]=U>>>8&255,e[50]=U>>>16&255,e[51]=U>>>24&255,e[52]=j>>>0&255,e[53]=j>>>8&255,e[54]=j>>>16&255,e[55]=j>>>24&255,e[56]=T>>>0&255,e[57]=T>>>8&255,e[58]=T>>>16&255,e[59]=T>>>24&255,e[60]=R>>>0&255,e[61]=R>>>8&255,e[62]=R>>>16&255,e[63]=R>>>24&255}(e,t,r,n)}function v(e,t,r,n){!function(e,t,r,n){for(var s,i=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,h=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,l=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,b=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,g=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,v=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,w=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=0;_<20;_+=2)i^=(s=(g^=(s=(f^=(s=(u^=(s=i+g|0)<<7|s>>>25)+i|0)<<9|s>>>23)+u|0)<<13|s>>>19)+f|0)<<18|s>>>14,h^=(s=(o^=(s=(m^=(s=(p^=(s=h+o|0)<<7|s>>>25)+h|0)<<9|s>>>23)+p|0)<<13|s>>>19)+m|0)<<18|s>>>14,y^=(s=(l^=(s=(a^=(s=(v^=(s=y+l|0)<<7|s>>>25)+y|0)<<9|s>>>23)+v|0)<<13|s>>>19)+a|0)<<18|s>>>14,w^=(s=(b^=(s=(d^=(s=(c^=(s=w+b|0)<<7|s>>>25)+w|0)<<9|s>>>23)+c|0)<<13|s>>>19)+d|0)<<18|s>>>14,i^=(s=(c^=(s=(a^=(s=(o^=(s=i+c|0)<<7|s>>>25)+i|0)<<9|s>>>23)+o|0)<<13|s>>>19)+a|0)<<18|s>>>14,h^=(s=(u^=(s=(d^=(s=(l^=(s=h+u|0)<<7|s>>>25)+h|0)<<9|s>>>23)+l|0)<<13|s>>>19)+d|0)<<18|s>>>14,y^=(s=(p^=(s=(f^=(s=(b^=(s=y+p|0)<<7|s>>>25)+y|0)<<9|s>>>23)+b|0)<<13|s>>>19)+f|0)<<18|s>>>14,w^=(s=(v^=(s=(m^=(s=(g^=(s=w+v|0)<<7|s>>>25)+w|0)<<9|s>>>23)+g|0)<<13|s>>>19)+m|0)<<18|s>>>14;e[0]=i>>>0&255,e[1]=i>>>8&255,e[2]=i>>>16&255,e[3]=i>>>24&255,e[4]=h>>>0&255,e[5]=h>>>8&255,e[6]=h>>>16&255,e[7]=h>>>24&255,e[8]=y>>>0&255,e[9]=y>>>8&255,e[10]=y>>>16&255,e[11]=y>>>24&255,e[12]=w>>>0&255,e[13]=w>>>8&255,e[14]=w>>>16&255,e[15]=w>>>24&255,e[16]=l>>>0&255,e[17]=l>>>8&255,e[18]=l>>>16&255,e[19]=l>>>24&255,e[20]=d>>>0&255,e[21]=d>>>8&255,e[22]=d>>>16&255,e[23]=d>>>24&255,e[24]=f>>>0&255,e[25]=f>>>8&255,e[26]=f>>>16&255,e[27]=f>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}(e,t,r,n)}var w=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function _(e,t,r,n,s,i,o){var a,c,u=new Uint8Array(16),h=new Uint8Array(64);for(c=0;c<16;c++)u[c]=0;for(c=0;c<8;c++)u[c]=i[c];for(;s>=64;){for(m(h,u,o,w),c=0;c<64;c++)e[t+c]=r[n+c]^h[c];for(a=1,c=8;c<16;c++)a=a+(255&u[c])|0,u[c]=255&a,a>>>=8;s-=64,t+=64,n+=64}if(s>0)for(m(h,u,o,w),c=0;c<s;c++)e[t+c]=r[n+c]^h[c];return 0}function E(e,t,r,n,s){var i,o,a=new Uint8Array(16),c=new Uint8Array(64);for(o=0;o<16;o++)a[o]=0;for(o=0;o<8;o++)a[o]=n[o];for(;r>=64;){for(m(c,a,s,w),o=0;o<64;o++)e[t+o]=c[o];for(i=1,o=8;o<16;o++)i=i+(255&a[o])|0,a[o]=255&i,i>>>=8;r-=64,t+=64}if(r>0)for(m(c,a,s,w),o=0;o<r;o++)e[t+o]=c[o];return 0}function P(e,t,r,n,s){var i=new Uint8Array(32);v(i,n,s,w);for(var o=new Uint8Array(8),a=0;a<8;a++)o[a]=n[a+16];return E(e,t,r,o,i)}function S(e,t,r,n,s,i,o){var a=new Uint8Array(32);v(a,i,o,w);for(var c=new Uint8Array(8),u=0;u<8;u++)c[u]=i[u+16];return _(e,t,r,n,s,c,a)}var C=function(e){var t,r,n,s,i,o,a,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),s=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|s<<9),i=255&e[8]|(255&e[9])<<8,this.r[4]=255&(s>>>4|i<<12),this.r[5]=i>>>1&8190,o=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(i>>>14|o<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(o>>>11|a<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function A(e,t,r,n,s,i){var o=new C(i);return o.update(r,n,s),o.finish(e,t),0}function O(e,t,r,n,s,i){var o=new Uint8Array(16);return A(o,0,r,n,s,i),b(e,t,o,0)}function x(e,t,r,n,s){var i;if(r<32)return-1;for(S(e,0,t,0,r,n,s),A(e,16,e,32,r-32,e),i=0;i<16;i++)e[i]=0;return 0}function I(e,t,r,n,s){var i,o=new Uint8Array(32);if(r<32)return-1;if(P(o,0,32,n,s),0!==O(t,16,t,32,r-32,o))return-1;for(S(e,0,t,0,r,n,s),i=0;i<32;i++)e[i]=0;return 0}function M(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function N(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function k(e,t,r){for(var n,s=~(r-1),i=0;i<16;i++)n=s&(e[i]^t[i]),e[i]^=n,t[i]^=n}function U(e,r){var n,s,i,o=t(),a=t();for(n=0;n<16;n++)a[n]=r[n];for(N(a),N(a),N(a),s=0;s<2;s++){for(o[0]=a[0]-65517,n=1;n<15;n++)o[n]=a[n]-65535-(o[n-1]>>16&1),o[n-1]&=65535;o[15]=a[15]-32767-(o[14]>>16&1),i=o[15]>>16&1,o[14]&=65535,k(a,o,1-i)}for(n=0;n<16;n++)e[2*n]=255&a[n],e[2*n+1]=a[n]>>8}function j(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return U(r,e),U(n,t),g(r,0,n,0)}function T(e){var t=new Uint8Array(32);return U(t,e),1&t[0]}function R(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function F(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function L(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function D(e,t,r){var n,s,i=0,o=0,a=0,c=0,u=0,h=0,l=0,d=0,f=0,p=0,y=0,b=0,g=0,m=0,v=0,w=0,_=0,E=0,P=0,S=0,C=0,A=0,O=0,x=0,I=0,M=0,N=0,k=0,U=0,j=0,T=0,R=r[0],F=r[1],L=r[2],D=r[3],B=r[4],$=r[5],K=r[6],q=r[7],H=r[8],z=r[9],G=r[10],J=r[11],V=r[12],W=r[13],X=r[14],Y=r[15];i+=(n=t[0])*R,o+=n*F,a+=n*L,c+=n*D,u+=n*B,h+=n*$,l+=n*K,d+=n*q,f+=n*H,p+=n*z,y+=n*G,b+=n*J,g+=n*V,m+=n*W,v+=n*X,w+=n*Y,o+=(n=t[1])*R,a+=n*F,c+=n*L,u+=n*D,h+=n*B,l+=n*$,d+=n*K,f+=n*q,p+=n*H,y+=n*z,b+=n*G,g+=n*J,m+=n*V,v+=n*W,w+=n*X,_+=n*Y,a+=(n=t[2])*R,c+=n*F,u+=n*L,h+=n*D,l+=n*B,d+=n*$,f+=n*K,p+=n*q,y+=n*H,b+=n*z,g+=n*G,m+=n*J,v+=n*V,w+=n*W,_+=n*X,E+=n*Y,c+=(n=t[3])*R,u+=n*F,h+=n*L,l+=n*D,d+=n*B,f+=n*$,p+=n*K,y+=n*q,b+=n*H,g+=n*z,m+=n*G,v+=n*J,w+=n*V,_+=n*W,E+=n*X,P+=n*Y,u+=(n=t[4])*R,h+=n*F,l+=n*L,d+=n*D,f+=n*B,p+=n*$,y+=n*K,b+=n*q,g+=n*H,m+=n*z,v+=n*G,w+=n*J,_+=n*V,E+=n*W,P+=n*X,S+=n*Y,h+=(n=t[5])*R,l+=n*F,d+=n*L,f+=n*D,p+=n*B,y+=n*$,b+=n*K,g+=n*q,m+=n*H,v+=n*z,w+=n*G,_+=n*J,E+=n*V,P+=n*W,S+=n*X,C+=n*Y,l+=(n=t[6])*R,d+=n*F,f+=n*L,p+=n*D,y+=n*B,b+=n*$,g+=n*K,m+=n*q,v+=n*H,w+=n*z,_+=n*G,E+=n*J,P+=n*V,S+=n*W,C+=n*X,A+=n*Y,d+=(n=t[7])*R,f+=n*F,p+=n*L,y+=n*D,b+=n*B,g+=n*$,m+=n*K,v+=n*q,w+=n*H,_+=n*z,E+=n*G,P+=n*J,S+=n*V,C+=n*W,A+=n*X,O+=n*Y,f+=(n=t[8])*R,p+=n*F,y+=n*L,b+=n*D,g+=n*B,m+=n*$,v+=n*K,w+=n*q,_+=n*H,E+=n*z,P+=n*G,S+=n*J,C+=n*V,A+=n*W,O+=n*X,x+=n*Y,p+=(n=t[9])*R,y+=n*F,b+=n*L,g+=n*D,m+=n*B,v+=n*$,w+=n*K,_+=n*q,E+=n*H,P+=n*z,S+=n*G,C+=n*J,A+=n*V,O+=n*W,x+=n*X,I+=n*Y,y+=(n=t[10])*R,b+=n*F,g+=n*L,m+=n*D,v+=n*B,w+=n*$,_+=n*K,E+=n*q,P+=n*H,S+=n*z,C+=n*G,A+=n*J,O+=n*V,x+=n*W,I+=n*X,M+=n*Y,b+=(n=t[11])*R,g+=n*F,m+=n*L,v+=n*D,w+=n*B,_+=n*$,E+=n*K,P+=n*q,S+=n*H,C+=n*z,A+=n*G,O+=n*J,x+=n*V,I+=n*W,M+=n*X,N+=n*Y,g+=(n=t[12])*R,m+=n*F,v+=n*L,w+=n*D,_+=n*B,E+=n*$,P+=n*K,S+=n*q,C+=n*H,A+=n*z,O+=n*G,x+=n*J,I+=n*V,M+=n*W,N+=n*X,k+=n*Y,m+=(n=t[13])*R,v+=n*F,w+=n*L,_+=n*D,E+=n*B,P+=n*$,S+=n*K,C+=n*q,A+=n*H,O+=n*z,x+=n*G,I+=n*J,M+=n*V,N+=n*W,k+=n*X,U+=n*Y,v+=(n=t[14])*R,w+=n*F,_+=n*L,E+=n*D,P+=n*B,S+=n*$,C+=n*K,A+=n*q,O+=n*H,x+=n*z,I+=n*G,M+=n*J,N+=n*V,k+=n*W,U+=n*X,j+=n*Y,w+=(n=t[15])*R,o+=38*(E+=n*L),a+=38*(P+=n*D),c+=38*(S+=n*B),u+=38*(C+=n*$),h+=38*(A+=n*K),l+=38*(O+=n*q),d+=38*(x+=n*H),f+=38*(I+=n*z),p+=38*(M+=n*G),y+=38*(N+=n*J),b+=38*(k+=n*V),g+=38*(U+=n*W),m+=38*(j+=n*X),v+=38*(T+=n*Y),i=(n=(i+=38*(_+=n*F))+(s=1)+65535)-65536*(s=Math.floor(n/65536)),o=(n=o+s+65535)-65536*(s=Math.floor(n/65536)),a=(n=a+s+65535)-65536*(s=Math.floor(n/65536)),c=(n=c+s+65535)-65536*(s=Math.floor(n/65536)),u=(n=u+s+65535)-65536*(s=Math.floor(n/65536)),h=(n=h+s+65535)-65536*(s=Math.floor(n/65536)),l=(n=l+s+65535)-65536*(s=Math.floor(n/65536)),d=(n=d+s+65535)-65536*(s=Math.floor(n/65536)),f=(n=f+s+65535)-65536*(s=Math.floor(n/65536)),p=(n=p+s+65535)-65536*(s=Math.floor(n/65536)),y=(n=y+s+65535)-65536*(s=Math.floor(n/65536)),b=(n=b+s+65535)-65536*(s=Math.floor(n/65536)),g=(n=g+s+65535)-65536*(s=Math.floor(n/65536)),m=(n=m+s+65535)-65536*(s=Math.floor(n/65536)),v=(n=v+s+65535)-65536*(s=Math.floor(n/65536)),w=(n=w+s+65535)-65536*(s=Math.floor(n/65536)),i=(n=(i+=s-1+37*(s-1))+(s=1)+65535)-65536*(s=Math.floor(n/65536)),o=(n=o+s+65535)-65536*(s=Math.floor(n/65536)),a=(n=a+s+65535)-65536*(s=Math.floor(n/65536)),c=(n=c+s+65535)-65536*(s=Math.floor(n/65536)),u=(n=u+s+65535)-65536*(s=Math.floor(n/65536)),h=(n=h+s+65535)-65536*(s=Math.floor(n/65536)),l=(n=l+s+65535)-65536*(s=Math.floor(n/65536)),d=(n=d+s+65535)-65536*(s=Math.floor(n/65536)),f=(n=f+s+65535)-65536*(s=Math.floor(n/65536)),p=(n=p+s+65535)-65536*(s=Math.floor(n/65536)),y=(n=y+s+65535)-65536*(s=Math.floor(n/65536)),b=(n=b+s+65535)-65536*(s=Math.floor(n/65536)),g=(n=g+s+65535)-65536*(s=Math.floor(n/65536)),m=(n=m+s+65535)-65536*(s=Math.floor(n/65536)),v=(n=v+s+65535)-65536*(s=Math.floor(n/65536)),w=(n=w+s+65535)-65536*(s=Math.floor(n/65536)),i+=s-1+37*(s-1),e[0]=i,e[1]=o,e[2]=a,e[3]=c,e[4]=u,e[5]=h,e[6]=l,e[7]=d,e[8]=f,e[9]=p,e[10]=y,e[11]=b,e[12]=g,e[13]=m,e[14]=v,e[15]=w}function B(e,t){D(e,t,t)}function $(e,r){var n,s=t();for(n=0;n<16;n++)s[n]=r[n];for(n=253;n>=0;n--)B(s,s),2!==n&&4!==n&&D(s,s,r);for(n=0;n<16;n++)e[n]=s[n]}function K(e,r){var n,s=t();for(n=0;n<16;n++)s[n]=r[n];for(n=250;n>=0;n--)B(s,s),1!==n&&D(s,s,r);for(n=0;n<16;n++)e[n]=s[n]}function q(e,r,n){var s,i,o=new Uint8Array(32),a=new Float64Array(80),u=t(),h=t(),l=t(),d=t(),f=t(),p=t();for(i=0;i<31;i++)o[i]=r[i];for(o[31]=127&r[31]|64,o[0]&=248,R(a,n),i=0;i<16;i++)h[i]=a[i],d[i]=u[i]=l[i]=0;for(u[0]=d[0]=1,i=254;i>=0;--i)k(u,h,s=o[i>>>3]>>>(7&i)&1),k(l,d,s),F(f,u,l),L(u,u,l),F(l,h,d),L(h,h,d),B(d,f),B(p,u),D(u,l,u),D(l,h,f),F(f,u,l),L(u,u,l),B(h,u),L(l,d,p),D(u,l,c),F(u,u,d),D(l,l,u),D(u,d,p),D(d,h,a),B(h,f),k(u,h,s),k(l,d,s);for(i=0;i<16;i++)a[i+16]=u[i],a[i+32]=l[i],a[i+48]=h[i],a[i+64]=d[i];var y=a.subarray(32),b=a.subarray(16);return $(y,y),D(b,b,y),U(e,b),0}function H(e,t){return q(e,t,i)}function z(e,t){return n(t,32),H(e,t)}function G(e,t,r){var n=new Uint8Array(32);return q(n,r,t),v(e,s,n,w)}C.prototype.blocks=function(e,t,r){for(var n,s,i,o,a,c,u,h,l,d,f,p,y,b,g,m,v,w,_,E=this.fin?0:2048,P=this.h[0],S=this.h[1],C=this.h[2],A=this.h[3],O=this.h[4],x=this.h[5],I=this.h[6],M=this.h[7],N=this.h[8],k=this.h[9],U=this.r[0],j=this.r[1],T=this.r[2],R=this.r[3],F=this.r[4],L=this.r[5],D=this.r[6],B=this.r[7],$=this.r[8],K=this.r[9];r>=16;)d=l=0,d+=(P+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*U,d+=(S+=8191&(n>>>13|(s=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*K),d+=(C+=8191&(s>>>10|(i=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*$),d+=(A+=8191&(i>>>7|(o=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*B),l=(d+=(O+=8191&(o>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*D))>>>13,d&=8191,d+=(x+=a>>>1&8191)*(5*L),d+=(I+=8191&(a>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*F),d+=(M+=8191&(c>>>11|(u=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*R),d+=(N+=8191&(u>>>8|(h=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*T),f=l+=(d+=(k+=h>>>5|E)*(5*j))>>>13,f+=P*j,f+=S*U,f+=C*(5*K),f+=A*(5*$),l=(f+=O*(5*B))>>>13,f&=8191,f+=x*(5*D),f+=I*(5*L),f+=M*(5*F),f+=N*(5*R),l+=(f+=k*(5*T))>>>13,f&=8191,p=l,p+=P*T,p+=S*j,p+=C*U,p+=A*(5*K),l=(p+=O*(5*$))>>>13,p&=8191,p+=x*(5*B),p+=I*(5*D),p+=M*(5*L),p+=N*(5*F),y=l+=(p+=k*(5*R))>>>13,y+=P*R,y+=S*T,y+=C*j,y+=A*U,l=(y+=O*(5*K))>>>13,y&=8191,y+=x*(5*$),y+=I*(5*B),y+=M*(5*D),y+=N*(5*L),b=l+=(y+=k*(5*F))>>>13,b+=P*F,b+=S*R,b+=C*T,b+=A*j,l=(b+=O*U)>>>13,b&=8191,b+=x*(5*K),b+=I*(5*$),b+=M*(5*B),b+=N*(5*D),g=l+=(b+=k*(5*L))>>>13,g+=P*L,g+=S*F,g+=C*R,g+=A*T,l=(g+=O*j)>>>13,g&=8191,g+=x*U,g+=I*(5*K),g+=M*(5*$),g+=N*(5*B),m=l+=(g+=k*(5*D))>>>13,m+=P*D,m+=S*L,m+=C*F,m+=A*R,l=(m+=O*T)>>>13,m&=8191,m+=x*j,m+=I*U,m+=M*(5*K),m+=N*(5*$),v=l+=(m+=k*(5*B))>>>13,v+=P*B,v+=S*D,v+=C*L,v+=A*F,l=(v+=O*R)>>>13,v&=8191,v+=x*T,v+=I*j,v+=M*U,v+=N*(5*K),w=l+=(v+=k*(5*$))>>>13,w+=P*$,w+=S*B,w+=C*D,w+=A*L,l=(w+=O*F)>>>13,w&=8191,w+=x*R,w+=I*T,w+=M*j,w+=N*U,_=l+=(w+=k*(5*K))>>>13,_+=P*K,_+=S*$,_+=C*B,_+=A*D,l=(_+=O*L)>>>13,_&=8191,_+=x*F,_+=I*R,_+=M*T,_+=N*j,P=d=8191&(l=(l=((l+=(_+=k*U)>>>13)<<2)+l|0)+(d&=8191)|0),S=f+=l>>>=13,C=p&=8191,A=y&=8191,O=b&=8191,x=g&=8191,I=m&=8191,M=v&=8191,N=w&=8191,k=_&=8191,t+=16,r-=16;this.h[0]=P,this.h[1]=S,this.h[2]=C,this.h[3]=A,this.h[4]=O,this.h[5]=x,this.h[6]=I,this.h[7]=M,this.h[8]=N,this.h[9]=k},C.prototype.finish=function(e,t){var r,n,s,i,o=new Uint16Array(10);if(this.leftover){for(i=this.leftover,this.buffer[i++]=1;i<16;i++)this.buffer[i]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,i=2;i<10;i++)this.h[i]+=r,r=this.h[i]>>>13,this.h[i]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,o[0]=this.h[0]+5,r=o[0]>>>13,o[0]&=8191,i=1;i<10;i++)o[i]=this.h[i]+r,r=o[i]>>>13,o[i]&=8191;for(o[9]-=8192,n=(1^r)-1,i=0;i<10;i++)o[i]&=n;for(n=~n,i=0;i<10;i++)this.h[i]=this.h[i]&n|o[i];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),s=this.h[0]+this.pad[0],this.h[0]=65535&s,i=1;i<8;i++)s=(this.h[i]+this.pad[i]|0)+(s>>>16)|0,this.h[i]=65535&s;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},C.prototype.update=function(e,t,r){var n,s;if(this.leftover){for((s=16-this.leftover)>r&&(s=r),n=0;n<s;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=s,t+=s,this.leftover+=s,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(s=r-r%16,this.blocks(e,t,s),t+=s,r-=s),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var J=x,V=I,W=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function X(e,t,r,n){for(var s,i,o,a,c,u,h,l,d,f,p,y,b,g,m,v,w,_,E,P,S,C,A,O,x,I,M=new Int32Array(16),N=new Int32Array(16),k=e[0],U=e[1],j=e[2],T=e[3],R=e[4],F=e[5],L=e[6],D=e[7],B=t[0],$=t[1],K=t[2],q=t[3],H=t[4],z=t[5],G=t[6],J=t[7],V=0;n>=128;){for(E=0;E<16;E++)P=8*E+V,M[E]=r[P+0]<<24|r[P+1]<<16|r[P+2]<<8|r[P+3],N[E]=r[P+4]<<24|r[P+5]<<16|r[P+6]<<8|r[P+7];for(E=0;E<80;E++)if(s=k,i=U,o=j,a=T,c=R,u=F,h=L,d=B,f=$,p=K,y=q,b=H,g=z,m=G,A=65535&(C=J),O=C>>>16,x=65535&(S=D),I=S>>>16,A+=65535&(C=(H>>>14|R<<18)^(H>>>18|R<<14)^(R>>>9|H<<23)),O+=C>>>16,x+=65535&(S=(R>>>14|H<<18)^(R>>>18|H<<14)^(H>>>9|R<<23)),I+=S>>>16,A+=65535&(C=H&z^~H&G),O+=C>>>16,x+=65535&(S=R&F^~R&L),I+=S>>>16,A+=65535&(C=W[2*E+1]),O+=C>>>16,x+=65535&(S=W[2*E]),I+=S>>>16,S=M[E%16],O+=(C=N[E%16])>>>16,x+=65535&S,I+=S>>>16,x+=(O+=(A+=65535&C)>>>16)>>>16,A=65535&(C=_=65535&A|O<<16),O=C>>>16,x=65535&(S=w=65535&x|(I+=x>>>16)<<16),I=S>>>16,A+=65535&(C=(B>>>28|k<<4)^(k>>>2|B<<30)^(k>>>7|B<<25)),O+=C>>>16,x+=65535&(S=(k>>>28|B<<4)^(B>>>2|k<<30)^(B>>>7|k<<25)),I+=S>>>16,O+=(C=B&$^B&K^$&K)>>>16,x+=65535&(S=k&U^k&j^U&j),I+=S>>>16,l=65535&(x+=(O+=(A+=65535&C)>>>16)>>>16)|(I+=x>>>16)<<16,v=65535&A|O<<16,A=65535&(C=y),O=C>>>16,x=65535&(S=a),I=S>>>16,O+=(C=_)>>>16,x+=65535&(S=w),I+=S>>>16,U=s,j=i,T=o,R=a=65535&(x+=(O+=(A+=65535&C)>>>16)>>>16)|(I+=x>>>16)<<16,F=c,L=u,D=h,k=l,$=d,K=f,q=p,H=y=65535&A|O<<16,z=b,G=g,J=m,B=v,E%16==15)for(P=0;P<16;P++)S=M[P],A=65535&(C=N[P]),O=C>>>16,x=65535&S,I=S>>>16,S=M[(P+9)%16],A+=65535&(C=N[(P+9)%16]),O+=C>>>16,x+=65535&S,I+=S>>>16,w=M[(P+1)%16],A+=65535&(C=((_=N[(P+1)%16])>>>1|w<<31)^(_>>>8|w<<24)^(_>>>7|w<<25)),O+=C>>>16,x+=65535&(S=(w>>>1|_<<31)^(w>>>8|_<<24)^w>>>7),I+=S>>>16,w=M[(P+14)%16],O+=(C=((_=N[(P+14)%16])>>>19|w<<13)^(w>>>29|_<<3)^(_>>>6|w<<26))>>>16,x+=65535&(S=(w>>>19|_<<13)^(_>>>29|w<<3)^w>>>6),I+=S>>>16,I+=(x+=(O+=(A+=65535&C)>>>16)>>>16)>>>16,M[P]=65535&x|I<<16,N[P]=65535&A|O<<16;A=65535&(C=B),O=C>>>16,x=65535&(S=k),I=S>>>16,S=e[0],O+=(C=t[0])>>>16,x+=65535&S,I+=S>>>16,I+=(x+=(O+=(A+=65535&C)>>>16)>>>16)>>>16,e[0]=k=65535&x|I<<16,t[0]=B=65535&A|O<<16,A=65535&(C=$),O=C>>>16,x=65535&(S=U),I=S>>>16,S=e[1],O+=(C=t[1])>>>16,x+=65535&S,I+=S>>>16,I+=(x+=(O+=(A+=65535&C)>>>16)>>>16)>>>16,e[1]=U=65535&x|I<<16,t[1]=$=65535&A|O<<16,A=65535&(C=K),O=C>>>16,x=65535&(S=j),I=S>>>16,S=e[2],O+=(C=t[2])>>>16,x+=65535&S,I+=S>>>16,I+=(x+=(O+=(A+=65535&C)>>>16)>>>16)>>>16,e[2]=j=65535&x|I<<16,t[2]=K=65535&A|O<<16,A=65535&(C=q),O=C>>>16,x=65535&(S=T),I=S>>>16,S=e[3],O+=(C=t[3])>>>16,x+=65535&S,I+=S>>>16,I+=(x+=(O+=(A+=65535&C)>>>16)>>>16)>>>16,e[3]=T=65535&x|I<<16,t[3]=q=65535&A|O<<16,A=65535&(C=H),O=C>>>16,x=65535&(S=R),I=S>>>16,S=e[4],O+=(C=t[4])>>>16,x+=65535&S,I+=S>>>16,I+=(x+=(O+=(A+=65535&C)>>>16)>>>16)>>>16,e[4]=R=65535&x|I<<16,t[4]=H=65535&A|O<<16,A=65535&(C=z),O=C>>>16,x=65535&(S=F),I=S>>>16,S=e[5],O+=(C=t[5])>>>16,x+=65535&S,I+=S>>>16,I+=(x+=(O+=(A+=65535&C)>>>16)>>>16)>>>16,e[5]=F=65535&x|I<<16,t[5]=z=65535&A|O<<16,A=65535&(C=G),O=C>>>16,x=65535&(S=L),I=S>>>16,S=e[6],O+=(C=t[6])>>>16,x+=65535&S,I+=S>>>16,I+=(x+=(O+=(A+=65535&C)>>>16)>>>16)>>>16,e[6]=L=65535&x|I<<16,t[6]=G=65535&A|O<<16,A=65535&(C=J),O=C>>>16,x=65535&(S=D),I=S>>>16,S=e[7],O+=(C=t[7])>>>16,x+=65535&S,I+=S>>>16,I+=(x+=(O+=(A+=65535&C)>>>16)>>>16)>>>16,e[7]=D=65535&x|I<<16,t[7]=J=65535&A|O<<16,V+=128,n-=128}return n}function Y(e,t,r){var n,s=new Int32Array(8),i=new Int32Array(8),o=new Uint8Array(256),a=r;for(s[0]=1779033703,s[1]=3144134277,s[2]=1013904242,s[3]=2773480762,s[4]=1359893119,s[5]=2600822924,s[6]=528734635,s[7]=1541459225,i[0]=4089235720,i[1]=2227873595,i[2]=4271175723,i[3]=1595750129,i[4]=2917565137,i[5]=725511199,i[6]=4215389547,i[7]=327033209,X(s,i,t,r),r%=128,n=0;n<r;n++)o[n]=t[a-r+n];for(o[r]=128,o[(r=256-128*(r<112?1:0))-9]=0,p(o,r-8,a/536870912|0,a<<3),X(s,i,o,r),n=0;n<8;n++)p(e,8*n,s[n],i[n]);return 0}function Z(e,r){var n=t(),s=t(),i=t(),o=t(),a=t(),c=t(),u=t(),l=t(),d=t();L(n,e[1],e[0]),L(d,r[1],r[0]),D(n,n,d),F(s,e[0],e[1]),F(d,r[0],r[1]),D(s,s,d),D(i,e[3],r[3]),D(i,i,h),D(o,e[2],r[2]),F(o,o,o),L(a,s,n),L(c,o,i),F(u,o,i),F(l,s,n),D(e[0],a,c),D(e[1],l,u),D(e[2],u,c),D(e[3],a,l)}function Q(e,t,r){var n;for(n=0;n<4;n++)k(e[n],t[n],r)}function ee(e,r){var n=t(),s=t(),i=t();$(i,r[2]),D(n,r[0],i),D(s,r[1],i),U(e,s),e[31]^=T(n)<<7}function te(e,t,r){var n,s;for(M(e[0],o),M(e[1],a),M(e[2],a),M(e[3],o),s=255;s>=0;--s)Q(e,t,n=r[s/8|0]>>(7&s)&1),Z(t,e),Z(e,e),Q(e,t,n)}function re(e,r){var n=[t(),t(),t(),t()];M(n[0],l),M(n[1],d),M(n[2],a),D(n[3],l,d),te(e,n,r)}function ne(e,r,s){var i,o=new Uint8Array(64),a=[t(),t(),t(),t()];for(s||n(r,32),Y(o,r,32),o[0]&=248,o[31]&=127,o[31]|=64,re(a,o),ee(e,a),i=0;i<32;i++)r[i+32]=e[i];return 0}var se=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ie(e,t){var r,n,s,i;for(n=63;n>=32;--n){for(r=0,s=n-32,i=n-12;s<i;++s)t[s]+=r-16*t[n]*se[s-(n-32)],r=Math.floor((t[s]+128)/256),t[s]-=256*r;t[s]+=r,t[n]=0}for(r=0,s=0;s<32;s++)t[s]+=r-(t[31]>>4)*se[s],r=t[s]>>8,t[s]&=255;for(s=0;s<32;s++)t[s]-=r*se[s];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function oe(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;ie(e,r)}function ae(e,r,n,s){var i,o,a=new Uint8Array(64),c=new Uint8Array(64),u=new Uint8Array(64),h=new Float64Array(64),l=[t(),t(),t(),t()];Y(a,s,32),a[0]&=248,a[31]&=127,a[31]|=64;var d=n+64;for(i=0;i<n;i++)e[64+i]=r[i];for(i=0;i<32;i++)e[32+i]=a[32+i];for(Y(u,e.subarray(32),n+32),oe(u),re(l,u),ee(e,l),i=32;i<64;i++)e[i]=s[i];for(Y(c,e,n+64),oe(c),i=0;i<64;i++)h[i]=0;for(i=0;i<32;i++)h[i]=u[i];for(i=0;i<32;i++)for(o=0;o<32;o++)h[i+o]+=c[i]*a[o];return ie(e.subarray(32),h),d}function ce(e,r,n,s){var i,c=new Uint8Array(32),h=new Uint8Array(64),l=[t(),t(),t(),t()],d=[t(),t(),t(),t()];if(n<64)return-1;if(function(e,r){var n=t(),s=t(),i=t(),c=t(),h=t(),l=t(),d=t();return M(e[2],a),R(e[1],r),B(i,e[1]),D(c,i,u),L(i,i,e[2]),F(c,e[2],c),B(h,c),B(l,h),D(d,l,h),D(n,d,i),D(n,n,c),K(n,n),D(n,n,i),D(n,n,c),D(n,n,c),D(e[0],n,c),B(s,e[0]),D(s,s,c),j(s,i)&&D(e[0],e[0],f),B(s,e[0]),D(s,s,c),j(s,i)?-1:(T(e[0])===r[31]>>7&&L(e[0],o,e[0]),D(e[3],e[0],e[1]),0)}(d,s))return-1;for(i=0;i<n;i++)e[i]=r[i];for(i=0;i<32;i++)e[i+32]=s[i];if(Y(h,e,n),oe(h),te(l,d,h),re(d,r.subarray(32)),Z(l,d),ee(c,l),n-=64,g(r,0,c,0)){for(i=0;i<n;i++)e[i]=0;return-1}for(i=0;i<n;i++)e[i]=r[i+64];return n}var ue,he=64,le=32,de=64;function fe(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function pe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ye(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:v,crypto_stream_xor:S,crypto_stream:P,crypto_stream_salsa20_xor:_,crypto_stream_salsa20:E,crypto_onetimeauth:A,crypto_onetimeauth_verify:O,crypto_verify_16:b,crypto_verify_32:g,crypto_secretbox:x,crypto_secretbox_open:I,crypto_scalarmult:q,crypto_scalarmult_base:H,crypto_box_beforenm:G,crypto_box_afternm:J,crypto_box:function(e,t,r,n,s,i){var o=new Uint8Array(32);return G(o,s,i),J(e,t,r,n,o)},crypto_box_open:function(e,t,r,n,s,i){var o=new Uint8Array(32);return G(o,s,i),V(e,t,r,n,o)},crypto_box_keypair:z,crypto_hash:Y,crypto_sign:ae,crypto_sign_keypair:ne,crypto_sign_open:ce,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:he,crypto_sign_PUBLICKEYBYTES:le,crypto_sign_SECRETKEYBYTES:de,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:u,L:se,pack25519:U,unpack25519:R,M:D,A:F,S:B,Z:L,pow2523:K,add:Z,set25519:M,modL:ie,scalarmult:te,scalarbase:re},e.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},e.secretbox=function(e,t,r){pe(e,t,r),fe(r,t);for(var n=new Uint8Array(32+e.length),s=new Uint8Array(n.length),i=0;i<e.length;i++)n[i+32]=e[i];return x(s,n,n.length,t,r),s.subarray(16)},e.secretbox.open=function(e,t,r){pe(e,t,r),fe(r,t);for(var n=new Uint8Array(16+e.length),s=new Uint8Array(n.length),i=0;i<e.length;i++)n[i+16]=e[i];return n.length<32||0!==I(s,n,n.length,t,r)?null:s.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=16,e.scalarMult=function(e,t){if(pe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return q(r,e,t),r},e.scalarMult.base=function(e){if(pe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return H(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,s){var i=e.box.before(n,s);return e.secretbox(t,r,i)},e.box.before=function(e,t){pe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return G(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,s){var i=e.box.before(n,s);return e.secretbox.open(t,r,i)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return z(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(pe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return H(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(pe(e,t),t.length!==de)throw new Error("bad secret key size");var r=new Uint8Array(he+e.length);return ae(r,e,e.length,t),r},e.sign.open=function(e,t){if(pe(e,t),t.length!==le)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=ce(r,e,e.length,t);if(n<0)return null;for(var s=new Uint8Array(n),i=0;i<s.length;i++)s[i]=r[i];return s},e.sign.detached=function(t,r){for(var n=e.sign(t,r),s=new Uint8Array(he),i=0;i<s.length;i++)s[i]=n[i];return s},e.sign.detached.verify=function(e,t,r){if(pe(e,t,r),t.length!==he)throw new Error("bad signature size");if(r.length!==le)throw new Error("bad public key size");var n,s=new Uint8Array(he+e.length),i=new Uint8Array(he+e.length);for(n=0;n<he;n++)s[n]=t[n];for(n=0;n<e.length;n++)s[n+he]=e[n];return ce(i,s,s.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(le),t=new Uint8Array(de);return ne(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(pe(e),e.length!==de)throw new Error("bad secret key size");for(var t=new Uint8Array(le),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(pe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(le),r=new Uint8Array(de),n=0;n<32;n++)r[n]=e[n];return ne(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=le,e.sign.secretKeyLength=de,e.sign.seedLength=32,e.sign.signatureLength=he,e.hash=function(e){pe(e);var t=new Uint8Array(64);return Y(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return pe(e,t),0!==e.length&&0!==t.length&&e.length===t.length&&0===y(e,0,t,0,e.length)},e.setPRNG=function(e){n=e},(ue="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&ue.getRandomValues?e.setPRNG((function(e,t){var r,n=new Uint8Array(t);for(r=0;r<t;r+=65536)ue.getRandomValues(n.subarray(r,r+Math.min(t-r,65536)));for(r=0;r<t;r++)e[r]=n[r];ye(n)})):(ue=r(5024))&&ue.randomBytes&&e.setPRNG((function(e,t){var r,n=ue.randomBytes(t);for(r=0;r<t;r++)e[r]=n[r];ye(n)}))}(e.exports?e.exports:self.nacl=self.nacl||{})},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},9539:(e,t,r)=>{var n=/%[sdj%]/g;t.format=function(e){if(!b(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(o(arguments[r]));return t.join(" ")}r=1;for(var s=arguments,i=s.length,a=String(e).replace(n,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(s[r++]);case"%d":return Number(s[r++]);case"%j":try{return JSON.stringify(s[r++])}catch(e){return"[Circular]"}default:return e}})),c=s[r];r<i;c=s[++r])p(c)||!v(c)?a+=" "+c:a+=" "+o(c);return a},t.deprecate=function(e,n){if(g(r.g.process))return function(){return t.deprecate(e,n).apply(this,arguments)};if(!0===process.noDeprecation)return e;var s=!1;return function(){if(!s){if(process.throwDeprecation)throw new Error(n);process.traceDeprecation?console.trace(n):console.error(n),s=!0}return e.apply(this,arguments)}};var s,i={};function o(e,r){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(r)?n.showHidden=r:r&&t._extend(n,r),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=a),u(n,e,n.depth)}function a(e,t){var r=o.styles[t];return r?"["+o.colors[r][0]+"m"+e+"["+o.colors[r][1]+"m":e}function c(e,t){return e}function u(e,r,n){if(e.customInspect&&r&&E(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var s=r.inspect(n,e);return b(s)||(s=u(e,s,n)),s}var i=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(b(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return y(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):p(t)?e.stylize("null","null"):void 0}(e,r);if(i)return i;var o=Object.keys(r),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),_(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(r);if(0===o.length){if(E(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(m(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(w(r))return e.stylize(Date.prototype.toString.call(r),"date");if(_(r))return h(r)}var v,P="",S=!1,C=["{","}"];return d(r)&&(S=!0,C=["[","]"]),E(r)&&(P=" [Function"+(r.name?": "+r.name:"")+"]"),m(r)&&(P=" "+RegExp.prototype.toString.call(r)),w(r)&&(P=" "+Date.prototype.toUTCString.call(r)),_(r)&&(P=" "+h(r)),0!==o.length||S&&0!=r.length?n<0?m(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),v=S?function(e,t,r,n,s){for(var i=[],o=0,a=t.length;o<a;++o)O(t,String(o))?i.push(l(e,t,r,n,String(o),!0)):i.push("");return s.forEach((function(s){s.match(/^\d+$/)||i.push(l(e,t,r,n,s,!0))})),i}(e,r,n,a,o):o.map((function(t){return l(e,r,n,a,t,S)})),e.seen.pop(),function(e,t,r){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(v,P,C)):C[0]+P+C[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,r,n,s,i){var o,a,c;if((c=Object.getOwnPropertyDescriptor(t,s)||{value:t[s]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),O(n,s)||(o="["+s+"]"),a||(e.seen.indexOf(c.value)<0?(a=p(r)?u(e,c.value,null):u(e,c.value,r-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),g(o)){if(i&&s.match(/^\d+$/))return a;(o=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+a}function d(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function p(e){return null===e}function y(e){return"number"==typeof e}function b(e){return"string"==typeof e}function g(e){return void 0===e}function m(e){return v(e)&&"[object RegExp]"===P(e)}function v(e){return"object"==typeof e&&null!==e}function w(e){return v(e)&&"[object Date]"===P(e)}function _(e){return v(e)&&("[object Error]"===P(e)||e instanceof Error)}function E(e){return"function"==typeof e}function P(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(g(s)&&(s=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!i[e])if(new RegExp("\\b"+e+"\\b","i").test(s)){var r=process.pid;i[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else i[e]=function(){};return i[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=f,t.isNull=p,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=b,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=g,t.isRegExp=m,t.isObject=v,t.isDate=w,t.isError=_,t.isFunction=E,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(384);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",A(),t.format.apply(t,arguments))},t.inherits=r(5717),t._extend=function(e,t){if(!t||!v(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}},2441:(e,t,r)=>{"use strict";r.a(e,(async e=>{r.r(t),r.d(t,{HostKey:()=>n.tL,__wbg_buffer_eb2155f17856c20b:()=>n.Hu,__wbg_crypto_b8c92eaac23d0d80:()=>n.iY,__wbg_getRandomValues_dd27e6b0652b3236:()=>n.yX,__wbg_getRandomValues_e57c9b75ddead065:()=>n.ae,__wbg_length_0b194abde938d0c6:()=>n.jf,__wbg_msCrypto_9ad6677321a08dd8:()=>n.mS,__wbg_new_ff8b26f7b2d7e2fb:()=>n.Tq,__wbg_newwithlength_a49b32b2030b93c3:()=>n.mz,__wbg_randomFillSync_d2ba53160aec6aba:()=>n.Os,__wbg_require_f5521a5b85ad2542:()=>n.r2,__wbg_self_86b4b13392c7af56:()=>n.U5,__wbg_set_67cdd115b9cb141f:()=>n.L9,__wbg_static_accessor_MODULE_452b4680e8614c81:()=>n.DA,__wbg_subarray_1bb315d30e0c968c:()=>n.gf,__wbindgen_is_undefined:()=>n.XP,__wbindgen_memory:()=>n.oH,__wbindgen_object_drop_ref:()=>n.ug,__wbindgen_rethrow:()=>n.nD,__wbindgen_string_new:()=>n.h4,__wbindgen_throw:()=>n.Or,extract_jwt:()=>n.$n,validate_jwt:()=>n.Xo});var n=r(7247),s=e([n]);n=(s.then?await s:s)[0]}))},7247:(e,t,r)=>{"use strict";r.a(e,(async n=>{r.d(t,{$n:()=>m,Xo:()=>E,tL:()=>S,h4:()=>C,ug:()=>A,Os:()=>O,ae:()=>x,U5:()=>I,iY:()=>M,mS:()=>N,XP:()=>k,r2:()=>U,yX:()=>j,DA:()=>T,Hu:()=>R,Tq:()=>F,L9:()=>L,jf:()=>D,mz:()=>B,gf:()=>$,Or:()=>K,nD:()=>q,oH:()=>H});var s=r(4656);e=r.hmd(e);var i=n([s]);s=(i.then?await i:i)[0];let o=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});o.decode();let a=null;function c(){return null!==a&&a.buffer===s.memory.buffer||(a=new Uint8Array(s.memory.buffer)),a}function u(e,t){return o.decode(c().subarray(e,e+t))}const h=new Array(32).fill(void 0);h.push(void 0,null,!0,!1);let l=h.length;function d(e){l===h.length&&h.push(h.length+1);const t=l;return l=h[t],h[t]=e,t}function f(e){return h[e]}function p(e){const t=f(e);return function(e){e<36||(h[e]=l,l=e)}(e),t}let y=null;function b(){return null!==y&&y.buffer===s.memory.buffer||(y=new Int32Array(s.memory.buffer)),y}let g=32;function m(e){try{const n=s.__wbindgen_add_to_stack_pointer(-16);s.extract_jwt(n,function(e){if(1==g)throw new Error("out of js stack");return h[--g]=e,g}(e));var t=b()[n/4+0],r=b()[n/4+1];return u(t,r)}finally{s.__wbindgen_add_to_stack_pointer(16),h[g++]=void 0,s.__wbindgen_free(t,r)}}let v=0,w=new("undefined"==typeof TextEncoder?(0,e.require)("util").TextEncoder:TextEncoder)("utf-8");const _="function"==typeof w.encodeInto?function(e,t){return w.encodeInto(e,t)}:function(e,t){const r=w.encode(e);return t.set(r),{read:e.length,written:r.length}};function E(e){var t=function(e,t,r){if(void 0===r){const r=w.encode(e),n=t(r.length);return c().subarray(n,n+r.length).set(r),v=r.length,n}let n=e.length,s=t(n);const i=c();let o=0;for(;o<n;o++){const t=e.charCodeAt(o);if(t>127)break;i[s+o]=t}if(o!==n){0!==o&&(e=e.slice(o)),s=r(s,n,n=o+3*e.length);const t=c().subarray(s+o,s+n);o+=_(e,t).written}return v=o,s}(e,s.__wbindgen_malloc,s.__wbindgen_realloc),r=v;return 0!==s.validate_jwt(t,r)}function P(e,t){try{return e.apply(this,t)}catch(e){s.__wbindgen_exn_store(d(e))}}class S{static __wrap(e){const t=Object.create(S.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();s.__wbg_hostkey_free(e)}constructor(){var e=s.hostkey_new();return S.__wrap(e)}get pk(){try{const r=s.__wbindgen_add_to_stack_pointer(-16);s.hostkey_pk(r,this.ptr);var e=b()[r/4+0],t=b()[r/4+1];return u(e,t)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_free(e,t)}}get seed(){try{const r=s.__wbindgen_add_to_stack_pointer(-16);s.hostkey_seed(r,this.ptr);var e=b()[r/4+0],t=b()[r/4+1];return u(e,t)}finally{s.__wbindgen_add_to_stack_pointer(16),s.__wbindgen_free(e,t)}}}function C(e,t){return d(u(e,t))}function A(e){p(e)}function O(e,t,r){var n,s;f(e).randomFillSync((n=t,s=r,c().subarray(n/1,n/1+s)))}function x(e,t){f(e).getRandomValues(f(t))}function I(){return P((function(){return d(self.self)}),arguments)}function M(e){return d(f(e).crypto)}function N(e){return d(f(e).msCrypto)}function k(e){return void 0===f(e)}function U(e,t,r){return d(f(e).require(u(t,r)))}function j(e){return d(f(e).getRandomValues)}function T(){return d(e)}function R(e){return d(f(e).buffer)}function F(e){return d(new Uint8Array(f(e)))}function L(e,t,r){f(e).set(f(t),r>>>0)}function D(e){return f(e).length}function B(e){return d(new Uint8Array(e>>>0))}function $(e,t,r){return d(f(e).subarray(t>>>0,r>>>0))}function K(e,t){throw new Error(u(e,t))}function q(e){throw p(e)}function H(){return d(s.memory)}}))},5024:()=>{},1472:(e,t,r)=>{"use strict";e.exports=r(9298)},8561:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DataViewIndexOutOfBoundsError:()=>L,DecodeError:()=>g,Decoder:()=>$,EXT_TIMESTAMP:()=>m,Encoder:()=>O,ExtData:()=>y,ExtensionCodec:()=>C,decode:()=>q,decodeArrayStream:()=>Y,decodeAsync:()=>X,decodeMulti:()=>H,decodeMultiStream:()=>Z,decodeStream:()=>Q,decodeTimestampExtension:()=>P,decodeTimestampToTimeSpec:()=>E,encode:()=>I,encodeDateToTimeSpec:()=>w,encodeTimeSpecToTimestamp:()=>v,encodeTimestampExtension:()=>_});var n=4294967295;function s(e,t,r){var n=Math.floor(r/4294967296),s=r;e.setUint32(t,n),e.setUint32(t+4,s)}function i(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var o=("undefined"==typeof process||"never"!==process.env.TEXT_ENCODING)&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function a(e){for(var t=e.length,r=0,n=0;n<t;){var s=e.charCodeAt(n++);if(0!=(4294967168&s))if(0==(4294965248&s))r+=2;else{if(s>=55296&&s<=56319&&n<t){var i=e.charCodeAt(n);56320==(64512&i)&&(++n,s=((1023&s)<<10)+(1023&i)+65536)}r+=0==(4294901760&s)?3:4}else r++}return r}var c=o?new TextEncoder:void 0,u=o?"undefined"!=typeof process&&"force"!==process.env.TEXT_ENCODING?200:0:n,h=(null==c?void 0:c.encodeInto)?function(e,t,r){c.encodeInto(e,t.subarray(r))}:function(e,t,r){t.set(c.encode(e),r)};function l(e,t,r){for(var n=t,s=n+r,i=[],o="";n<s;){var a=e[n++];if(0==(128&a))i.push(a);else if(192==(224&a)){var c=63&e[n++];i.push((31&a)<<6|c)}else if(224==(240&a)){c=63&e[n++];var u=63&e[n++];i.push((31&a)<<12|c<<6|u)}else if(240==(248&a)){var h=(7&a)<<18|(c=63&e[n++])<<12|(u=63&e[n++])<<6|63&e[n++];h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|1023&h),i.push(h)}else i.push(a);i.length>=4096&&(o+=String.fromCharCode.apply(String,i),i.length=0)}return i.length>0&&(o+=String.fromCharCode.apply(String,i)),o}var d,f=o?new TextDecoder:null,p=o?"undefined"!=typeof process&&"force"!==process.env.TEXT_DECODER?200:0:n,y=function(e,t){this.type=e,this.data=t},b=(d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),g=function(e){function t(r){var n=e.call(this,r)||this,s=Object.create(t.prototype);return Object.setPrototypeOf(n,s),Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:t.name}),n}return b(t,e),t}(Error),m=-1;function v(e){var t,r=e.sec,n=e.nsec;if(r>=0&&n>=0&&r<=17179869183){if(0===n&&r<=4294967295){var i=new Uint8Array(4);return(t=new DataView(i.buffer)).setUint32(0,r),i}var o=r/4294967296,a=4294967295&r;return i=new Uint8Array(8),(t=new DataView(i.buffer)).setUint32(0,n<<2|3&o),t.setUint32(4,a),i}return i=new Uint8Array(12),(t=new DataView(i.buffer)).setUint32(0,n),s(t,4,r),i}function w(e){var t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),s=Math.floor(n/1e9);return{sec:r+s,nsec:n-1e9*s}}function _(e){return e instanceof Date?v(w(e)):null}function E(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var r=t.getUint32(0);return{sec:4294967296*(3&r)+t.getUint32(4),nsec:r>>>2};case 12:return{sec:i(t,4),nsec:t.getUint32(0)};default:throw new g("Unrecognized data size for timestamp (expected 4, 8, or 12): "+e.length)}}function P(e){var t=E(e);return new Date(1e3*t.sec+t.nsec/1e6)}var S={type:m,encode:_,decode:P},C=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(S)}return e.prototype.register=function(e){var t=e.type,r=e.encode,n=e.decode;if(t>=0)this.encoders[t]=r,this.decoders[t]=n;else{var s=1+t;this.builtInEncoders[s]=r,this.builtInDecoders[s]=n}},e.prototype.tryToEncode=function(e,t){for(var r=0;r<this.builtInEncoders.length;r++)if(null!=(n=this.builtInEncoders[r])&&null!=(s=n(e,t)))return new y(-1-r,s);for(r=0;r<this.encoders.length;r++){var n,s;if(null!=(n=this.encoders[r])&&null!=(s=n(e,t)))return new y(r,s)}return e instanceof y?e:null},e.prototype.decode=function(e,t,r){var n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new y(t,e)},e.defaultCodec=new e,e}();function A(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var O=function(){function e(e,t,r,n,s,i,o,a){void 0===e&&(e=C.defaultCodec),void 0===t&&(t=void 0),void 0===r&&(r=100),void 0===n&&(n=2048),void 0===s&&(s=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),this.extensionCodec=e,this.context=t,this.maxDepth=r,this.initialBufferSize=n,this.sortKeys=s,this.forceFloat32=i,this.ignoreUndefined=o,this.forceIntegerToFloat=a,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.getUint8Array()},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth "+t);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: "+e+" bytes in UTF-8");this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>u){var t=a(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),h(e,this.bytes,this.pos),this.pos+=t}else t=a(e),this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,r){for(var n=e.length,s=r,i=0;i<n;){var o=e.charCodeAt(i++);if(0!=(4294967168&o)){if(0==(4294965248&o))t[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<n){var a=e.charCodeAt(i);56320==(64512&a)&&(++i,o=((1023&o)<<10)+(1023&a)+65536)}0==(4294901760&o)?(t[s++]=o>>12&15|224,t[s++]=o>>6&63|128):(t[s++]=o>>18&7|240,t[s++]=o>>12&63|128,t[s++]=o>>6&63|128)}t[s++]=63&o|128}else t[s++]=o}}(e,this.bytes,this.pos),this.pos+=t},e.prototype.encodeObject=function(e,t){var r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: "+Object.prototype.toString.apply(e));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: "+t);this.writeU8(198),this.writeU32(t)}var r=A(e);this.writeU8a(r)},e.prototype.encodeArray=function(e,t){var r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large array: "+r);this.writeU8(221),this.writeU32(r)}for(var n=0,s=e;n<s.length;n++){var i=s[n];this.doEncode(i,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var r=0,n=0,s=t;n<s.length;n++)void 0!==e[s[n]]&&r++;return r},e.prototype.encodeMap=function(e,t){var r=Object.keys(e);this.sortKeys&&r.sort();var n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large map object: "+n);this.writeU8(223),this.writeU32(n)}for(var s=0,i=r;s<i.length;s++){var o=i[s],a=e[o];this.ignoreUndefined&&void 0===a||(this.encodeString(o),this.doEncode(a,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: "+t);this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,r){var n=r/4294967296,s=r;e.setUint32(t,n),e.setUint32(t+4,s)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),s(this.view,this.pos,e),this.pos+=8},e}(),x={};function I(e,t){return void 0===t&&(t=x),new O(t.extensionCodec,t.context,t.maxDepth,t.initialBufferSize,t.sortKeys,t.forceFloat32,t.ignoreUndefined,t.forceIntegerToFloat).encode(e)}function M(e){return(e<0?"-":"")+"0x"+Math.abs(e).toString(16).padStart(2,"0")}var N=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var r=0;r<this.maxKeyLength;r++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,r){e:for(var n=0,s=this.caches[r-1];n<s.length;n++){for(var i=s[n],o=i.bytes,a=0;a<r;a++)if(o[a]!==e[t+a])continue e;return i.str}return null},e.prototype.store=function(e,t){var r=this.caches[e.length-1],n={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=n:r.push(n)},e.prototype.decode=function(e,t,r){var n=this.find(e,t,r);if(null!=n)return this.hit++,n;this.miss++;var s=l(e,t,r),i=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(i,s),s},e}(),k=function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},U=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,s){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,s,(t=e[r](t)).done,t.value)}))}}},j=function(e){return this instanceof j?(this.v=e,this):new j(e)},T=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(e,t||[]),i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){s[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=s[e](t)).value instanceof j?Promise.resolve(r.value.v).then(c,u):h(i[0][2],r)}catch(e){h(i[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}},R=new DataView(new ArrayBuffer(0)),F=new Uint8Array(R.buffer),L=function(){try{R.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),D=new L("Insufficient data"),B=new N,$=function(){function e(e,t,r,s,i,o,a,c){void 0===e&&(e=C.defaultCodec),void 0===t&&(t=void 0),void 0===r&&(r=n),void 0===s&&(s=n),void 0===i&&(i=n),void 0===o&&(o=n),void 0===a&&(a=n),void 0===c&&(c=B),this.extensionCodec=e,this.context=t,this.maxStrLength=r,this.maxBinLength=s,this.maxArrayLength=i,this.maxMapLength=o,this.maxExtLength=a,this.keyDecoder=c,this.totalPos=0,this.pos=0,this.view=R,this.bytes=F,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=A(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=A(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),r=A(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),this.setBuffer(n)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,r=this.pos;return new RangeError("Extra "+(t.byteLength-r)+" of "+t.byteLength+" byte(s) found at buffer["+e+"]")},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return k(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,r,n,s,i,o,a,c;return i=this,o=void 0,c=function(){var i,o,a,c,u,h,l,d;return k(this,(function(f){switch(f.label){case 0:i=!1,f.label=1;case 1:f.trys.push([1,6,7,12]),t=U(e),f.label=2;case 2:return[4,t.next()];case 3:if((r=f.sent()).done)return[3,5];if(a=r.value,i)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{o=this.doDecodeSync(),i=!0}catch(e){if(!(e instanceof L))throw e}this.totalPos+=this.pos,f.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=f.sent(),n={error:c},[3,12];case 7:return f.trys.push([7,,10,11]),r&&!r.done&&(s=t.return)?[4,s.call(t)]:[3,9];case 8:f.sent(),f.label=9;case 9:return[3,11];case 10:if(n)throw n.error;return[7];case 11:return[7];case 12:if(i){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,o]}throw h=(u=this).headByte,l=u.pos,d=u.totalPos,new RangeError("Insufficient data in parsing "+M(h)+" at "+d+" ("+l+" in the current buffer)")}}))},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{s(c.next(e))}catch(e){t(e)}}function n(e){try{s(c.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(r,n)}s((c=c.apply(i,o||[])).next())}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return T(this,arguments,(function(){var r,n,s,i,o,a,c,u,h;return k(this,(function(l){switch(l.label){case 0:r=t,n=-1,l.label=1;case 1:l.trys.push([1,13,14,19]),s=U(e),l.label=2;case 2:return[4,j(s.next())];case 3:if((i=l.sent()).done)return[3,12];if(o=i.value,t&&0===n)throw this.createExtraByteError(this.totalPos);this.appendBuffer(o),r&&(n=this.readArraySize(),r=!1,this.complete()),l.label=4;case 4:l.trys.push([4,9,,10]),l.label=5;case 5:return[4,j(this.doDecodeSync())];case 6:return[4,l.sent()];case 7:return l.sent(),0==--n?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((a=l.sent())instanceof L))throw a;return[3,10];case 10:this.totalPos+=this.pos,l.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=l.sent(),u={error:c},[3,19];case 14:return l.trys.push([14,,17,18]),i&&!i.done&&(h=s.return)?[4,j(h.call(s))]:[3,16];case 15:l.sent(),l.label=16;case 16:return[3,18];case 17:if(u)throw u.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!=(n=e-128)){this.pushMapState(n),this.complete();continue e}t={}}else if(e<160){if(0!=(n=e-144)){this.pushArrayState(n),this.complete();continue e}t=[]}else{var r=e-160;t=this.decodeUtf8String(r,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e)r=this.lookU8(),t=this.decodeUtf8String(r,1);else if(218===e)r=this.lookU16(),t=this.decodeUtf8String(r,2);else if(219===e)r=this.lookU32(),t=this.decodeUtf8String(r,4);else if(220===e){if(0!==(n=this.readU16())){this.pushArrayState(n),this.complete();continue e}t=[]}else if(221===e){if(0!==(n=this.readU32())){this.pushArrayState(n),this.complete();continue e}t=[]}else if(222===e){if(0!==(n=this.readU16())){this.pushMapState(n),this.complete();continue e}t={}}else if(223===e){if(0!==(n=this.readU32())){this.pushMapState(n),this.complete();continue e}t={}}else if(196===e){var n=this.lookU8();t=this.decodeBinary(n,1)}else if(197===e)n=this.lookU16(),t=this.decodeBinary(n,2);else if(198===e)n=this.lookU32(),t=this.decodeBinary(n,4);else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e)n=this.lookU8(),t=this.decodeExtension(n,1);else if(200===e)n=this.lookU16(),t=this.decodeExtension(n,2);else{if(201!==e)throw new g("Unrecognized type byte: "+M(e));n=this.lookU32(),t=this.decodeExtension(n,4)}this.complete();for(var s=this.stack;s.length>0;){var i=s[s.length-1];if(0===i.type){if(i.array[i.position]=t,i.position++,i.position!==i.size)continue e;s.pop(),t=i.array}else{if(1===i.type){if(void 0,"string"!=(o=typeof t)&&"number"!==o)throw new g("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new g("The key __proto__ is not allowed");i.key=t,i.type=2;continue e}if(i.map[i.key]=t,i.readCount++,i.readCount!==i.size){i.key=null,i.type=1;continue e}s.pop(),t=i.map}}return t}var o},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new g("Unrecognized array type byte: "+M(e))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new g("Max length exceeded: map length ("+e+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new g("Max length exceeded: array length ("+e+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var r;if(e>this.maxStrLength)throw new g("Max length exceeded: UTF-8 byte length ("+e+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+t+e)throw D;var n,s=this.pos+t;return n=this.stateIsMapKey()&&(null===(r=this.keyDecoder)||void 0===r?void 0:r.canBeCached(e))?this.keyDecoder.decode(this.bytes,s,e):e>p?function(e,t,r){var n=e.subarray(t,t+r);return f.decode(n)}(this.bytes,s,e):l(this.bytes,s,e),this.pos+=t+e,n},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new g("Max length exceeded: bin length ("+e+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(e+t))throw D;var r=this.pos+t,n=this.bytes.subarray(r,r+e);return this.pos+=t+e,n},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new g("Max length exceeded: ext length ("+e+") > maxExtLength ("+this.maxExtLength+")");var r=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,r,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,r=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,r},e.prototype.readI64=function(){var e=i(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}(),K={};function q(e,t){return void 0===t&&(t=K),new $(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decode(e)}function H(e,t){return void 0===t&&(t=K),new $(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeMulti(e)}var z=function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},G=function(e){return this instanceof G?(this.v=e,this):new G(e)},J=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(e,t||[]),i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){s[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=s[e](t)).value instanceof G?Promise.resolve(r.value.v).then(c,u):h(i[0][2],r)}catch(e){h(i[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}};function V(e){if(null==e)throw new Error("Assertion Failure: value must not be null nor undefined")}function W(e){return null!=e[Symbol.asyncIterator]?e:function(e){return J(this,arguments,(function(){var t,r,n,s;return z(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,G(t.read())];case 3:return r=i.sent(),n=r.done,s=r.value,n?[4,G(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return V(s),[4,G(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e)}function X(e,t){return void 0===t&&(t=K),r=this,n=void 0,i=function(){var r;return function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}(this,(function(n){return r=W(e),[2,new $(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeAsync(r)]}))},new((s=void 0)||(s=Promise))((function(e,t){function o(e){try{c(i.next(e))}catch(e){t(e)}}function a(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof s?r:new s((function(e){e(r)}))).then(o,a)}c((i=i.apply(r,n||[])).next())}));var r,n,s,i}function Y(e,t){void 0===t&&(t=K);var r=W(e);return new $(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeArrayStream(r)}function Z(e,t){void 0===t&&(t=K);var r=W(e);return new $(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeStream(r)}function Q(e,t){return void 0===t&&(t=K),Z(e,t)}},4656:(e,t,r)=>{"use strict";var n=([n])=>r.v(t,e.id,"39e848c3893ad3328e25",{"./wasmcloud_rs_js_bg.js":{__wbindgen_string_new:n.h4,__wbindgen_object_drop_ref:n.ug,__wbg_randomFillSync_d2ba53160aec6aba:n.Os,__wbg_getRandomValues_e57c9b75ddead065:n.ae,__wbg_self_86b4b13392c7af56:n.U5,__wbg_crypto_b8c92eaac23d0d80:n.iY,__wbg_msCrypto_9ad6677321a08dd8:n.mS,__wbindgen_is_undefined:n.XP,__wbg_require_f5521a5b85ad2542:n.r2,__wbg_getRandomValues_dd27e6b0652b3236:n.yX,__wbg_static_accessor_MODULE_452b4680e8614c81:n.DA,__wbg_buffer_eb2155f17856c20b:n.Hu,__wbg_new_ff8b26f7b2d7e2fb:n.Tq,__wbg_set_67cdd115b9cb141f:n.L9,__wbg_length_0b194abde938d0c6:n.jf,__wbg_newwithlength_a49b32b2030b93c3:n.mz,__wbg_subarray_1bb315d30e0c968c:n.gf,__wbindgen_throw:n.Or,__wbindgen_rethrow:n.nD,__wbindgen_memory:n.oH}});r.a(e,(e=>{var t=e([r(7247)]);return t.then?t.then(n):n(t)}),1)}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={id:e,loaded:!1,exports:{}};return i[e].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}e="function"==typeof Symbol?Symbol("webpack then"):"__webpack_then__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r=e=>{e&&(e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},n=e=>!--e.r&&e(),s=(e,t)=>e?e.push(t):n(t),a.a=(i,o,a)=>{var c,u,h,l=a&&[],d=i.exports,f=!0,p=!1,y=(t,r,n)=>{p||(p=!0,r.r+=t.length,t.map(((t,s)=>t[e](r,n))),p=!1)},b=new Promise(((e,t)=>{h=t,u=()=>(e(d),r(l),l=0)}));b[t]=d,b[e]=(e,t)=>{if(f)return n(e);c&&y(c,e,t),s(l,e),b.catch(t)},i.exports=b,o((i=>{if(!i)return u();var o,a;c=(i=>i.map((i=>{if(null!==i&&"object"==typeof i){if(i[e])return i;if(i.then){var o=[];i.then((e=>{a[t]=e,r(o),o=0}));var a={};return a[e]=(e,t)=>(s(o,e),i.catch(t)),a}}var c={};return c[e]=e=>n(e),c[t]=i,c})))(i);var h=new Promise(((e,r)=>{(o=()=>e(a=c.map((e=>e[t])))).r=0,y(c,o,r)}));return o.r?h:a})).then(u,h),f=!1},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),a.v=(e,t,r,n)=>{var s=fetch(a.p+""+r+".module.wasm");return"function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(s,n).then((t=>Object.assign(e,t.instance.exports))):s.then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,n))).then((t=>Object.assign(e,t.instance.exports)))};var c={};(()=>{"use strict";var e=c;Object.defineProperty(e,"__esModule",{value:!0}),e.startHost=void 0;var t=a(1110);Object.defineProperty(e,"startHost",{enumerable:!0,get:function(){return t.startHost}})})(),wasmcloudjs=c})();